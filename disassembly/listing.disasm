Disassembly Listing for dspic33_c_ultimate
Generated From:
C:/Users/dell/Desktop/MPLABXProjects/ultimate/dist/XC16_dsPIC33FJ128MC804/production/ultimate.production.elf
Dec 22, 2017 6:02:20 PM

---  C:/Users/dell/Desktop/MPLABXProjects/ultimate/vector.c  --------------------------------------------
1:                 /*
2:                  * File:   vector.c
3:                  * Author: dracula
4:                  *
5:                  * Created on December 28, 2016, 10:26 PM
6:                  */
7:                 
8:                 #include "user.h"
9:                 
10:                int memFreeCount = 0;
11:                int countMatrix = 0;
12:                int countVector = 0;
13:                int countMatrixGlobal = 0;
14:                int countVectorGlobal = 0;
15:                
16:                Matrix* pointerMatrix[100];
17:                Matrix* pointerMatrixGlobal[100];
18:                Vector3f* pointerVector[100];
19:                Vector3f* pointerVectorGlobal[100];
20:                
21:                void v_destructor(Vector3f*v, bool dynamic)
22:                {
001858  FA0004     LNK #0x4
00185A  780F00     MOV W0, [W14]
00185C  984721     MOV.B W1, [W14+2]
23:                    if(dynamic)
00185E  90402E     MOV.B [W14+2], W0
001860  E00400     CP0.B W0
001862  320007     BRA Z, 0x1872
24:                    {
25:                		if (v->globalVector == false)
001864  78001E     MOV [W14], W0
001866  904860     MOV.B [W0+14], W0
001868  A20400     BTG.B W0, #0
00186A  E00400     CP0.B W0
00186C  320002     BRA Z, 0x1872
26:                		{
27:                			free(v);
00186E  78001E     MOV [W14], W0
001870  07F855     RCALL _free
28:                		}
29:                    }
30:                }
001872  FA8000     ULNK
001874  060000     RETURN
31:                
32:                Vector3f *v_plus(Vector3f*v,Vector3f*w)
33:                {
001876  FA0004     LNK #0x4
001878  BE9F88     MOV.D W8, [W15++]
00187A  BE9F8A     MOV.D W10, [W15++]
00187C  780F00     MOV W0, [W14]
00187E  980711     MOV W1, [W14+2]
34:                    return v_constructor(local, NULL, v->x + w->x, v->y + w->y, v->z + w->z);
001880  78001E     MOV [W14], W0
001882  900240     MOV [W0+8], W4
001884  9002D0     MOV [W0+10], W5
001886  90001E     MOV [W14+2], W0
001888  9000D0     MOV [W0+10], W1
00188A  900040     MOV [W0+8], W0
00188C  BE0100     MOV.D W0, W2
00188E  BE0004     MOV.D W4, W0
001890  07F5AA     RCALL ___addsf3
001892  BE0500     MOV.D W0, W10
001894  78001E     MOV [W14], W0
001896  900220     MOV [W0+4], W4
001898  9002B0     MOV [W0+6], W5
00189A  90001E     MOV [W14+2], W0
00189C  9000B0     MOV [W0+6], W1
00189E  900020     MOV [W0+4], W0
0018A0  BE0100     MOV.D W0, W2
0018A2  BE0004     MOV.D W4, W0
0018A4  07F5A0     RCALL ___addsf3
0018A6  BE0400     MOV.D W0, W8
0018A8  78001E     MOV [W14], W0
0018AA  BE0210     MOV.D [W0], W4
0018AC  90001E     MOV [W14+2], W0
0018AE  BE0010     MOV.D [W0], W0
0018B0  BE0100     MOV.D W0, W2
0018B2  BE0004     MOV.D W4, W0
0018B4  07F598     RCALL ___addsf3
0018B6  BE030A     MOV.D W10, W6
0018B8  BE0208     MOV.D W8, W4
0018BA  BE0100     MOV.D W0, W2
0018BC  EB0080     CLR W1
0018BE  EB4000     CLR.B W0
0018C0  0700D4     RCALL v_constructor
35:                }
0018C2  BE054F     MOV.D [--W15], W10
0018C4  BE044F     MOV.D [--W15], W8
0018C6  FA8000     ULNK
0018C8  060000     RETURN
36:                
37:                Vector3f *v_minus(Vector3f*v,Vector3f*w)
38:                {
0018CA  FA0004     LNK #0x4
0018CC  BE9F88     MOV.D W8, [W15++]
0018CE  BE9F8A     MOV.D W10, [W15++]
0018D0  780F00     MOV W0, [W14]
0018D2  980711     MOV W1, [W14+2]
39:                    return v_constructor(local, NULL, v->x - w->x, v->y - w->y, v->z - w->z);
0018D4  78001E     MOV [W14], W0
0018D6  900240     MOV [W0+8], W4
0018D8  9002D0     MOV [W0+10], W5
0018DA  90001E     MOV [W14+2], W0
0018DC  9000D0     MOV [W0+10], W1
0018DE  900040     MOV [W0+8], W0
0018E0  BE0100     MOV.D W0, W2
0018E2  BE0004     MOV.D W4, W0
0018E4  07F57F     RCALL ___subsf3
0018E6  BE0500     MOV.D W0, W10
0018E8  78001E     MOV [W14], W0
0018EA  900220     MOV [W0+4], W4
0018EC  9002B0     MOV [W0+6], W5
0018EE  90001E     MOV [W14+2], W0
0018F0  9000B0     MOV [W0+6], W1
0018F2  900020     MOV [W0+4], W0
0018F4  BE0100     MOV.D W0, W2
0018F6  BE0004     MOV.D W4, W0
0018F8  07F575     RCALL ___subsf3
0018FA  BE0400     MOV.D W0, W8
0018FC  78001E     MOV [W14], W0
0018FE  BE0210     MOV.D [W0], W4
001900  90001E     MOV [W14+2], W0
001902  BE0010     MOV.D [W0], W0
001904  BE0100     MOV.D W0, W2
001906  BE0004     MOV.D W4, W0
001908  07F56D     RCALL ___subsf3
00190A  BE030A     MOV.D W10, W6
00190C  BE0208     MOV.D W8, W4
00190E  BE0100     MOV.D W0, W2
001910  EB0080     CLR W1
001912  EB4000     CLR.B W0
001914  0700AA     RCALL v_constructor
40:                }
001916  BE054F     MOV.D [--W15], W10
001918  BE044F     MOV.D [--W15], W8
00191A  FA8000     ULNK
00191C  060000     RETURN
41:                
42:                float v_v_multiply(Vector3f*v,Vector3f*w)
43:                {
00191E  FA0004     LNK #0x4
001920  BE9F88     MOV.D W8, [W15++]
001922  780F00     MOV W0, [W14]
001924  980711     MOV W1, [W14+2]
44:                    return v->x * w->x + v->y * w->y + v->z * w->z;
001926  78001E     MOV [W14], W0
001928  BE0210     MOV.D [W0], W4
00192A  90001E     MOV [W14+2], W0
00192C  BE0010     MOV.D [W0], W0
00192E  BE0100     MOV.D W0, W2
001930  BE0004     MOV.D W4, W0
001932  07F66E     RCALL ___mulsf3
001934  BE0400     MOV.D W0, W8
001936  78001E     MOV [W14], W0
001938  900220     MOV [W0+4], W4
00193A  9002B0     MOV [W0+6], W5
00193C  90001E     MOV [W14+2], W0
00193E  9000B0     MOV [W0+6], W1
001940  900020     MOV [W0+4], W0
001942  BE0100     MOV.D W0, W2
001944  BE0004     MOV.D W4, W0
001946  07F664     RCALL ___mulsf3
001948  BE0100     MOV.D W0, W2
00194A  BE0008     MOV.D W8, W0
00194C  07F54C     RCALL ___addsf3
00194E  BE0400     MOV.D W0, W8
001950  78001E     MOV [W14], W0
001952  900240     MOV [W0+8], W4
001954  9002D0     MOV [W0+10], W5
001956  90001E     MOV [W14+2], W0
001958  9000D0     MOV [W0+10], W1
00195A  900040     MOV [W0+8], W0
00195C  BE0100     MOV.D W0, W2
00195E  BE0004     MOV.D W4, W0
001960  07F657     RCALL ___mulsf3
001962  BE0100     MOV.D W0, W2
001964  BE0008     MOV.D W8, W0
001966  07F53F     RCALL ___addsf3
45:                }
001968  BE044F     MOV.D [--W15], W8
00196A  FA8000     ULNK
00196C  060000     RETURN
46:                
47:                Vector3f *v_s_multiply(Vector3f*v,float s)
48:                {
00196E  FA0006     LNK #0x6
001970  BE9F88     MOV.D W8, [W15++]
001972  BE9F8A     MOV.D W10, [W15++]
001974  780F00     MOV W0, [W14]
001976  980712     MOV W2, [W14+2]
001978  980723     MOV W3, [W14+4]
49:                    return v_constructor(local, NULL, v->x * s, v->y * s, v->z * s);
00197A  78001E     MOV [W14], W0
00197C  9000D0     MOV [W0+10], W1
00197E  900040     MOV [W0+8], W0
001980  90011E     MOV [W14+2], W2
001982  9001AE     MOV [W14+4], W3
001984  07F645     RCALL ___mulsf3
001986  BE0500     MOV.D W0, W10
001988  78001E     MOV [W14], W0
00198A  9000B0     MOV [W0+6], W1
00198C  900020     MOV [W0+4], W0
00198E  90011E     MOV [W14+2], W2
001990  9001AE     MOV [W14+4], W3
001992  07F63E     RCALL ___mulsf3
001994  BE0400     MOV.D W0, W8
001996  78001E     MOV [W14], W0
001998  BE0010     MOV.D [W0], W0
00199A  90011E     MOV [W14+2], W2
00199C  9001AE     MOV [W14+4], W3
00199E  07F638     RCALL ___mulsf3
0019A0  BE030A     MOV.D W10, W6
0019A2  BE0208     MOV.D W8, W4
0019A4  BE0100     MOV.D W0, W2
0019A6  EB0080     CLR W1
0019A8  EB4000     CLR.B W0
0019AA  07005F     RCALL v_constructor
50:                }
0019AC  BE054F     MOV.D [--W15], W10
0019AE  BE044F     MOV.D [--W15], W8
0019B0  FA8000     ULNK
0019B2  060000     RETURN
51:                
52:                Vector3f *v_equal(Vector3f*v,Vector3f*w)
53:                {
0019B4  FA0004     LNK #0x4
0019B6  780F00     MOV W0, [W14]
0019B8  980711     MOV W1, [W14+2]
54:                    v->x = w->x;
0019BA  90001E     MOV [W14+2], W0
0019BC  BE0010     MOV.D [W0], W0
0019BE  78011E     MOV [W14], W2
0019C0  BE8900     MOV.D W0, [W2]
55:                    v->y = w->y;
0019C2  90001E     MOV [W14+2], W0
0019C4  9000B0     MOV [W0+6], W1
0019C6  900020     MOV [W0+4], W0
0019C8  78011E     MOV [W14], W2
0019CA  980120     MOV W0, [W2+4]
0019CC  980131     MOV W1, [W2+6]
56:                    v->z = w->z;
0019CE  90001E     MOV [W14+2], W0
0019D0  9000D0     MOV [W0+10], W1
0019D2  900040     MOV [W0+8], W0
0019D4  78011E     MOV [W14], W2
0019D6  980140     MOV W0, [W2+8]
0019D8  980151     MOV W1, [W2+10]
57:                    return v;
0019DA  78001E     MOV [W14], W0
58:                }
0019DC  FA8000     ULNK
0019DE  060000     RETURN
59:                
60:                float v_length(Vector3f*v)
61:                {
0019E0  FA0002     LNK #0x2
0019E2  BE9F88     MOV.D W8, [W15++]
0019E4  780F00     MOV W0, [W14]
62:                    return sqrt(v->x * v->x + v->y * v->y + v->z * v->z);
0019E6  78001E     MOV [W14], W0
0019E8  BE0210     MOV.D [W0], W4
0019EA  78001E     MOV [W14], W0
0019EC  BE0010     MOV.D [W0], W0
0019EE  BE0100     MOV.D W0, W2
0019F0  BE0004     MOV.D W4, W0
0019F2  07F60E     RCALL ___mulsf3
0019F4  BE0400     MOV.D W0, W8
0019F6  78001E     MOV [W14], W0
0019F8  900220     MOV [W0+4], W4
0019FA  9002B0     MOV [W0+6], W5
0019FC  78001E     MOV [W14], W0
0019FE  9000B0     MOV [W0+6], W1
001A00  900020     MOV [W0+4], W0
001A02  BE0100     MOV.D W0, W2
001A04  BE0004     MOV.D W4, W0
001A06  07F604     RCALL ___mulsf3
001A08  BE0100     MOV.D W0, W2
001A0A  BE0008     MOV.D W8, W0
001A0C  07F4EC     RCALL ___addsf3
001A0E  BE0400     MOV.D W0, W8
001A10  78001E     MOV [W14], W0
001A12  900240     MOV [W0+8], W4
001A14  9002D0     MOV [W0+10], W5
001A16  78001E     MOV [W14], W0
001A18  9000D0     MOV [W0+10], W1
001A1A  900040     MOV [W0+8], W0
001A1C  BE0100     MOV.D W0, W2
001A1E  BE0004     MOV.D W4, W0
001A20  07F5F7     RCALL ___mulsf3
001A22  BE0100     MOV.D W0, W2
001A24  BE0008     MOV.D W8, W0
001A26  07F4DF     RCALL ___addsf3
001A28  07F692     RCALL _sqrtf
63:                }
001A2A  BE044F     MOV.D [--W15], W8
001A2C  FA8000     ULNK
001A2E  060000     RETURN
64:                
65:                void v_normalize(Vector3f*v)
66:                {
001A30  FA0006     LNK #0x6
001A32  980720     MOV W0, [W14+4]
67:                    float len = v_length(v);
001A34  90002E     MOV [W14+4], W0
001A36  07FFD4     RCALL v_length
001A38  BE8F00     MOV.D W0, [W14]
68:                    v->x /= len;
001A3A  90002E     MOV [W14+4], W0
001A3C  BE0010     MOV.D [W0], W0
001A3E  BE011E     MOV.D [W14], W2
001A40  07F531     RCALL ___divsf3
001A42  90012E     MOV [W14+4], W2
001A44  BE8900     MOV.D W0, [W2]
69:                    v->y /= len;
001A46  90002E     MOV [W14+4], W0
001A48  9000B0     MOV [W0+6], W1
001A4A  900020     MOV [W0+4], W0
001A4C  BE011E     MOV.D [W14], W2
001A4E  07F52A     RCALL ___divsf3
001A50  90012E     MOV [W14+4], W2
001A52  980120     MOV W0, [W2+4]
001A54  980131     MOV W1, [W2+6]
70:                    v->z /= len;
001A56  90002E     MOV [W14+4], W0
001A58  9000D0     MOV [W0+10], W1
001A5A  900040     MOV [W0+8], W0
001A5C  BE011E     MOV.D [W14], W2
001A5E  07F522     RCALL ___divsf3
001A60  90012E     MOV [W14+4], W2
001A62  980140     MOV W0, [W2+8]
001A64  980151     MOV W1, [W2+10]
71:                }
001A66  FA8000     ULNK
001A68  060000     RETURN
72:                
73:                Vector3f *v_constructor(bool globalVector, Vector3f*v, float x, float y, float z)
74:                {
001A6A  FA0010     LNK #0x10
001A6C  781F88     MOV W8, [W15++]
001A6E  784F00     MOV.B W0, [W14]
001A70  980711     MOV W1, [W14+2]
001A72  980722     MOV W2, [W14+4]
001A74  980733     MOV W3, [W14+6]
001A76  980744     MOV W4, [W14+8]
001A78  980755     MOV W5, [W14+10]
001A7A  980766     MOV W6, [W14+12]
001A7C  980777     MOV W7, [W14+14]
75:                    if(v == NULL)
001A7E  90001E     MOV [W14+2], W0
001A80  E00000     CP0 W0
001A82  3A002D     BRA NZ, 0x1ADE
76:                    {
77:                		if(!globalVector)
001A84  78401E     MOV.B [W14], W0
001A86  A20400     BTG.B W0, #0
001A88  E00400     CP0.B W0
001A8A  320015     BRA Z, 0x1AB6
78:                		{
79:                			pointerVector[countVector] = (Vector3f*)malloc(sizeof(Vector3f));
001A8C  8040C8     MOV countVector, W8
001A8E  200100     MOV #0x10, W0
001A90  07F7AA     RCALL _malloc
001A92  780080     MOV W0, W1
001A94  440108     ADD W8, W8, W2
001A96  209B00     MOV #0x9B0, W0
001A98  410000     ADD W2, W0, W0
001A9A  780801     MOV W1, [W0]
80:                			v = pointerVector[countVector];
001A9C  8040C0     MOV countVector, W0
001A9E  400080     ADD W0, W0, W1
001AA0  209B00     MOV #0x9B0, W0
001AA2  408000     ADD W1, W0, W0
001AA4  780090     MOV [W0], W1
001AA6  980711     MOV W1, [W14+2]
81:                			v->thisVectorAddress = countVector;
001AA8  8040C1     MOV countVector, W1
001AAA  90001E     MOV [W14+2], W0
001AAC  980061     MOV W1, [W0+12]
82:                			countVector++;
001AAE  8040C0     MOV countVector, W0
001AB0  E80000     INC W0, W0
001AB2  8840C0     MOV W0, countVector
001AB4  370014     BRA 0x1ADE
83:                		}
84:                		else 
85:                		{
86:                			pointerVectorGlobal[countVectorGlobal] = (Vector3f*)malloc(sizeof(Vector3f));
001AB6  8040E8     MOV countVectorGlobal, W8
001AB8  200100     MOV #0x10, W0
001ABA  07F795     RCALL _malloc
001ABC  780080     MOV W0, W1
001ABE  440108     ADD W8, W8, W2
001AC0  20A780     MOV #0xA78, W0
001AC2  410000     ADD W2, W0, W0
001AC4  780801     MOV W1, [W0]
87:                			v = pointerVectorGlobal[countVectorGlobal];
001AC6  8040E0     MOV countVectorGlobal, W0
001AC8  400080     ADD W0, W0, W1
001ACA  20A780     MOV #0xA78, W0
001ACC  408000     ADD W1, W0, W0
001ACE  780110     MOV [W0], W2
001AD0  980712     MOV W2, [W14+2]
88:                			v->thisVectorAddress = countVectorGlobal;
001AD2  8040E1     MOV countVectorGlobal, W1
001AD4  90001E     MOV [W14+2], W0
001AD6  980061     MOV W1, [W0+12]
89:                			countVectorGlobal++;
001AD8  8040E0     MOV countVectorGlobal, W0
001ADA  E80000     INC W0, W0
001ADC  8840E0     MOV W0, countVectorGlobal
90:                		}
91:                    }
92:                
93:                	v->globalVector = globalVector;
001ADE  90001E     MOV [W14+2], W0
001AE0  78419E     MOV.B [W14], W3
001AE2  984863     MOV.B W3, [W0+14]
94:                    v->x = x;
001AE4  90001E     MOV [W14+2], W0
001AE6  90012E     MOV [W14+4], W2
001AE8  9001BE     MOV [W14+6], W3
001AEA  BE8802     MOV.D W2, [W0]
95:                    v->y = y;
001AEC  90001E     MOV [W14+2], W0
001AEE  90014E     MOV [W14+8], W2
001AF0  9001DE     MOV [W14+10], W3
001AF2  980022     MOV W2, [W0+4]
001AF4  980033     MOV W3, [W0+6]
96:                    v->z = z;
001AF6  90001E     MOV [W14+2], W0
001AF8  90016E     MOV [W14+12], W2
001AFA  9001FE     MOV [W14+14], W3
001AFC  980042     MOV W2, [W0+8]
001AFE  980053     MOV W3, [W0+10]
97:                    //v->v_plus = v_plus;
98:                    //v->v_minus = v_minus;
99:                    //v->v_v_multiply = v_v_multiply;
100:                   //v->v_s_multiply = v_s_multiply;
101:                   //v->v_equal = v_equal;
102:                   //v->v_length = v_length;
103:                   //v->v_normalize = v_normalize;
104:                   return v;
001B00  90001E     MOV [W14+2], W0
105:               }
001B02  78044F     MOV [--W15], W8
001B04  FA8000     ULNK
001B06  060000     RETURN
106:               
107:               void freeLocalMem(void)
108:               {
001B08  FA0000     LNK #0x0
109:                   for (memFreeCount = 0; memFreeCount < countMatrix; memFreeCount++)
001B0A  EF2814     CLR memFreeCount
001B0C  37000A     BRA 0x1B22
001B1C  8040A0     MOV memFreeCount, W0
001B1E  E80000     INC W0, W0
001B20  8840A0     MOV W0, memFreeCount
001B22  8040A1     MOV memFreeCount, W1
001B24  8040B0     MOV countMatrix, W0
001B26  508F80     SUB W1, W0, [W15]
001B28  35FFF2     BRA LT, 0x1B0E
110:                   {
111:                       m_destructor(pointerMatrix[memFreeCount], 1);
001B0E  8040A0     MOV memFreeCount, W0
001B10  400080     ADD W0, W0, W1
001B12  208200     MOV #0x820, W0
001B14  408000     ADD W1, W0, W0
001B16  780010     MOV [W0], W0
001B18  B3C011     MOV.B #0x1, W1
001B1A  07F82B     RCALL m_destructor
112:                   };
113:                   for (memFreeCount = 0; memFreeCount < countVector; memFreeCount++)
001B2A  EF2814     CLR memFreeCount
001B2C  37000A     BRA 0x1B42
001B3C  8040A0     MOV memFreeCount, W0
001B3E  E80000     INC W0, W0
001B40  8840A0     MOV W0, memFreeCount
001B42  8040A1     MOV memFreeCount, W1
001B44  8040C0     MOV countVector, W0
001B46  508F80     SUB W1, W0, [W15]
001B48  35FFF2     BRA LT, 0x1B2E
114:                   {
115:                       v_destructor(pointerVector[memFreeCount], 1);
001B2E  8040A0     MOV memFreeCount, W0
001B30  400080     ADD W0, W0, W1
001B32  209B00     MOV #0x9B0, W0
001B34  408000     ADD W1, W0, W0
001B36  780010     MOV [W0], W0
001B38  B3C011     MOV.B #0x1, W1
001B3A  07FE8E     RCALL v_destructor
116:                   }
117:                   countMatrix = 0;
001B4A  EF2816     CLR countMatrix
118:                   countVector = 0;
001B4C  EF2818     CLR countVector
119:               }
001B4E  FA8000     ULNK
001B50  060000     RETURN
120:               
121:               void freeGlobalMem(void)
122:               {
001B52  FA0000     LNK #0x0
123:                   for (memFreeCount = 0; memFreeCount < countMatrixGlobal; memFreeCount++)
001B54  EF2814     CLR memFreeCount
001B56  37000A     BRA 0x1B6C
001B66  8040A0     MOV memFreeCount, W0
001B68  E80000     INC W0, W0
001B6A  8840A0     MOV W0, memFreeCount
001B6C  8040A1     MOV memFreeCount, W1
001B6E  8040D0     MOV countMatrixGlobal, W0
001B70  508F80     SUB W1, W0, [W15]
001B72  35FFF2     BRA LT, 0x1B58
124:               	{
125:               		m_destructor(pointerMatrixGlobal[memFreeCount], 1);
001B58  8040A0     MOV memFreeCount, W0
001B5A  400080     ADD W0, W0, W1
001B5C  208E80     MOV #0x8E8, W0
001B5E  408000     ADD W1, W0, W0
001B60  780010     MOV [W0], W0
001B62  B3C011     MOV.B #0x1, W1
001B64  07F806     RCALL m_destructor
126:               	};
127:               	for (memFreeCount = 0; memFreeCount < countVectorGlobal; memFreeCount++)
001B74  EF2814     CLR memFreeCount
001B76  37000A     BRA 0x1B8C
001B86  8040A0     MOV memFreeCount, W0
001B88  E80000     INC W0, W0
001B8A  8840A0     MOV W0, memFreeCount
001B8C  8040A1     MOV memFreeCount, W1
001B8E  8040E0     MOV countVectorGlobal, W0
001B90  508F80     SUB W1, W0, [W15]
001B92  35FFF2     BRA LT, 0x1B78
128:               	{
129:               		v_destructor(pointerVectorGlobal[memFreeCount], 1);
001B78  8040A0     MOV memFreeCount, W0
001B7A  400080     ADD W0, W0, W1
001B7C  20A780     MOV #0xA78, W0
001B7E  408000     ADD W1, W0, W0
001B80  780010     MOV [W0], W0
001B82  B3C011     MOV.B #0x1, W1
001B84  07FE69     RCALL v_destructor
130:               	}
131:               	countMatrixGlobal = 0;
001B94  EF281A     CLR countMatrixGlobal
132:               	countVectorGlobal = 0;
001B96  EF281C     CLR countVectorGlobal
133:               }
001B98  FA8000     ULNK
001B9A  060000     RETURN
---  C:/Users/dell/Desktop/MPLABXProjects/ultimate/user.c  ----------------------------------------------
1:                 /******************************************************************************/
2:                 /* Files to Include                                                           */
3:                 /******************************************************************************/
4:                 
5:                 /* Device header file */
6:                 #if defined(__XC16__)
7:                     #include <xc.h>
8:                 #elif defined(__C30__)
9:                     #if defined(__dsPIC33E__)
10:                    	#include <p33Exxxx.h>
11:                    #elif defined(__dsPIC33F__)
12:                    	#include <p33Fxxxx.h>
13:                    #endif
14:                #endif
15:                
16:                #include <stdint.h>          /* For uint16_t definition                       */
17:                #include <stdbool.h>         /* For true/false definition                     */
18:                
19:                #include "user.h"            /* variables/params used by user.c               */
20:                
21:                #define FCY 40000000
22:                #define BAUDRATE 115200//57600//9600  
23:                #define BRGVAL ((FCY/BAUDRATE)/16)-1
24:                /******************************************************************************/
25:                /* User Functions                                                             */
26:                /******************************************************************************/
27:                
28:                /* <Initialize variables in user.h and insert code for user algorithms.> */
29:                
30:                void InitApp(void)
31:                {
002188  FA0000     LNK #0x0
32:                    /* TODO Initialize User Ports/Peripherals/Project here */
33:                    //*************************************************************
34:                    // Unlock Registers
35:                    //*************************************************************
36:                    __builtin_write_OSCCONL(OSCCON & ~(1<<6)); 
00218A  803A11     MOV OSCCON, W1
00218C  2FFBF0     MOV #0xFFBF, W0
00218E  608100     AND W1, W0, W2
002190  200460     MOV #0x46, W0
002192  200571     MOV #0x57, W1
002194  207423     MOV #0x742, W3
002196  784980     MOV.B W0, [W3]
002198  784981     MOV.B W1, [W3]
00219A  784982     MOV.B W2, [W3]
37:                
38:                    //*************************************************************
39:                    // Configure Input Functions
40:                    // (See Table 30-1)
41:                    //*************************************************************
42:                    //*******************************
43:                    // Assign U1Rx To Pin RP20
44:                    //***************************
45:                    //RPINR18bits.U1RXR = 0;
46:                //    RPINR18bits.U1RXR = 4;
47:                    RPINR18bits.U1RXR = 20;
00219C  803521     MOV RPINR18, W1
00219E  2FFE00     MOV #0xFFE0, W0
0021A0  608000     AND W1, W0, W0
0021A2  B30140     IOR #0x14, W0
0021A4  883520     MOV W0, RPINR18
48:                    
49:                    //***************************
50:                    // Assign U1CTS To Pin RP1
51:                    //***************************
52:                    //RPINR18bits.U1CTSR = 1;
53:                    
54:                    //*************************************************************
55:                    // Configure Output Functions
56:                    // (See Table 30-2)
57:                    //*************************************************************
58:                    //***************************
59:                    // Assign U1Tx To Pin RP4
60:                    //***************************
61:                    //RPOR1bits.RP2R = 3;
62:                //    RPOR0bits.RP0R = 3;
63:                    RPOR2bits.RP4R = 3;
0021A6  803621     MOV RPOR2, W1
0021A8  2FFE00     MOV #0xFFE0, W0
0021AA  608000     AND W1, W0, W0
0021AC  B30030     IOR #0x3, W0
0021AE  883620     MOV W0, RPOR2
64:                
65:                    //***************************
66:                    // Assign U1RTS To Pin RP3
67:                    //***************************
68:                    //RPOR1bits.RP3R = 4;
69:                    
70:                    //*************************************************************
71:                    // Lock Registers
72:                    //*************************************************************
73:                    __builtin_write_OSCCONL(OSCCON | (1<<6));
0021B0  803A10     MOV OSCCON, W0
0021B2  780100     MOV W0, W2
0021B4  A06002     BSET W2, #6
0021B6  200460     MOV #0x46, W0
0021B8  200571     MOV #0x57, W1
0021BA  207423     MOV #0x742, W3
0021BC  784980     MOV.B W0, [W3]
0021BE  784981     MOV.B W1, [W3]
0021C0  784982     MOV.B W2, [W3]
74:                
75:                    /* Setup analog functionality and port direction */
76:                    TRISAbits.TRISA0=0;
0021C2  A902C0     BCLR TRISA, #0
77:                    TRISAbits.TRISA1=0;
0021C4  A922C0     BCLR TRISA, #1
78:                    
79:                    TRISAbits.TRISA4=0;
0021C6  A982C0     BCLR TRISA, #4
80:                    TRISAbits.TRISA7=0;
0021C8  A9E2C0     BCLR TRISA, #7
81:                    
82:                    TRISAbits.TRISA8=0;
0021CA  A902C1     BCLR 0x2C1, #0
83:                    TRISAbits.TRISA9=0;
0021CC  A922C1     BCLR 0x2C1, #1
84:                    /*
85:                    TRISAbits.TRISA0 = 0;
86:                    TRISAbits.TRISA1 = 0;
87:                    TRISBbits.TRISB2 = 1;
88:                    TRISBbits.TRISB5 = 1;
89:                    */
90:                    //TRISB = 0xFFFF;
91:                    /* Initialize peripherals */
92:                    PwmInit();
0021CE  070003     RCALL PwmInit
93:                    UartInit();
0021D0  070016     RCALL UartInit
94:                }
0021D2  FA8000     ULNK
0021D4  060000     RETURN
95:                
96:                void PwmInit(void)
97:                {
0021D6  FA0000     LNK #0x0
98:                #if 1
99:                    /*
100:                    * PxTPER = FCY/(FPWM*PxTMR PreScaler)-1
101:                    * PxTMR PreScaler=1:1
102:                    * FPWM=20KHz
103:                    * FCY=40MHz, refer to function ConfigureOscillator
104:                    * PxTPER=1999
105:                    * 0x07CF
106:                    * 0b0000 0111 1100 1111
107:                    */
108:                   P1TCON=0x8000;   //or P1TCONbits.PTEN = 1;
0021D8  280000     MOV #0x8000, W0
0021DA  880E00     MOV W0, P1TCON
109:                   P1TMR=0x0000;
0021DC  EF21C2     CLR P1TMR
110:                   P1TPER=1999;     // period:50us
0021DE  207CF0     MOV #0x7CF, W0
0021E0  880E20     MOV W0, P1TPER
111:                   //P1SECMP=0x0000;
112:                   PWM1CON1=0x0FFF;
0021E2  20FFF0     MOV #0xFFF, W0
0021E4  880E40     MOV W0, PWM1CON1
113:                   PWM1CON2=0x0004;
0021E6  200040     MOV #0x4, W0
0021E8  880E50     MOV W0, PWM1CON2
114:                   P1OVDCON=0xFF00;
0021EA  2FF000     MOV #0xFF00, W0
0021EC  880EA0     MOV W0, OVDCON
115:                   //P1FLTACON=0x0080;
116:                   //P1DTCON1=0x0000;
117:                   //P1DTCON2=0x0000;
118:                   P1DC1=100;
0021EE  200640     MOV #0x64, W0
0021F0  880EB0     MOV W0, P1DC1
119:                   P1DC2=200;
0021F2  200C80     MOV #0xC8, W0
0021F4  880EC0     MOV W0, P1DC2
120:                   P1DC3=1000;
0021F6  203E80     MOV #0x3E8, W0
0021F8  880ED0     MOV W0, P1DC3
121:                   // LSB is not used for duty cycle, the realy duty cycle count should be PIDC*/2 !!!!!!
122:               #endif
123:                   
124:               #if 0
125:               /* Configuration register FPOR */
126:               
127:               /* PWM time base operates in a Free Running mode */
128:               P1TCONbits.PTMOD = 0b00;
129:               
130:               /* PWM time base input clock period is TCY (1:1 prescale) */
131:               /* PWM time base output post scale is 1:1 */
132:               P1TCONbits.PTCKPS = 0b00;
133:               P1TCONbits.PTOPS = 0b00;
134:               
135:               /* Choose PWM time period based on input clock selected */
136:               /* Refer to Equation: PxTPER=FCY/(FPWM × PxTMR PreScaler)-1*/
137:               /* PWM switching frequency is 20 kHz */
138:               /* FCY is 40 MHz */
139:               P1TPER = 1999;
140:               
141:               /* PWM I/O pairs 1 to 3 are in complementary mode */
142:               /* PWM pins are enabled for PWM output */
143:               PWM1CON1bits.PMOD1 = 0;
144:               PWM1CON1bits.PMOD2 = 0;
145:               PWM1CON1bits.PMOD3 = 0;
146:               PWM1CON1bits.PEN1H = 1;
147:               PWM1CON1bits.PEN2H = 1;
148:               PWM1CON1bits.PEN3H = 1;
149:               PWM1CON1bits.PEN1L = 1;
150:               PWM1CON1bits.PEN2L = 1;
151:               PWM1CON1bits.PEN3L = 1;
152:               /* Immediate update of PWM enabled */
153:               PWM1CON2bits.IUE = 1;
154:               
155:               /* PWM I/O pin controlled by PWM Generator */
156:               P1OVDCONbits.POVD3H = 1;
157:               P1OVDCONbits.POVD2H = 1;
158:               P1OVDCONbits.POVD1H = 1;
159:               P1OVDCONbits.POVD3L = 1;
160:               P1OVDCONbits.POVD2L = 1;
161:               P1OVDCONbits.POVD1L = 1;
162:               
163:               /* Initialize duty cycle values for PWM1, PWM2 and PWM3 signals */
164:               P1DC1 = 200;
165:               P1DC2 = 200;
166:               P1DC3 = 200;
167:               P1TCONbits.PTEN = 1;
168:               #endif
169:               }
0021FA  FA8000     ULNK
0021FC  060000     RETURN
170:               
171:               void UartInit(void)
172:               {
0021FE  FA0000     LNK #0x0
173:                   U1MODEbits.STSEL = 0; // 1-stop bit
002200  A90220     BCLR U1MODE, #0
174:                   U1MODEbits.PDSEL = 0; // No Parity, 8-data bits
002202  801101     MOV U1MODE, W1
002204  2FFF90     MOV #0xFFF9, W0
002206  608000     AND W1, W0, W0
002208  881100     MOV W0, U1MODE
175:                   U1MODEbits.ABAUD = 0; // Auto-Baud Disabled
00220A  A9A220     BCLR U1MODE, #5
176:                   U1MODEbits.BRGH = 0; // Low Speed mode
00220C  A96220     BCLR U1MODE, #3
177:                   U1MODEbits.LPBACK = 0;
00220E  A9C220     BCLR U1MODE, #6
178:                   U1BRG = BRGVAL; // BAUD Rate Setting for 115200//57600//9600
002210  200140     MOV #0x14, W0
002212  881140     MOV W0, U1BRG
179:                   U1STAbits.UTXISEL0 = 0; // Interrupt after one Tx character is transmitted
002214  A9A223     BCLR 0x223, #5
180:                   U1STAbits.UTXISEL1 = 0;
002216  A9E223     BCLR 0x223, #7
181:                   U1STAbits.URXISEL = 0;
002218  801111     MOV U1STA, W1
00221A  2FF3F0     MOV #0xFF3F, W0
00221C  608000     AND W1, W0, W0
00221E  881110     MOV W0, U1STA
182:                   IEC0bits.U1TXIE = 1; // Enable UART Tx interrupt
002220  A88095     BSET 0x95, #4
183:                   IEC0bits.U1RXIE = 1; // Enable UART Rx interrupt
002222  A86095     BSET 0x95, #3
184:                   U1MODEbits.UARTEN = 1; // Enable UART
002224  A8E221     BSET 0x221, #7
185:                   U1STAbits.UTXEN = 1; // Enable UART Tx
002226  A84223     BSET 0x223, #2
186:                   /* wait at least 8.68 usec (1/115200) before sending first char */
187:                   //DELAY_105us
188:                   DELAY_10us
002228  090191     REPEAT #0x191
00222A  000000     NOP
189:               }
00222C  FA8000     ULNK
00222E  060000     RETURN
---  C:/Users/dell/Desktop/MPLABXProjects/ultimate/traps.c  ---------------------------------------------
1:                 /******************************************************************************/
2:                 /* Files to Include                                                           */
3:                 /******************************************************************************/
4:                 
5:                 /* Device header file */
6:                 #if defined(__XC16__)
7:                     #include <xc.h>
8:                 #elif defined(__C30__)
9:                     #if defined(__dsPIC33E__)
10:                    	#include <p33Exxxx.h>
11:                    #elif defined(__dsPIC33F__)
12:                    	#include <p33Fxxxx.h>
13:                    #endif
14:                #endif
15:                
16:                #include <stdint.h>        /* Includes uint16_t definition */
17:                #include <stdbool.h>       /* Includes true/false definition */
18:                
19:                /******************************************************************************/
20:                /* Trap Function Prototypes                                                   */
21:                /******************************************************************************/
22:                
23:                /* <Other function prototypes for debugging trap code may be inserted here>   */
24:                
25:                /* Use if INTCON2 ALTIVT=1 */
26:                void __attribute__((interrupt,no_auto_psv)) _OscillatorFail(void);
27:                void __attribute__((interrupt,no_auto_psv)) _AddressError(void);
28:                void __attribute__((interrupt,no_auto_psv)) _StackError(void);
29:                void __attribute__((interrupt,no_auto_psv)) _MathError(void);
30:                
31:                #if defined(__HAS_DMA__)
32:                
33:                void __attribute__((interrupt,no_auto_psv)) _DMACError(void);
34:                
35:                #endif
36:                
37:                #if defined(__dsPIC33F__)
38:                
39:                /* Use if INTCON2 ALTIVT=0 */
40:                void __attribute__((interrupt,no_auto_psv)) _AltOscillatorFail(void);
41:                void __attribute__((interrupt,no_auto_psv)) _AltAddressError(void);
42:                void __attribute__((interrupt,no_auto_psv)) _AltStackError(void);
43:                void __attribute__((interrupt,no_auto_psv)) _AltMathError(void);
44:                
45:                    #if defined(__HAS_DMA__)
46:                
47:                    void __attribute__((interrupt,no_auto_psv)) _AltDMACError(void);
48:                
49:                    #endif
50:                
51:                #endif
52:                
53:                /* Default interrupt handler */
54:                void __attribute__((interrupt,no_auto_psv)) _DefaultInterrupt(void);
55:                
56:                #if defined(__dsPIC33E__)
57:                
58:                /* These are additional traps in the 33E family.  Refer to the PIC33E
59:                migration guide.  There are no Alternate Vectors in the 33E family. */
60:                void __attribute__((interrupt,no_auto_psv)) _HardTrapError(void);
61:                void __attribute__((interrupt,no_auto_psv)) _SoftTrapError(void);
62:                
63:                #endif
64:                
65:                /******************************************************************************/
66:                /* Trap Handling                                                              */
67:                /*                                                                            */
68:                /* These trap routines simply ensure that the device continuously loops       */
69:                /* within each routine.  Users who actually experience one of these traps     */
70:                /* can add code to handle the error.  Some basic examples for trap code,      */
71:                /* including assembly routines that process trap sources, are available at    */
72:                /* www.microchip.com/codeexamples                                             */
73:                /******************************************************************************/
74:                
75:                /* Primary (non-alternate) address error trap function declarations */
76:                void __attribute__((interrupt,no_auto_psv)) _OscillatorFail(void)
77:                {
00034A  FA0000     LNK #0x0
78:                        INTCON1bits.OSCFAIL = 0;        /* Clear the trap flag */
00034C  A92080     BCLR INTCON1, #1
79:                        while(1);
00034E  37FFFF     BRA 0x34E
80:                }
81:                
82:                void __attribute__((interrupt,no_auto_psv)) _AddressError(void)
83:                {
000350  FA0000     LNK #0x0
84:                        INTCON1bits.ADDRERR = 0;        /* Clear the trap flag */
000352  A96080     BCLR INTCON1, #3
85:                        while (1);
000354  37FFFF     BRA 0x354
86:                }
87:                void __attribute__((interrupt,no_auto_psv)) _StackError(void)
88:                {
000356  FA0000     LNK #0x0
89:                        INTCON1bits.STKERR = 0;         /* Clear the trap flag */
000358  A94080     BCLR INTCON1, #2
90:                        while (1);
00035A  37FFFF     BRA 0x35A
91:                }
92:                
93:                void __attribute__((interrupt,no_auto_psv)) _MathError(void)
94:                {
00035C  FA0000     LNK #0x0
95:                        INTCON1bits.MATHERR = 0;        /* Clear the trap flag */
00035E  A98080     BCLR INTCON1, #4
96:                        while (1);
000360  37FFFF     BRA 0x360
97:                }
98:                
99:                #if defined(__HAS_DMA__)
100:               
101:               void __attribute__((interrupt,no_auto_psv)) _DMACError(void)
102:               {
000362  FA0000     LNK #0x0
103:                       INTCON1bits.DMACERR = 0;        /* Clear the trap flag */
000364  A9A080     BCLR INTCON1, #5
104:                       while (1);
000366  37FFFF     BRA 0x366
105:               }
106:               
107:               #endif
108:               
109:               #if defined(__dsPIC33F__)
110:               
111:               /* Alternate address error trap function declarations */
112:               void __attribute__((interrupt,no_auto_psv)) _AltOscillatorFail(void)
113:               {
000368  FA0000     LNK #0x0
114:                       INTCON1bits.OSCFAIL = 0;        /* Clear the trap flag */
00036A  A92080     BCLR INTCON1, #1
115:                       while (1);
00036C  37FFFF     BRA 0x36C
116:               }
117:               
118:               void __attribute__((interrupt,no_auto_psv)) _AltAddressError(void)
119:               {
00036E  FA0000     LNK #0x0
120:                       INTCON1bits.ADDRERR = 0;        /* Clear the trap flag */
000370  A96080     BCLR INTCON1, #3
121:                       while (1);
000372  37FFFF     BRA 0x372
122:               }
123:               
124:               void __attribute__((interrupt,no_auto_psv)) _AltStackError(void)
125:               {
000374  FA0000     LNK #0x0
126:                       INTCON1bits.STKERR = 0;         /* Clear the trap flag */
000376  A94080     BCLR INTCON1, #2
127:                       while (1);
000378  37FFFF     BRA 0x378
128:               }
129:               
130:               void __attribute__((interrupt,no_auto_psv)) _AltMathError(void)
131:               {
00037A  FA0000     LNK #0x0
132:                       INTCON1bits.MATHERR = 0;        /* Clear the trap flag */
00037C  A98080     BCLR INTCON1, #4
133:                       while (1);
00037E  37FFFF     BRA 0x37E
134:               }
135:               
136:                   #if defined(__HAS_DMA__)
137:               
138:                   void __attribute__((interrupt,no_auto_psv)) _AltDMACError(void)
139:                   {
000380  FA0000     LNK #0x0
140:                        INTCON1bits.DMACERR = 0;        /* Clear the trap flag */
000382  A9A080     BCLR INTCON1, #5
141:                        while (1);
000384  37FFFF     BRA 0x384
142:                   }
143:               
144:                   #endif
145:               
146:               #endif
147:               
148:               /******************************************************************************/
149:               /* Default Interrupt Handler                                                  */
150:               /*                                                                            */
151:               /* This executes when an interrupt occurs for an interrupt source with an     */
152:               /* improperly defined or undefined interrupt handling routine.                */
153:               /******************************************************************************/
154:               void __attribute__((interrupt,no_auto_psv)) _DefaultInterrupt(void)
155:               {
000386  FA0000     LNK #0x0
156:                       while(1);
000388  37FFFF     BRA 0x388
157:               }
158:               
159:               #if defined(__dsPIC33E__)
160:               
161:               /* These traps are new to the dsPIC33E family.  Refer to the device Interrupt
162:               chapter of the FRM to understand trap priority. */
163:               void __attribute__((interrupt,no_auto_psv)) _HardTrapError(void)
164:               {
165:                   while(1);
166:               }
167:               void __attribute__((interrupt,no_auto_psv)) _SoftTrapError(void)
168:               {
169:                   while(1);
170:               }
171:               
172:               #endif
---  C:/Users/dell/Desktop/MPLABXProjects/ultimate/system.c  --------------------------------------------
1:                 /******************************************************************************/
2:                 /* Files to Include                                                           */
3:                 /******************************************************************************/
4:                 
5:                 /* Device header file */
6:                 #if defined(__XC16__)
7:                     #include <xc.h>
8:                 #elif defined(__C30__)
9:                     #if defined(__dsPIC33E__)
10:                    	#include <p33Exxxx.h>
11:                    #elif defined(__dsPIC33F__)
12:                    	#include <p33Fxxxx.h>
13:                    #endif
14:                #endif
15:                
16:                #include <stdint.h>          /* For uint16_t definition                       */
17:                #include <stdbool.h>         /* For true/false definition                     */
18:                #include "system.h"          /* variables/params used by system.c             */
19:                
20:                /******************************************************************************/
21:                /* System Level Functions                                                     */
22:                /*                                                                            */
23:                /* Custom oscillator configuration funtions, reset source evaluation          */
24:                /* functions, and other non-peripheral microcontroller initialization         */
25:                /* functions get placed in system.c.                                          */
26:                /*                                                                            */
27:                /******************************************************************************/
28:                
29:                /* Refer to the device Family Reference Manual Oscillator section for
30:                information about available oscillator configurations.  Typically
31:                this would involve configuring the oscillator tuning register or clock
32:                switching useing the compiler's __builtin_write_OSCCON functions.
33:                Refer to the C Compiler for PIC24 MCUs and dsPIC DSCs User Guide in the
34:                compiler installation directory /doc folder for documentation on the
35:                __builtin functions.*/
36:                
37:                /* TODO Add clock switching code if appropriate.  An example stub is below.   */
38:                void ConfigureOscillator(void)
39:                {
002230  FA0000     LNK #0x0
40:                    // Configure Oscillator to operate the device at 40Mhz
41:                    // Fosc = Fin*M/(N1*N2), Fcy = Fosc/2
42:                    // Fosc = 7.3728M*43/(2*2) = 80Mhz for 7.3728M input clock, Fcy=40Mhz
43:                	PLLFBD=41;					// M=43
002232  200290     MOV #0x29, W0
002234  883A30     MOV W0, PLLFBD
44:                	CLKDIVbits.PLLPOST=0;		// N1=2
002236  803A21     MOV CLKDIV, W1
002238  2FF3F0     MOV #0xFF3F, W0
00223A  608000     AND W1, W0, W0
00223C  883A20     MOV W0, CLKDIV
45:                	CLKDIVbits.PLLPRE=0;		// N2=2
00223E  803A21     MOV CLKDIV, W1
002240  2FFE00     MOV #0xFFE0, W0
002242  608000     AND W1, W0, W0
002244  883A20     MOV W0, CLKDIV
46:                	OSCTUN=0x0015;              // Tune FRC oscillator 8Mhz, if FRC is used
002246  200150     MOV #0x15, W0
002248  883A40     MOV W0, OSCTUN
47:                    // Disable Watch Dog Timer
48:                	RCONbits.SWDTEN=0;
00224A  A9A740     BCLR RCON, #5
49:                
50:                    /*MPLAB® C Compiler for PIC24 MCUs and dsPIC DSCs provides the following built-in C language functions for unlocking and writing to the OSCCON register:*/
51:                    //__builtin_write_OSCCONH(value)
52:                    //__builtin_write_OSCCONL(value)
53:                    /*See MPLAB C Compiler Help for more information.*/
54:                    
55:                    // Clock switch to incorporate PLL
56:                	__builtin_write_OSCCONH(0x03);		// Initiate Clock Switch to Primary Oscillator with PLL (NOSC=0b011)
00224C  200032     MOV #0x3, W2
00224E  200780     MOV #0x78, W0
002250  2009A1     MOV #0x9A, W1
002252  207433     MOV #0x743, W3
002254  784980     MOV.B W0, [W3]
002256  784981     MOV.B W1, [W3]
002258  784982     MOV.B W2, [W3]
57:                	__builtin_write_OSCCONL(0x01);		// Start clock switching
00225A  200012     MOV #0x1, W2
00225C  200460     MOV #0x46, W0
00225E  200571     MOV #0x57, W1
002260  207423     MOV #0x742, W3
002262  784980     MOV.B W0, [W3]
002264  784981     MOV.B W1, [W3]
002266  784982     MOV.B W2, [W3]
58:                    //OSCCONbits.NOSC=0b011;
59:                    //OSCCONbits.OSWEN=1;
60:                    //OSCCON=0x0301;
61:                	while(OSCCONbits.COSC != 0b011);    // Wait for Clock switch to occur	
002268  000000     NOP
00226A  803A11     MOV OSCCON, W1
00226C  270000     MOV #0x7000, W0
00226E  608080     AND W1, W0, W1
002270  230000     MOV #0x3000, W0
002272  508F80     SUB W1, W0, [W15]
002274  3AFFFA     BRA NZ, 0x226A
62:                	while(OSCCONbits.LOCK !=1);         // Wait for PLL to lock, only if PLL is needed
002276  000000     NOP
002278  803A11     MOV OSCCON, W1
00227A  200200     MOV #0x20, W0
00227C  608000     AND W1, W0, W0
00227E  E00000     CP0 W0
002280  32FFFB     BRA Z, 0x2278
63:                    
64:                
65:                #if 0
66:                        /* Disable Watch Dog Timer */
67:                        RCONbits.SWDTEN = 0;
68:                
69:                        /* When clock switch occurs switch to Primary Osc (HS, XT, EC) */
70:                        __builtin_write_OSCCONH(0x02);  /* Set OSCCONH for clock switch */
71:                        __builtin_write_OSCCONL(0x01);  /* Start clock switching */
72:                        while(OSCCONbits.COSC != 0b010);
73:                        /* Wait for Clock switch to occur */
74:                        /* Wait for PLL to lock, only if PLL is needed */
75:                        /* while(OSCCONbits.LOCK != 1); */
76:                #endif
77:                }
002282  FA8000     ULNK
002284  060000     RETURN
78:                
---  C:/Users/dell/Desktop/MPLABXProjects/ultimate/model.c  ---------------------------------------------
1:                 /*
2:                 * File:   model.c
3:                 * Author: dracula
4:                 *
5:                 * Created on December 18, 2017, 1:29 AM
6:                 */
7:                 
8:                 #include "user.h"
9:                 extern Parameter P;
10:                Vector3f *OMRS_model(Vector3f *u, Vector3f *q, Vector3f *dq)
11:                {
001EAA  FA001E     LNK #0x1E
001EAC  BE9F88     MOV.D W8, [W15++]
001EAE  BE9F8A     MOV.D W10, [W15++]
001EB0  BE9F8C     MOV.D W12, [W15++]
001EB2  980F20     MOV W0, [W14+20]
001EB4  980F31     MOV W1, [W14+22]
001EB6  980F42     MOV W2, [W14+24]
12:                #ifdef printTimeConsumption
13:                	int modelInitTime = clock();
14:                #endif // printTimeConsumption
15:                
16:                	Vector3f *ddq;
17:                	Matrix *Ravc = m_constructor(local, NULL, NULL, cos(q->z), -sin(q->z), 0, sin(q->z), cos(q->z), 0, 0, 0, 1);
001EB8  90083E     MOV [W14+22], W0
001EBA  9000D0     MOV [W0+10], W1
001EBC  900040     MOV [W0+8], W0
001EBE  07F2F0     RCALL _cosf
001EC0  BE0600     MOV.D W0, W12
001EC2  90083E     MOV [W14+22], W0
001EC4  9000D0     MOV [W0+10], W1
001EC6  900040     MOV [W0+8], W0
001EC8  07F440     RCALL _sinf
001ECA  BE0500     MOV.D W0, W10
001ECC  90083E     MOV [W14+22], W0
001ECE  9000D0     MOV [W0+10], W1
001ED0  900040     MOV [W0+8], W0
001ED2  07F43B     RCALL _sinf
001ED4  BE0400     MOV.D W0, W8
001ED6  A2F009     BTG W9, #15
001ED8  90083E     MOV [W14+22], W0
001EDA  9000D0     MOV [W0+10], W1
001EDC  900040     MOV [W0+8], W0
001EDE  07F2E0     RCALL _cosf
001EE0  200002     MOV #0x0, W2
001EE2  23F803     MOV #0x3F80, W3
001EE4  BE9F82     MOV.D W2, [W15++]
001EE6  B81160     MUL.UU W2, #0, W2
001EE8  BE9F82     MOV.D W2, [W15++]
001EEA  B81160     MUL.UU W2, #0, W2
001EEC  BE9F82     MOV.D W2, [W15++]
001EEE  B81160     MUL.UU W2, #0, W2
001EF0  BE9F82     MOV.D W2, [W15++]
001EF2  BE9F8C     MOV.D W12, [W15++]
001EF4  BE9F8A     MOV.D W10, [W15++]
001EF6  B81160     MUL.UU W2, #0, W2
001EF8  BE9F82     MOV.D W2, [W15++]
001EFA  BE0308     MOV.D W8, W6
001EFC  BE0200     MOV.D W0, W4
001EFE  EB0100     CLR W2
001F00  EB0080     CLR W1
001F02  EB4000     CLR.B W0
001F04  07F5A4     RCALL m_constructor
001F06  5787FC     SUB W15, #0x1C, W15
001F08  780F00     MOV W0, [W14]
18:                	Matrix *DRavc = m_constructor(local, NULL, NULL, -sin(q->z)*dq->z, -cos(q->z)*dq->z, 0, cos(q->z)*dq->z, -sin(q->z)*dq->z, 0, 0, 0, 0);
001F0A  90083E     MOV [W14+22], W0
001F0C  9000D0     MOV [W0+10], W1
001F0E  900040     MOV [W0+8], W0
001F10  07F41C     RCALL _sinf
001F12  BE0200     MOV.D W0, W4
001F14  A2F005     BTG W5, #15
001F16  90084E     MOV [W14+24], W0
001F18  9000D0     MOV [W0+10], W1
001F1A  900040     MOV [W0+8], W0
001F1C  BE0100     MOV.D W0, W2
001F1E  BE0004     MOV.D W4, W0
001F20  07F377     RCALL ___mulsf3
001F22  BE0600     MOV.D W0, W12
001F24  90083E     MOV [W14+22], W0
001F26  9000D0     MOV [W0+10], W1
001F28  900040     MOV [W0+8], W0
001F2A  07F2BA     RCALL _cosf
001F2C  BE0200     MOV.D W0, W4
001F2E  90084E     MOV [W14+24], W0
001F30  9000D0     MOV [W0+10], W1
001F32  900040     MOV [W0+8], W0
001F34  BE0100     MOV.D W0, W2
001F36  BE0004     MOV.D W4, W0
001F38  07F36B     RCALL ___mulsf3
001F3A  BE0500     MOV.D W0, W10
001F3C  90083E     MOV [W14+22], W0
001F3E  9000D0     MOV [W0+10], W1
001F40  900040     MOV [W0+8], W0
001F42  07F2AE     RCALL _cosf
001F44  BE0200     MOV.D W0, W4
001F46  A2F005     BTG W5, #15
001F48  90084E     MOV [W14+24], W0
001F4A  9000D0     MOV [W0+10], W1
001F4C  900040     MOV [W0+8], W0
001F4E  BE0100     MOV.D W0, W2
001F50  BE0004     MOV.D W4, W0
001F52  07F35E     RCALL ___mulsf3
001F54  BE0400     MOV.D W0, W8
001F56  90083E     MOV [W14+22], W0
001F58  9000D0     MOV [W0+10], W1
001F5A  900040     MOV [W0+8], W0
001F5C  07F3F6     RCALL _sinf
001F5E  BE0200     MOV.D W0, W4
001F60  A2F005     BTG W5, #15
001F62  90084E     MOV [W14+24], W0
001F64  9000D0     MOV [W0+10], W1
001F66  900040     MOV [W0+8], W0
001F68  BE0100     MOV.D W0, W2
001F6A  BE0004     MOV.D W4, W0
001F6C  07F351     RCALL ___mulsf3
001F6E  B81160     MUL.UU W2, #0, W2
001F70  BE9F82     MOV.D W2, [W15++]
001F72  B81160     MUL.UU W2, #0, W2
001F74  BE9F82     MOV.D W2, [W15++]
001F76  B81160     MUL.UU W2, #0, W2
001F78  BE9F82     MOV.D W2, [W15++]
001F7A  B81160     MUL.UU W2, #0, W2
001F7C  BE9F82     MOV.D W2, [W15++]
001F7E  BE9F8C     MOV.D W12, [W15++]
001F80  BE9F8A     MOV.D W10, [W15++]
001F82  B81160     MUL.UU W2, #0, W2
001F84  BE9F82     MOV.D W2, [W15++]
001F86  BE0308     MOV.D W8, W6
001F88  BE0200     MOV.D W0, W4
001F8A  EB0100     CLR W2
001F8C  EB0080     CLR W1
001F8E  EB4000     CLR.B W0
001F90  07F55E     RCALL m_constructor
001F92  5787FC     SUB W15, #0x1C, W15
001F94  980710     MOV W0, [W14+2]
19:                	Matrix *M2avc = m_constructor(local, NULL, NULL, 1.5*P.beta0 + P.m, 0, 0, 0, 1.5*P.beta0 + P.m, 0, 0, 0, 3 * P.beta0*pow(P.La, 2) + P.Iv);
001F96  805C30     MOV 0xB86, W0
001F98  805C41     MOV 0xB88, W1
001F9A  200002     MOV #0x0, W2
001F9C  240403     MOV #0x4040, W3
001F9E  07F338     RCALL ___mulsf3
001FA0  BE0400     MOV.D W0, W8
001FA2  805B50     MOV 0xB6A, W0
001FA4  805B61     MOV 0xB6C, W1
001FA6  BE0100     MOV.D W0, W2
001FA8  07F333     RCALL ___mulsf3
001FAA  BE0100     MOV.D W0, W2
001FAC  BE0008     MOV.D W8, W0
001FAE  07F330     RCALL ___mulsf3
001FB0  BE0200     MOV.D W0, W4
001FB2  805AD0     MOV 0xB5A, W0
001FB4  805AE1     MOV 0xB5C, W1
001FB6  BE0100     MOV.D W0, W2
001FB8  BE0004     MOV.D W4, W0
001FBA  07F215     RCALL ___addsf3
001FBC  BE0500     MOV.D W0, W10
001FBE  805C30     MOV 0xB86, W0
001FC0  805C41     MOV 0xB88, W1
001FC2  200002     MOV #0x0, W2
001FC4  23FC03     MOV #0x3FC0, W3
001FC6  07F324     RCALL ___mulsf3
001FC8  BE0200     MOV.D W0, W4
001FCA  805AB0     MOV P, W0
001FCC  805AC1     MOV 0xB58, W1
001FCE  BE0100     MOV.D W0, W2
001FD0  BE0004     MOV.D W4, W0
001FD2  07F209     RCALL ___addsf3
001FD4  BE0400     MOV.D W0, W8
001FD6  805C30     MOV 0xB86, W0
001FD8  805C41     MOV 0xB88, W1
001FDA  200002     MOV #0x0, W2
001FDC  23FC03     MOV #0x3FC0, W3
001FDE  07F318     RCALL ___mulsf3
001FE0  BE0200     MOV.D W0, W4
001FE2  805AB0     MOV P, W0
001FE4  805AC1     MOV 0xB58, W1
001FE6  BE0100     MOV.D W0, W2
001FE8  BE0004     MOV.D W4, W0
001FEA  07F1FD     RCALL ___addsf3
001FEC  BE9F8A     MOV.D W10, [W15++]
001FEE  B81160     MUL.UU W2, #0, W2
001FF0  BE9F82     MOV.D W2, [W15++]
001FF2  B81160     MUL.UU W2, #0, W2
001FF4  BE9F82     MOV.D W2, [W15++]
001FF6  B81160     MUL.UU W2, #0, W2
001FF8  BE9F82     MOV.D W2, [W15++]
001FFA  BE9F88     MOV.D W8, [W15++]
001FFC  B81160     MUL.UU W2, #0, W2
001FFE  BE9F82     MOV.D W2, [W15++]
002000  B81160     MUL.UU W2, #0, W2
002002  BE9F82     MOV.D W2, [W15++]
002004  B83360     MUL.UU W6, #0, W6
002006  BE0200     MOV.D W0, W4
002008  EB0100     CLR W2
00200A  EB0080     CLR W1
00200C  EB4000     CLR.B W0
00200E  07F51F     RCALL m_constructor
002010  5787FC     SUB W15, #0x1C, W15
002012  980720     MOV W0, [W14+4]
20:                	Matrix *C2avc = m_constructor(local, NULL, NULL, 1.5*P.beta1, -P.m*dq->z, 0, P.m*dq->z, 1.5*P.beta1, 0, 0, 0, 3 * P.beta1*pow(P.La, 2));
002014  805C50     MOV 0xB8A, W0
002016  805C61     MOV 0xB8C, W1
002018  200002     MOV #0x0, W2
00201A  240403     MOV #0x4040, W3
00201C  07F2F9     RCALL ___mulsf3
00201E  BE0400     MOV.D W0, W8
002020  805B50     MOV 0xB6A, W0
002022  805B61     MOV 0xB6C, W1
002024  BE0100     MOV.D W0, W2
002026  07F2F4     RCALL ___mulsf3
002028  BE0100     MOV.D W0, W2
00202A  BE0008     MOV.D W8, W0
00202C  07F2F1     RCALL ___mulsf3
00202E  BE0100     MOV.D W0, W2
002030  980F52     MOV W2, [W14+26]
002032  980F63     MOV W3, [W14+28]
002034  805C50     MOV 0xB8A, W0
002036  805C61     MOV 0xB8C, W1
002038  200002     MOV #0x0, W2
00203A  23FC03     MOV #0x3FC0, W3
00203C  07F2E9     RCALL ___mulsf3
00203E  BE0600     MOV.D W0, W12
002040  805AB4     MOV P, W4
002042  805AC5     MOV 0xB58, W5
002044  90084E     MOV [W14+24], W0
002046  9000D0     MOV [W0+10], W1
002048  900040     MOV [W0+8], W0
00204A  BE0100     MOV.D W0, W2
00204C  BE0004     MOV.D W4, W0
00204E  07F2E0     RCALL ___mulsf3
002050  BE0500     MOV.D W0, W10
002052  805AB0     MOV P, W0
002054  805AC1     MOV 0xB58, W1
002056  BE0200     MOV.D W0, W4
002058  A2F005     BTG W5, #15
00205A  90084E     MOV [W14+24], W0
00205C  9000D0     MOV [W0+10], W1
00205E  900040     MOV [W0+8], W0
002060  BE0100     MOV.D W0, W2
002062  BE0004     MOV.D W4, W0
002064  07F2D5     RCALL ___mulsf3
002066  BE0400     MOV.D W0, W8
002068  805C50     MOV 0xB8A, W0
00206A  805C61     MOV 0xB8C, W1
00206C  200002     MOV #0x0, W2
00206E  23FC03     MOV #0x3FC0, W3
002070  07F2CF     RCALL ___mulsf3
002072  90095E     MOV [W14+26], W2
002074  9009EE     MOV [W14+28], W3
002076  BE9F82     MOV.D W2, [W15++]
002078  B81160     MUL.UU W2, #0, W2
00207A  BE9F82     MOV.D W2, [W15++]
00207C  B81160     MUL.UU W2, #0, W2
00207E  BE9F82     MOV.D W2, [W15++]
002080  B81160     MUL.UU W2, #0, W2
002082  BE9F82     MOV.D W2, [W15++]
002084  BE9F8C     MOV.D W12, [W15++]
002086  BE9F8A     MOV.D W10, [W15++]
002088  B81160     MUL.UU W2, #0, W2
00208A  BE9F82     MOV.D W2, [W15++]
00208C  BE0308     MOV.D W8, W6
00208E  BE0200     MOV.D W0, W4
002090  EB0100     CLR W2
002092  EB0080     CLR W1
002094  EB4000     CLR.B W0
002096  07F4DB     RCALL m_constructor
002098  5787FC     SUB W15, #0x1C, W15
00209A  980730     MOV W0, [W14+6]
21:                	Matrix *RavcRev = m_constructor(local, NULL, NULL, cos(q->z), sin(q->z), 0, -sin(q->z), cos(q->z), 0, 0, 0, 1);
00209C  90083E     MOV [W14+22], W0
00209E  9000D0     MOV [W0+10], W1
0020A0  900040     MOV [W0+8], W0
0020A2  07F1FE     RCALL _cosf
0020A4  BE0600     MOV.D W0, W12
0020A6  90083E     MOV [W14+22], W0
0020A8  9000D0     MOV [W0+10], W1
0020AA  900040     MOV [W0+8], W0
0020AC  07F34E     RCALL _sinf
0020AE  BE0500     MOV.D W0, W10
0020B0  A2F00B     BTG W11, #15
0020B2  90083E     MOV [W14+22], W0
0020B4  9000D0     MOV [W0+10], W1
0020B6  900040     MOV [W0+8], W0
0020B8  07F348     RCALL _sinf
0020BA  BE0400     MOV.D W0, W8
0020BC  90083E     MOV [W14+22], W0
0020BE  9000D0     MOV [W0+10], W1
0020C0  900040     MOV [W0+8], W0
0020C2  07F1EE     RCALL _cosf
0020C4  200002     MOV #0x0, W2
0020C6  23F803     MOV #0x3F80, W3
0020C8  BE9F82     MOV.D W2, [W15++]
0020CA  B81160     MUL.UU W2, #0, W2
0020CC  BE9F82     MOV.D W2, [W15++]
0020CE  B81160     MUL.UU W2, #0, W2
0020D0  BE9F82     MOV.D W2, [W15++]
0020D2  B81160     MUL.UU W2, #0, W2
0020D4  BE9F82     MOV.D W2, [W15++]
0020D6  BE9F8C     MOV.D W12, [W15++]
0020D8  BE9F8A     MOV.D W10, [W15++]
0020DA  B81160     MUL.UU W2, #0, W2
0020DC  BE9F82     MOV.D W2, [W15++]
0020DE  BE0308     MOV.D W8, W6
0020E0  BE0200     MOV.D W0, W4
0020E2  EB0100     CLR W2
0020E4  EB0080     CLR W1
0020E6  EB4000     CLR.B W0
0020E8  07F4B2     RCALL m_constructor
0020EA  5787FC     SUB W15, #0x1C, W15
0020EC  980740     MOV W0, [W14+8]
22:                	Matrix *Mavc = m_m_multiply(M2avc, RavcRev);
0020EE  9000CE     MOV [W14+8], W1
0020F0  90002E     MOV [W14+4], W0
0020F2  07F5E2     RCALL m_m_multiply
0020F4  980750     MOV W0, [W14+10]
23:                	Matrix *Cavc = m_minus(m_m_multiply(C2avc, RavcRev), m_m_multiply(M2avc, m_m_multiply(RavcRev, m_m_multiply(DRavc, RavcRev))));
0020F6  9000CE     MOV [W14+8], W1
0020F8  90001E     MOV [W14+2], W0
0020FA  07F5DE     RCALL m_m_multiply
0020FC  780080     MOV W0, W1
0020FE  90004E     MOV [W14+8], W0
002100  07F5DB     RCALL m_m_multiply
002102  780080     MOV W0, W1
002104  90002E     MOV [W14+4], W0
002106  07F5D8     RCALL m_m_multiply
002108  780400     MOV W0, W8
00210A  9000CE     MOV [W14+8], W1
00210C  90003E     MOV [W14+6], W0
00210E  07F5D4     RCALL m_m_multiply
002110  780088     MOV W8, W1
002112  07F588     RCALL m_minus
002114  980760     MOV W0, [W14+12]
24:                	Matrix *BavcOri = m_constructor(local, NULL, NULL, -0.5, -0.5, 1, 0.866, -0.866, 0, P.La, P.La, P.La);
002116  805B54     MOV 0xB6A, W4
002118  805B65     MOV 0xB6C, W5
00211A  805B52     MOV 0xB6A, W2
00211C  805B63     MOV 0xB6C, W3
00211E  805B50     MOV 0xB6A, W0
002120  805B61     MOV 0xB6C, W1
002122  BE9F84     MOV.D W4, [W15++]
002124  BE9F82     MOV.D W2, [W15++]
002126  BE9F80     MOV.D W0, [W15++]
002128  B80060     MUL.UU W0, #0, W0
00212A  BE9F80     MOV.D W0, [W15++]
00212C  2B22D0     MOV #0xB22D, W0
00212E  2BF5D1     MOV #0xBF5D, W1
002130  BE9F80     MOV.D W0, [W15++]
002132  2B22D0     MOV #0xB22D, W0
002134  23F5D1     MOV #0x3F5D, W1
002136  BE9F80     MOV.D W0, [W15++]
002138  200000     MOV #0x0, W0
00213A  23F801     MOV #0x3F80, W1
00213C  BE9F80     MOV.D W0, [W15++]
00213E  200006     MOV #0x0, W6
002140  2BF007     MOV #0xBF00, W7
002142  200004     MOV #0x0, W4
002144  2BF005     MOV #0xBF00, W5
002146  EB0100     CLR W2
002148  EB0080     CLR W1
00214A  EB4000     CLR.B W0
00214C  07F480     RCALL m_constructor
00214E  5787FC     SUB W15, #0x1C, W15
002150  980770     MOV W0, [W14+14]
25:                	Matrix *Bavc = m_s_multiply(BavcOri, P.beta2);
002152  805C70     MOV 0xB8E, W0
002154  805C81     MOV _m_plus, W1
002156  BE0100     MOV.D W0, W2
002158  90007E     MOV [W14+14], W0
00215A  07F697     RCALL m_s_multiply
00215C  980F00     MOV W0, [W14+16]
26:                	ddq = m_v_multiply(m_inverse(Mavc), v_minus(m_v_multiply(Bavc, u), m_v_multiply(Cavc, dq)));
00215E  9008CE     MOV [W14+24], W1
002160  90006E     MOV [W14+12], W0
002162  07F617     RCALL m_v_multiply
002164  780400     MOV W0, W8
002166  9008AE     MOV [W14+20], W1
002168  90080E     MOV [W14+16], W0
00216A  07F613     RCALL m_v_multiply
00216C  780088     MOV W8, W1
00216E  07FBAD     RCALL v_minus
002170  780400     MOV W0, W8
002172  90005E     MOV [W14+10], W0
002174  07F841     RCALL m_inverse
002176  780088     MOV W8, W1
002178  07F60C     RCALL m_v_multiply
00217A  980F10     MOV W0, [W14+18]
27:                
28:                #ifdef printDetail
29:                    printf("ddq: %f,%f,%f\n", ddq->x, ddq->y, ddq->z);
30:                	printf("Ravc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
31:                		Ravc->triMatrix[0][0], Ravc->triMatrix[0][1], Ravc->triMatrix[0][2],
32:                		Ravc->triMatrix[1][0], Ravc->triMatrix[1][1], Ravc->triMatrix[1][2],
33:                		Ravc->triMatrix[2][0], Ravc->triMatrix[2][1], Ravc->triMatrix[2][2]);
34:                	printf("DRavc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
35:                		DRavc->triMatrix[0][0], DRavc->triMatrix[0][1], DRavc->triMatrix[0][2],
36:                		DRavc->triMatrix[1][0], DRavc->triMatrix[1][1], DRavc->triMatrix[1][2],
37:                		DRavc->triMatrix[2][0], DRavc->triMatrix[2][1], DRavc->triMatrix[2][2]);
38:                	printf("M2avc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
39:                		M2avc->triMatrix[0][0], M2avc->triMatrix[0][1], M2avc->triMatrix[0][2],
40:                		M2avc->triMatrix[1][0], M2avc->triMatrix[1][1], M2avc->triMatrix[1][2],
41:                		M2avc->triMatrix[2][0], M2avc->triMatrix[2][1], M2avc->triMatrix[2][2]);
42:                	printf("C2avc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
43:                		C2avc->triMatrix[0][0], C2avc->triMatrix[0][1], C2avc->triMatrix[0][2],
44:                		C2avc->triMatrix[1][0], C2avc->triMatrix[1][1], C2avc->triMatrix[1][2],
45:                		C2avc->triMatrix[2][0], C2avc->triMatrix[2][1], C2avc->triMatrix[2][2]);
46:                	printf("RavcRev: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
47:                		RavcRev->triMatrix[0][0], RavcRev->triMatrix[0][1], RavcRev->triMatrix[0][2],
48:                		RavcRev->triMatrix[1][0], RavcRev->triMatrix[1][1], RavcRev->triMatrix[1][2],
49:                		RavcRev->triMatrix[2][0], RavcRev->triMatrix[2][1], RavcRev->triMatrix[2][2]);
50:                	printf("Mavc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
51:                		Mavc->triMatrix[0][0], Mavc->triMatrix[0][1], Mavc->triMatrix[0][2],
52:                		Mavc->triMatrix[1][0], Mavc->triMatrix[1][1], Mavc->triMatrix[1][2],
53:                		Mavc->triMatrix[2][0], Mavc->triMatrix[2][1], Mavc->triMatrix[2][2]);
54:                	printf("Cavc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
55:                		Cavc->triMatrix[0][0], Cavc->triMatrix[0][1], Cavc->triMatrix[0][2],
56:                		Cavc->triMatrix[1][0], Cavc->triMatrix[1][1], Cavc->triMatrix[1][2],
57:                		Cavc->triMatrix[2][0], Cavc->triMatrix[2][1], Cavc->triMatrix[2][2]);
58:                	printf("BavcOri: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
59:                		BavcOri->triMatrix[0][0], BavcOri->triMatrix[0][1], BavcOri->triMatrix[0][2],
60:                		BavcOri->triMatrix[1][0], BavcOri->triMatrix[1][1], BavcOri->triMatrix[1][2],
61:                		BavcOri->triMatrix[2][0], BavcOri->triMatrix[2][1], BavcOri->triMatrix[2][2]);
62:                	printf("Bavc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
63:                		Bavc->triMatrix[0][0], Bavc->triMatrix[0][1], Bavc->triMatrix[0][2],
64:                		Bavc->triMatrix[1][0], Bavc->triMatrix[1][1], Bavc->triMatrix[1][2],
65:                		Bavc->triMatrix[2][0], Bavc->triMatrix[2][1], Bavc->triMatrix[2][2]);
66:                
67:                	Matrix *tm1 = m_m_multiply(C2avc, RavcRev);
68:                	Matrix *tm2 = m_m_multiply(M2avc, RavcRev);
69:                	Matrix *tm3 = m_m_multiply(M2avc, m_m_multiply(RavcRev, m_m_multiply(DRavc, RavcRev)));
70:                	printf("C2avc*RavcRev\': %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
71:                		tm1->triMatrix[0][0], tm1->triMatrix[0][1], tm1->triMatrix[0][2],
72:                		tm1->triMatrix[1][0], tm1->triMatrix[1][1], tm1->triMatrix[1][2],
73:                		tm1->triMatrix[2][0], tm1->triMatrix[2][1], tm1->triMatrix[2][2]);
74:                	printf("M2avc*Ravc\'*DRavc*Ravc\': %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
75:                		tm2->triMatrix[0][0], tm2->triMatrix[0][1], tm2->triMatrix[0][2],
76:                		tm2->triMatrix[1][0], tm2->triMatrix[1][1], tm2->triMatrix[1][2],
77:                		tm2->triMatrix[2][0], tm2->triMatrix[2][1], tm2->triMatrix[2][2]);
78:                	printf("M2avc*Ravc\'*DRavc*Ravc\': %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
79:                		tm3->triMatrix[0][0], tm3->triMatrix[0][1], tm3->triMatrix[0][2],
80:                		tm3->triMatrix[1][0], tm3->triMatrix[1][1], tm3->triMatrix[1][2],
81:                		tm3->triMatrix[2][0], tm3->triMatrix[2][1], tm3->triMatrix[2][2]);
82:                #endif // printDetail
83:                
84:                #ifdef printTimeConsumption
85:                	printf("model time: %d\n", (clock() - modelInitTime));
86:                #endif // printTimeConsumption
87:                
88:                	return ddq;
00217C  90081E     MOV [W14+18], W0
89:                }
00217E  BE064F     MOV.D [--W15], W12
002180  BE054F     MOV.D [--W15], W10
002182  BE044F     MOV.D [--W15], W8
002184  FA8000     ULNK
002186  060000     RETURN
---  C:/Users/dell/Desktop/MPLABXProjects/ultimate/matrix.c  --------------------------------------------
1:                 /*
2:                  * File:   matrix.c
3:                  * Author: dracula
4:                  *
5:                  * Created on December 28, 2016, 10:06 PM
6:                  */
7:                 
8:                 #include "user.h"
9:                 extern int countMatrix;
10:                extern int countMatrixGlobal;
11:                extern Matrix *pointerMatrix[];
12:                extern Matrix *pointerMatrixGlobal[];
13:                //Matrix *m_constructor(Matrix*m, float *triMatrix[3][3], float x11=0, float x12=0, float x13=0, float x21=0, float x22=0, float x23=0, float x31=0, float x32=0, float x33=0)
14:                Matrix *m_constructor(bool globalMatrix, Matrix*m, float triMatrix[3][3], float x11, float x12, float x13, float x21, float x22, float x23, float x31, float x32, float x33)
15:                {
000A4E  FA0012     LNK #0x12
000A50  781F88     MOV W8, [W15++]
000A52  984740     MOV.B W0, [W14+4]
000A54  980731     MOV W1, [W14+6]
000A56  980742     MOV W2, [W14+8]
000A58  980754     MOV W4, [W14+10]
000A5A  980765     MOV W5, [W14+12]
000A5C  980776     MOV W6, [W14+14]
000A5E  980F07     MOV W7, [W14+16]
16:                    if(m == NULL)
000A60  90003E     MOV [W14+6], W0
000A62  E00000     CP0 W0
000A64  3A002D     BRA NZ, 0xAC0
17:                    {
18:                		if (!globalMatrix)
000A66  90404E     MOV.B [W14+4], W0
000A68  A20400     BTG.B W0, #0
000A6A  E00400     CP0.B W0
000A6C  320015     BRA Z, 0xA98
19:                		{
20:                			pointerMatrix[countMatrix] = (Matrix*)malloc(sizeof(Matrix));
000A6E  8040B8     MOV countMatrix, W8
000A70  200280     MOV #0x28, W0
000A72  07FFB9     RCALL _malloc
000A74  780080     MOV W0, W1
000A76  440108     ADD W8, W8, W2
000A78  208200     MOV #0x820, W0
000A7A  410000     ADD W2, W0, W0
000A7C  780801     MOV W1, [W0]
21:                			m = pointerMatrix[countMatrix];
000A7E  8040B0     MOV countMatrix, W0
000A80  400080     ADD W0, W0, W1
000A82  208200     MOV #0x820, W0
000A84  408000     ADD W1, W0, W0
000A86  780090     MOV [W0], W1
000A88  980731     MOV W1, [W14+6]
22:                			m->thisMatrixAddress = countMatrix;
000A8A  8040B1     MOV countMatrix, W1
000A8C  90003E     MOV [W14+6], W0
000A8E  981021     MOV W1, [W0+36]
23:                			countMatrix++;
000A90  8040B0     MOV countMatrix, W0
000A92  E80000     INC W0, W0
000A94  8840B0     MOV W0, countMatrix
000A96  370014     BRA 0xAC0
24:                		}
25:                		else {
26:                			pointerMatrixGlobal[countMatrixGlobal] = (Matrix*)malloc(sizeof(Matrix));
000A98  8040D8     MOV countMatrixGlobal, W8
000A9A  200280     MOV #0x28, W0
000A9C  07FFA4     RCALL _malloc
000A9E  780080     MOV W0, W1
000AA0  440108     ADD W8, W8, W2
000AA2  208E80     MOV #0x8E8, W0
000AA4  410000     ADD W2, W0, W0
000AA6  780801     MOV W1, [W0]
27:                			m = pointerMatrixGlobal[countMatrixGlobal];
000AA8  8040D0     MOV countMatrixGlobal, W0
000AAA  400080     ADD W0, W0, W1
000AAC  208E80     MOV #0x8E8, W0
000AAE  408000     ADD W1, W0, W0
000AB0  780110     MOV [W0], W2
000AB2  980732     MOV W2, [W14+6]
28:                			m->thisMatrixAddress = countMatrixGlobal;
000AB4  8040D1     MOV countMatrixGlobal, W1
000AB6  90003E     MOV [W14+6], W0
000AB8  981021     MOV W1, [W0+36]
29:                			countMatrixGlobal++;
000ABA  8040D0     MOV countMatrixGlobal, W0
000ABC  E80000     INC W0, W0
000ABE  8840D0     MOV W0, countMatrixGlobal
30:                		}
31:                	}
32:                
33:                	m->globalMatrix = globalMatrix;
000AC0  90003E     MOV [W14+6], W0
000AC2  9041CE     MOV.B [W14+4], W3
000AC4  986063     MOV.B W3, [W0+38]
34:                    int i,j;
35:                    if(triMatrix == NULL)
000AC6  90004E     MOV [W14+8], W0
000AC8  E00000     CP0 W0
000ACA  3A002D     BRA NZ, 0xB26
36:                    {
37:                        m->triMatrix[0][0] = x11;
000ACC  90003E     MOV [W14+6], W0
000ACE  90015E     MOV [W14+10], W2
000AD0  9001EE     MOV [W14+12], W3
000AD2  BE8802     MOV.D W2, [W0]
38:                        m->triMatrix[0][1] = x12;
000AD4  90003E     MOV [W14+6], W0
000AD6  90017E     MOV [W14+14], W2
000AD8  90098E     MOV [W14+16], W3
000ADA  980022     MOV W2, [W0+4]
000ADC  980033     MOV W3, [W0+6]
39:                        m->triMatrix[0][2] = x13;
000ADE  90003E     MOV [W14+6], W0
000AE0  97B93E     MOV [W14-10], W2
000AE2  97B9CE     MOV [W14-8], W3
000AE4  980042     MOV W2, [W0+8]
000AE6  980053     MOV W3, [W0+10]
40:                        m->triMatrix[1][0] = x21;
000AE8  90003E     MOV [W14+6], W0
000AEA  97B91E     MOV [W14-14], W2
000AEC  97B9AE     MOV [W14-12], W3
000AEE  980062     MOV W2, [W0+12]
000AF0  980073     MOV W3, [W0+14]
41:                        m->triMatrix[1][1] = x22;
000AF2  90003E     MOV [W14+6], W0
000AF4  97B17E     MOV [W14-18], W2
000AF6  97B98E     MOV [W14-16], W3
000AF8  980802     MOV W2, [W0+16]
000AFA  980813     MOV W3, [W0+18]
42:                        m->triMatrix[1][2] = x23;
000AFC  90003E     MOV [W14+6], W0
000AFE  97B15E     MOV [W14-22], W2
000B00  97B1EE     MOV [W14-20], W3
000B02  980822     MOV W2, [W0+20]
000B04  980833     MOV W3, [W0+22]
43:                        m->triMatrix[2][0] = x31;
000B06  90003E     MOV [W14+6], W0
000B08  97B13E     MOV [W14-26], W2
000B0A  97B1CE     MOV [W14-24], W3
000B0C  980842     MOV W2, [W0+24]
000B0E  980853     MOV W3, [W0+26]
44:                        m->triMatrix[2][1] = x32;
000B10  90003E     MOV [W14+6], W0
000B12  97B11E     MOV [W14-30], W2
000B14  97B1AE     MOV [W14-28], W3
000B16  980862     MOV W2, [W0+28]
000B18  980873     MOV W3, [W0+30]
45:                        m->triMatrix[2][2] = x33;
000B1A  90003E     MOV [W14+6], W0
000B1C  97A97E     MOV [W14-34], W2
000B1E  97B18E     MOV [W14-32], W3
000B20  981002     MOV W2, [W0+32]
000B22  981013     MOV W3, [W0+34]
000B24  370022     BRA 0xB6A
46:                    }
47:                    else
48:                    {
49:                    for(i=0;i<3;i++)
000B26  EB0000     CLR W0
000B28  780F00     MOV W0, [W14]
000B2A  37001C     BRA 0xB64
000B62  E80F1E     INC [W14], [W14]
000B64  78001E     MOV [W14], W0
000B66  500FE2     SUB W0, #0x2, [W15]
000B68  34FFE1     BRA LE, 0xB2C
50:                    {
51:                        for(j=0;j<3;j++)
000B2C  EB0000     CLR W0
000B2E  980710     MOV W0, [W14+2]
000B30  370015     BRA 0xB5C
000B56  90001E     MOV [W14+2], W0
000B58  E80000     INC W0, W0
000B5A  980710     MOV W0, [W14+2]
000B5C  90001E     MOV [W14+2], W0
000B5E  500FE2     SUB W0, #0x2, [W15]
000B60  34FFE8     BRA LE, 0xB32
52:                        {
53:                            m->triMatrix[i][j] = triMatrix[i][j];
000B32  78001E     MOV [W14], W0
000B34  B9006C     MUL.SU W0, #12, W0
000B36  780000     MOV W0, W0
000B38  9000CE     MOV [W14+8], W1
000B3A  408080     ADD W1, W0, W1
000B3C  90001E     MOV [W14+2], W0
000B3E  DD0042     SL W0, #2, W0
000B40  408000     ADD W1, W0, W0
000B42  BE0010     MOV.D [W0], W0
000B44  90023E     MOV [W14+6], W4
000B46  78011E     MOV [W14], W2
000B48  B91163     MUL.SU W2, #3, W2
000B4A  780182     MOV W2, W3
000B4C  90011E     MOV [W14+2], W2
000B4E  418102     ADD W3, W2, W2
000B50  DD1142     SL W2, #2, W2
000B52  420102     ADD W4, W2, W2
000B54  BE8900     MOV.D W0, [W2]
54:                        }
55:                    };
56:                    }
57:                    //m->m_plus = m_plus;
58:                    //m->m_minus = m_minus;
59:                    //m->m_m_multiply = m_m_multiply;
60:                    //m->m_v_multiply = m_v_multiply;
61:                    //m->m_s_multiply = m_s_multiply;
62:                    //m->m_determinant = m_determinant;
63:                    //m->m_cofactor = m_cofactor;
64:                    //m->m_inverse = m_inverse;
65:                    return m;
000B6A  90003E     MOV [W14+6], W0
66:                };
000B6C  78044F     MOV [--W15], W8
000B6E  FA8000     ULNK
000B70  060000     RETURN
67:                
68:                void m_destructor(Matrix*m, bool dynamic)
69:                {
000B72  FA0004     LNK #0x4
000B74  780F00     MOV W0, [W14]
000B76  984721     MOV.B W1, [W14+2]
70:                    if(dynamic)
000B78  90402E     MOV.B [W14+2], W0
000B7A  E00400     CP0.B W0
000B7C  320007     BRA Z, 0xB8C
71:                    {
72:                		if (m->globalMatrix == false)
000B7E  78001E     MOV [W14], W0
000B80  906060     MOV.B [W0+38], W0
000B82  A20400     BTG.B W0, #0
000B84  E00400     CP0.B W0
000B86  320002     BRA Z, 0xB8C
73:                		{
74:                			free(m);
000B88  78001E     MOV [W14], W0
000B8A  07FEC8     RCALL _free
75:                		}
76:                    }
77:                };
000B8C  FA8000     ULNK
000B8E  060000     RETURN
78:                
79:                Matrix *m_plus(Matrix*m,Matrix*n)
80:                {
000B90  FA000A     LNK #0xA
000B92  980730     MOV W0, [W14+6]
000B94  980741     MOV W1, [W14+8]
81:                    int i,j;
82:                    Matrix *temp = m_constructor(local, NULL, NULL, 0, 0, 0, 0, 0, 0, 0, 0, 0);
000B96  B80060     MUL.UU W0, #0, W0
000B98  BE9F80     MOV.D W0, [W15++]
000B9A  B80060     MUL.UU W0, #0, W0
000B9C  BE9F80     MOV.D W0, [W15++]
000B9E  B80060     MUL.UU W0, #0, W0
000BA0  BE9F80     MOV.D W0, [W15++]
000BA2  B80060     MUL.UU W0, #0, W0
000BA4  BE9F80     MOV.D W0, [W15++]
000BA6  B80060     MUL.UU W0, #0, W0
000BA8  BE9F80     MOV.D W0, [W15++]
000BAA  B80060     MUL.UU W0, #0, W0
000BAC  BE9F80     MOV.D W0, [W15++]
000BAE  B80060     MUL.UU W0, #0, W0
000BB0  BE9F80     MOV.D W0, [W15++]
000BB2  B83360     MUL.UU W6, #0, W6
000BB4  B82260     MUL.UU W4, #0, W4
000BB6  EB0100     CLR W2
000BB8  EB0080     CLR W1
000BBA  EB4000     CLR.B W0
000BBC  07FF48     RCALL m_constructor
000BBE  5787FC     SUB W15, #0x1C, W15
000BC0  980720     MOV W0, [W14+4]
83:                    for(i=0;i<3;i++)
000BC2  EB0000     CLR W0
000BC4  780F00     MOV W0, [W14]
000BC6  370028     BRA 0xC18
000C16  E80F1E     INC [W14], [W14]
000C18  78001E     MOV [W14], W0
000C1A  500FE2     SUB W0, #0x2, [W15]
000C1C  34FFD5     BRA LE, 0xBC8
84:                    {
85:                        for(j=0;j<3;j++)
000BC8  EB0000     CLR W0
000BCA  980710     MOV W0, [W14+2]
000BCC  370021     BRA 0xC10
000C0A  90001E     MOV [W14+2], W0
000C0C  E80000     INC W0, W0
000C0E  980710     MOV W0, [W14+2]
000C10  90001E     MOV [W14+2], W0
000C12  500FE2     SUB W0, #0x2, [W15]
000C14  34FFDC     BRA LE, 0xBCE
86:                        {
87:                            temp->triMatrix[i][j] = m->triMatrix[i][j] + n->triMatrix[i][j];
000BCE  90013E     MOV [W14+6], W2
000BD0  78001E     MOV [W14], W0
000BD2  B90063     MUL.SU W0, #3, W0
000BD4  780080     MOV W0, W1
000BD6  90001E     MOV [W14+2], W0
000BD8  408000     ADD W1, W0, W0
000BDA  DD0042     SL W0, #2, W0
000BDC  410000     ADD W2, W0, W0
000BDE  BE0210     MOV.D [W0], W4
000BE0  90014E     MOV [W14+8], W2
000BE2  78001E     MOV [W14], W0
000BE4  B90063     MUL.SU W0, #3, W0
000BE6  780080     MOV W0, W1
000BE8  90001E     MOV [W14+2], W0
000BEA  408000     ADD W1, W0, W0
000BEC  DD0042     SL W0, #2, W0
000BEE  410000     ADD W2, W0, W0
000BF0  BE0010     MOV.D [W0], W0
000BF2  BE0100     MOV.D W0, W2
000BF4  BE0004     MOV.D W4, W0
000BF6  07FBF7     RCALL ___addsf3
000BF8  90022E     MOV [W14+4], W4
000BFA  78011E     MOV [W14], W2
000BFC  B91163     MUL.SU W2, #3, W2
000BFE  780182     MOV W2, W3
000C00  90011E     MOV [W14+2], W2
000C02  418102     ADD W3, W2, W2
000C04  DD1142     SL W2, #2, W2
000C06  420102     ADD W4, W2, W2
000C08  BE8900     MOV.D W0, [W2]
88:                        }
89:                    }
90:                    return temp;
000C1E  90002E     MOV [W14+4], W0
91:                };
000C20  FA8000     ULNK
000C22  060000     RETURN
92:                
93:                Matrix *m_minus(Matrix*m,Matrix*n)
94:                {    
000C24  FA000A     LNK #0xA
000C26  980730     MOV W0, [W14+6]
000C28  980741     MOV W1, [W14+8]
95:                    int i,j;
96:                    Matrix *temp = m_constructor(local, NULL, NULL, 0, 0, 0, 0, 0, 0, 0, 0, 0);
000C2A  B80060     MUL.UU W0, #0, W0
000C2C  BE9F80     MOV.D W0, [W15++]
000C2E  B80060     MUL.UU W0, #0, W0
000C30  BE9F80     MOV.D W0, [W15++]
000C32  B80060     MUL.UU W0, #0, W0
000C34  BE9F80     MOV.D W0, [W15++]
000C36  B80060     MUL.UU W0, #0, W0
000C38  BE9F80     MOV.D W0, [W15++]
000C3A  B80060     MUL.UU W0, #0, W0
000C3C  BE9F80     MOV.D W0, [W15++]
000C3E  B80060     MUL.UU W0, #0, W0
000C40  BE9F80     MOV.D W0, [W15++]
000C42  B80060     MUL.UU W0, #0, W0
000C44  BE9F80     MOV.D W0, [W15++]
000C46  B83360     MUL.UU W6, #0, W6
000C48  B82260     MUL.UU W4, #0, W4
000C4A  EB0100     CLR W2
000C4C  EB0080     CLR W1
000C4E  EB4000     CLR.B W0
000C50  07FEFE     RCALL m_constructor
000C52  5787FC     SUB W15, #0x1C, W15
000C54  980720     MOV W0, [W14+4]
97:                    for(i=0;i<3;i++)
000C56  EB0000     CLR W0
000C58  780F00     MOV W0, [W14]
000C5A  370028     BRA 0xCAC
000CAA  E80F1E     INC [W14], [W14]
000CAC  78001E     MOV [W14], W0
000CAE  500FE2     SUB W0, #0x2, [W15]
000CB0  34FFD5     BRA LE, 0xC5C
98:                    {
99:                        for(j=0;j<3;j++)
000C5C  EB0000     CLR W0
000C5E  980710     MOV W0, [W14+2]
000C60  370021     BRA 0xCA4
000C9E  90001E     MOV [W14+2], W0
000CA0  E80000     INC W0, W0
000CA2  980710     MOV W0, [W14+2]
000CA4  90001E     MOV [W14+2], W0
000CA6  500FE2     SUB W0, #0x2, [W15]
000CA8  34FFDC     BRA LE, 0xC62
100:                       {
101:                           temp->triMatrix[i][j] = m->triMatrix[i][j] - n->triMatrix[i][j];
000C62  90013E     MOV [W14+6], W2
000C64  78001E     MOV [W14], W0
000C66  B90063     MUL.SU W0, #3, W0
000C68  780080     MOV W0, W1
000C6A  90001E     MOV [W14+2], W0
000C6C  408000     ADD W1, W0, W0
000C6E  DD0042     SL W0, #2, W0
000C70  410000     ADD W2, W0, W0
000C72  BE0210     MOV.D [W0], W4
000C74  90014E     MOV [W14+8], W2
000C76  78001E     MOV [W14], W0
000C78  B90063     MUL.SU W0, #3, W0
000C7A  780080     MOV W0, W1
000C7C  90001E     MOV [W14+2], W0
000C7E  408000     ADD W1, W0, W0
000C80  DD0042     SL W0, #2, W0
000C82  410000     ADD W2, W0, W0
000C84  BE0010     MOV.D [W0], W0
000C86  BE0100     MOV.D W0, W2
000C88  BE0004     MOV.D W4, W0
000C8A  07FBAC     RCALL ___subsf3
000C8C  90022E     MOV [W14+4], W4
000C8E  78011E     MOV [W14], W2
000C90  B91163     MUL.SU W2, #3, W2
000C92  780182     MOV W2, W3
000C94  90011E     MOV [W14+2], W2
000C96  418102     ADD W3, W2, W2
000C98  DD1142     SL W2, #2, W2
000C9A  420102     ADD W4, W2, W2
000C9C  BE8900     MOV.D W0, [W2]
102:                       }
103:                   }
104:                   return temp;
000CB2  90002E     MOV [W14+4], W0
105:               };
000CB4  FA8000     ULNK
000CB6  060000     RETURN
106:               
107:               Matrix *m_m_multiply(Matrix*m,Matrix*n)
108:               {
000CB8  FA000A     LNK #0xA
000CBA  BE9F88     MOV.D W8, [W15++]
000CBC  980730     MOV W0, [W14+6]
000CBE  980741     MOV W1, [W14+8]
109:               
110:                   int i,j;
111:                   Matrix *temp = m_constructor(local, NULL, NULL, 0, 0, 0, 0, 0, 0, 0, 0, 0);
000CC0  B80060     MUL.UU W0, #0, W0
000CC2  BE9F80     MOV.D W0, [W15++]
000CC4  B80060     MUL.UU W0, #0, W0
000CC6  BE9F80     MOV.D W0, [W15++]
000CC8  B80060     MUL.UU W0, #0, W0
000CCA  BE9F80     MOV.D W0, [W15++]
000CCC  B80060     MUL.UU W0, #0, W0
000CCE  BE9F80     MOV.D W0, [W15++]
000CD0  B80060     MUL.UU W0, #0, W0
000CD2  BE9F80     MOV.D W0, [W15++]
000CD4  B80060     MUL.UU W0, #0, W0
000CD6  BE9F80     MOV.D W0, [W15++]
000CD8  B80060     MUL.UU W0, #0, W0
000CDA  BE9F80     MOV.D W0, [W15++]
000CDC  B83360     MUL.UU W6, #0, W6
000CDE  B82260     MUL.UU W4, #0, W4
000CE0  EB0100     CLR W2
000CE2  EB0080     CLR W1
000CE4  EB4000     CLR.B W0
000CE6  07FEB3     RCALL m_constructor
000CE8  5787FC     SUB W15, #0x1C, W15
000CEA  980720     MOV W0, [W14+4]
112:                   for(i=0;i<3;i++)
000CEC  EB0000     CLR W0
000CEE  780F00     MOV W0, [W14]
000CF0  370049     BRA 0xD84
000D82  E80F1E     INC [W14], [W14]
000D84  78001E     MOV [W14], W0
000D86  500FE2     SUB W0, #0x2, [W15]
000D88  34FFB4     BRA LE, 0xCF2
113:                   {
114:                       for(j=0;j<3;j++)
000CF2  EB0000     CLR W0
000CF4  980710     MOV W0, [W14+2]
000CF6  370042     BRA 0xD7C
000D76  90001E     MOV [W14+2], W0
000D78  E80000     INC W0, W0
000D7A  980710     MOV W0, [W14+2]
000D7C  90001E     MOV [W14+2], W0
000D7E  500FE2     SUB W0, #0x2, [W15]
000D80  34FFBB     BRA LE, 0xCF8
115:                       {
116:                           temp->triMatrix[i][j] = m->triMatrix[i][0] * n->triMatrix[0][j] + m->triMatrix[i][1] * n->triMatrix[1][j] +m->triMatrix[i][2] * n->triMatrix[2][j];
000CF8  90013E     MOV [W14+6], W2
000CFA  78001E     MOV [W14], W0
000CFC  B9006C     MUL.SU W0, #12, W0
000CFE  780000     MOV W0, W0
000D00  410000     ADD W2, W0, W0
000D02  BE0210     MOV.D [W0], W4
000D04  9000CE     MOV [W14+8], W1
000D06  90001E     MOV [W14+2], W0
000D08  DD0042     SL W0, #2, W0
000D0A  408000     ADD W1, W0, W0
000D0C  BE0010     MOV.D [W0], W0
000D0E  BE0100     MOV.D W0, W2
000D10  BE0004     MOV.D W4, W0
000D12  07FC7E     RCALL ___mulsf3
000D14  BE0400     MOV.D W0, W8
000D16  90013E     MOV [W14+6], W2
000D18  78001E     MOV [W14], W0
000D1A  B9006C     MUL.SU W0, #12, W0
000D1C  780000     MOV W0, W0
000D1E  400064     ADD W0, #0x4, W0
000D20  410000     ADD W2, W0, W0
000D22  BE0210     MOV.D [W0], W4
000D24  9000CE     MOV [W14+8], W1
000D26  90001E     MOV [W14+2], W0
000D28  400063     ADD W0, #0x3, W0
000D2A  DD0042     SL W0, #2, W0
000D2C  408000     ADD W1, W0, W0
000D2E  BE0010     MOV.D [W0], W0
000D30  BE0100     MOV.D W0, W2
000D32  BE0004     MOV.D W4, W0
000D34  07FC6D     RCALL ___mulsf3
000D36  BE0100     MOV.D W0, W2
000D38  BE0008     MOV.D W8, W0
000D3A  07FB55     RCALL ___addsf3
000D3C  BE0400     MOV.D W0, W8
000D3E  90013E     MOV [W14+6], W2
000D40  78001E     MOV [W14], W0
000D42  B9006C     MUL.SU W0, #12, W0
000D44  780000     MOV W0, W0
000D46  400068     ADD W0, #0x8, W0
000D48  410000     ADD W2, W0, W0
000D4A  BE0210     MOV.D [W0], W4
000D4C  9000CE     MOV [W14+8], W1
000D4E  90001E     MOV [W14+2], W0
000D50  400066     ADD W0, #0x6, W0
000D52  DD0042     SL W0, #2, W0
000D54  408000     ADD W1, W0, W0
000D56  BE0010     MOV.D [W0], W0
000D58  BE0100     MOV.D W0, W2
000D5A  BE0004     MOV.D W4, W0
000D5C  07FC59     RCALL ___mulsf3
000D5E  BE0100     MOV.D W0, W2
000D60  BE0008     MOV.D W8, W0
000D62  07FB41     RCALL ___addsf3
000D64  90022E     MOV [W14+4], W4
000D66  78011E     MOV [W14], W2
000D68  B91163     MUL.SU W2, #3, W2
000D6A  780182     MOV W2, W3
000D6C  90011E     MOV [W14+2], W2
000D6E  418102     ADD W3, W2, W2
000D70  DD1142     SL W2, #2, W2
000D72  420102     ADD W4, W2, W2
000D74  BE8900     MOV.D W0, [W2]
117:                       }
118:                   }
119:                   return temp;
000D8A  90002E     MOV [W14+4], W0
120:               };
000D8C  BE044F     MOV.D [--W15], W8
000D8E  FA8000     ULNK
000D90  060000     RETURN
121:               
122:               Vector3f *m_v_multiply(Matrix*m,Vector3f *v)
123:               {
000D92  FA0006     LNK #0x6
000D94  BE9F88     MOV.D W8, [W15++]
000D96  980710     MOV W0, [W14+2]
000D98  980721     MOV W1, [W14+4]
124:                   Vector3f *temp = v_constructor(local, NULL, 0, 0, 0);
000D9A  B83360     MUL.UU W6, #0, W6
000D9C  B82260     MUL.UU W4, #0, W4
000D9E  B81160     MUL.UU W2, #0, W2
000DA0  EB0080     CLR W1
000DA2  EB4000     CLR.B W0
000DA4  070662     RCALL v_constructor
000DA6  780F00     MOV W0, [W14]
125:                   temp->x = m->triMatrix[0][0] * v->x + m->triMatrix[0][1] * v->y + m->triMatrix[0][2] * v->z;
000DA8  90001E     MOV [W14+2], W0
000DAA  BE0210     MOV.D [W0], W4
000DAC  90002E     MOV [W14+4], W0
000DAE  BE0010     MOV.D [W0], W0
000DB0  BE0100     MOV.D W0, W2
000DB2  BE0004     MOV.D W4, W0
000DB4  07FC2D     RCALL ___mulsf3
000DB6  BE0400     MOV.D W0, W8
000DB8  90001E     MOV [W14+2], W0
000DBA  900220     MOV [W0+4], W4
000DBC  9002B0     MOV [W0+6], W5
000DBE  90002E     MOV [W14+4], W0
000DC0  9000B0     MOV [W0+6], W1
000DC2  900020     MOV [W0+4], W0
000DC4  BE0100     MOV.D W0, W2
000DC6  BE0004     MOV.D W4, W0
000DC8  07FC23     RCALL ___mulsf3
000DCA  BE0100     MOV.D W0, W2
000DCC  BE0008     MOV.D W8, W0
000DCE  07FB0B     RCALL ___addsf3
000DD0  BE0400     MOV.D W0, W8
000DD2  90001E     MOV [W14+2], W0
000DD4  900240     MOV [W0+8], W4
000DD6  9002D0     MOV [W0+10], W5
000DD8  90002E     MOV [W14+4], W0
000DDA  9000D0     MOV [W0+10], W1
000DDC  900040     MOV [W0+8], W0
000DDE  BE0100     MOV.D W0, W2
000DE0  BE0004     MOV.D W4, W0
000DE2  07FC16     RCALL ___mulsf3
000DE4  BE0100     MOV.D W0, W2
000DE6  BE0008     MOV.D W8, W0
000DE8  07FAFE     RCALL ___addsf3
000DEA  78011E     MOV [W14], W2
000DEC  BE8900     MOV.D W0, [W2]
126:                   temp->y = m->triMatrix[1][0] * v->x + m->triMatrix[1][1] * v->y + m->triMatrix[1][2] * v->z;
000DEE  90001E     MOV [W14+2], W0
000DF0  900260     MOV [W0+12], W4
000DF2  9002F0     MOV [W0+14], W5
000DF4  90002E     MOV [W14+4], W0
000DF6  BE0010     MOV.D [W0], W0
000DF8  BE0100     MOV.D W0, W2
000DFA  BE0004     MOV.D W4, W0
000DFC  07FC09     RCALL ___mulsf3
000DFE  BE0400     MOV.D W0, W8
000E00  90001E     MOV [W14+2], W0
000E02  900A00     MOV [W0+16], W4
000E04  900A90     MOV [W0+18], W5
000E06  90002E     MOV [W14+4], W0
000E08  9000B0     MOV [W0+6], W1
000E0A  900020     MOV [W0+4], W0
000E0C  BE0100     MOV.D W0, W2
000E0E  BE0004     MOV.D W4, W0
000E10  07FBFF     RCALL ___mulsf3
000E12  BE0100     MOV.D W0, W2
000E14  BE0008     MOV.D W8, W0
000E16  07FAE7     RCALL ___addsf3
000E18  BE0400     MOV.D W0, W8
000E1A  90001E     MOV [W14+2], W0
000E1C  900A20     MOV [W0+20], W4
000E1E  900AB0     MOV [W0+22], W5
000E20  90002E     MOV [W14+4], W0
000E22  9000D0     MOV [W0+10], W1
000E24  900040     MOV [W0+8], W0
000E26  BE0100     MOV.D W0, W2
000E28  BE0004     MOV.D W4, W0
000E2A  07FBF2     RCALL ___mulsf3
000E2C  BE0100     MOV.D W0, W2
000E2E  BE0008     MOV.D W8, W0
000E30  07FADA     RCALL ___addsf3
000E32  78011E     MOV [W14], W2
000E34  980120     MOV W0, [W2+4]
000E36  980131     MOV W1, [W2+6]
127:                   temp->z = m->triMatrix[2][0] * v->x + m->triMatrix[2][1] * v->y + m->triMatrix[2][2] * v->z;
000E38  90001E     MOV [W14+2], W0
000E3A  900A40     MOV [W0+24], W4
000E3C  900AD0     MOV [W0+26], W5
000E3E  90002E     MOV [W14+4], W0
000E40  BE0010     MOV.D [W0], W0
000E42  BE0100     MOV.D W0, W2
000E44  BE0004     MOV.D W4, W0
000E46  07FBE4     RCALL ___mulsf3
000E48  BE0400     MOV.D W0, W8
000E4A  90001E     MOV [W14+2], W0
000E4C  900A60     MOV [W0+28], W4
000E4E  900AF0     MOV [W0+30], W5
000E50  90002E     MOV [W14+4], W0
000E52  9000B0     MOV [W0+6], W1
000E54  900020     MOV [W0+4], W0
000E56  BE0100     MOV.D W0, W2
000E58  BE0004     MOV.D W4, W0
000E5A  07FBDA     RCALL ___mulsf3
000E5C  BE0100     MOV.D W0, W2
000E5E  BE0008     MOV.D W8, W0
000E60  07FAC2     RCALL ___addsf3
000E62  BE0400     MOV.D W0, W8
000E64  90001E     MOV [W14+2], W0
000E66  901200     MOV [W0+32], W4
000E68  901290     MOV [W0+34], W5
000E6A  90002E     MOV [W14+4], W0
000E6C  9000D0     MOV [W0+10], W1
000E6E  900040     MOV [W0+8], W0
000E70  BE0100     MOV.D W0, W2
000E72  BE0004     MOV.D W4, W0
000E74  07FBCD     RCALL ___mulsf3
000E76  BE0100     MOV.D W0, W2
000E78  BE0008     MOV.D W8, W0
000E7A  07FAB5     RCALL ___addsf3
000E7C  78011E     MOV [W14], W2
000E7E  980140     MOV W0, [W2+8]
000E80  980151     MOV W1, [W2+10]
128:                   return temp;
000E82  78001E     MOV [W14], W0
129:               };
000E84  BE044F     MOV.D [--W15], W8
000E86  FA8000     ULNK
000E88  060000     RETURN
130:               
131:               Matrix *m_s_multiply(Matrix*m,float s)
132:               {
000E8A  FA000C     LNK #0xC
000E8C  980730     MOV W0, [W14+6]
000E8E  980742     MOV W2, [W14+8]
000E90  980753     MOV W3, [W14+10]
133:                   int i,j;
134:                   Matrix *temp = m_constructor(local, NULL, NULL, 0, 0, 0, 0, 0, 0, 0, 0, 0);
000E92  B80060     MUL.UU W0, #0, W0
000E94  BE9F80     MOV.D W0, [W15++]
000E96  B80060     MUL.UU W0, #0, W0
000E98  BE9F80     MOV.D W0, [W15++]
000E9A  B80060     MUL.UU W0, #0, W0
000E9C  BE9F80     MOV.D W0, [W15++]
000E9E  B80060     MUL.UU W0, #0, W0
000EA0  BE9F80     MOV.D W0, [W15++]
000EA2  B80060     MUL.UU W0, #0, W0
000EA4  BE9F80     MOV.D W0, [W15++]
000EA6  B80060     MUL.UU W0, #0, W0
000EA8  BE9F80     MOV.D W0, [W15++]
000EAA  B80060     MUL.UU W0, #0, W0
000EAC  BE9F80     MOV.D W0, [W15++]
000EAE  B83360     MUL.UU W6, #0, W6
000EB0  B82260     MUL.UU W4, #0, W4
000EB2  EB0100     CLR W2
000EB4  EB0080     CLR W1
000EB6  EB4000     CLR.B W0
000EB8  07FDCA     RCALL m_constructor
000EBA  5787FC     SUB W15, #0x1C, W15
000EBC  980720     MOV W0, [W14+4]
135:                   for(i=0;i<3;i++)
000EBE  EB0000     CLR W0
000EC0  780F00     MOV W0, [W14]
000EC2  37001F     BRA 0xF02
000F00  E80F1E     INC [W14], [W14]
000F02  78001E     MOV [W14], W0
000F04  500FE2     SUB W0, #0x2, [W15]
000F06  34FFDE     BRA LE, 0xEC4
136:                   {
137:                       for(j=0;j<3;j++)
000EC4  EB0000     CLR W0
000EC6  980710     MOV W0, [W14+2]
000EC8  370018     BRA 0xEFA
000EF4  90001E     MOV [W14+2], W0
000EF6  E80000     INC W0, W0
000EF8  980710     MOV W0, [W14+2]
000EFA  90001E     MOV [W14+2], W0
000EFC  500FE2     SUB W0, #0x2, [W15]
000EFE  34FFE5     BRA LE, 0xECA
138:                       {
139:                           temp->triMatrix[i][j] = m->triMatrix[i][j] * s;
000ECA  90013E     MOV [W14+6], W2
000ECC  78001E     MOV [W14], W0
000ECE  B90063     MUL.SU W0, #3, W0
000ED0  780080     MOV W0, W1
000ED2  90001E     MOV [W14+2], W0
000ED4  408000     ADD W1, W0, W0
000ED6  DD0042     SL W0, #2, W0
000ED8  410000     ADD W2, W0, W0
000EDA  BE0010     MOV.D [W0], W0
000EDC  90014E     MOV [W14+8], W2
000EDE  9001DE     MOV [W14+10], W3
000EE0  07FB97     RCALL ___mulsf3
000EE2  90022E     MOV [W14+4], W4
000EE4  78011E     MOV [W14], W2
000EE6  B91163     MUL.SU W2, #3, W2
000EE8  780182     MOV W2, W3
000EEA  90011E     MOV [W14+2], W2
000EEC  418102     ADD W3, W2, W2
000EEE  DD1142     SL W2, #2, W2
000EF0  420102     ADD W4, W2, W2
000EF2  BE8900     MOV.D W0, [W2]
140:                       }
141:                   }    
142:                   return temp;   
000F08  90002E     MOV [W14+4], W0
143:               };
000F0A  FA8000     ULNK
000F0C  060000     RETURN
144:               
145:               float m_determinant(Matrix *m)
146:               {
000F0E  FA0002     LNK #0x2
000F10  BE9F88     MOV.D W8, [W15++]
000F12  780F00     MOV W0, [W14]
147:                   return m->triMatrix[0][0] * m->triMatrix[1][1] * m->triMatrix[2][2] + m->triMatrix[1][0] * m->triMatrix[2][1] * m->triMatrix[0][2] + m->triMatrix[2][0] * m->triMatrix[0][1] * m->triMatrix[1][2] -
000F14  78001E     MOV [W14], W0
000F16  BE0210     MOV.D [W0], W4
000F18  78001E     MOV [W14], W0
000F1A  900890     MOV [W0+18], W1
000F1C  900800     MOV [W0+16], W0
000F1E  BE0100     MOV.D W0, W2
000F20  BE0004     MOV.D W4, W0
000F22  07FB76     RCALL ___mulsf3
000F24  BE0200     MOV.D W0, W4
000F26  78001E     MOV [W14], W0
000F28  901090     MOV [W0+34], W1
000F2A  901000     MOV [W0+32], W0
000F2C  BE0100     MOV.D W0, W2
000F2E  BE0004     MOV.D W4, W0
000F30  07FB6F     RCALL ___mulsf3
000F32  BE0400     MOV.D W0, W8
000F34  78001E     MOV [W14], W0
000F36  900260     MOV [W0+12], W4
000F38  9002F0     MOV [W0+14], W5
000F3A  78001E     MOV [W14], W0
000F3C  9008F0     MOV [W0+30], W1
000F3E  900860     MOV [W0+28], W0
000F40  BE0100     MOV.D W0, W2
000F42  BE0004     MOV.D W4, W0
000F44  07FB65     RCALL ___mulsf3
000F46  BE0200     MOV.D W0, W4
000F48  78001E     MOV [W14], W0
000F4A  9000D0     MOV [W0+10], W1
000F4C  900040     MOV [W0+8], W0
000F4E  BE0100     MOV.D W0, W2
000F50  BE0004     MOV.D W4, W0
000F52  07FB5E     RCALL ___mulsf3
000F54  BE0100     MOV.D W0, W2
000F56  BE0008     MOV.D W8, W0
000F58  07FA46     RCALL ___addsf3
000F5A  BE0400     MOV.D W0, W8
000F5C  78001E     MOV [W14], W0
000F5E  900A40     MOV [W0+24], W4
000F60  900AD0     MOV [W0+26], W5
000F62  78001E     MOV [W14], W0
000F64  9000B0     MOV [W0+6], W1
000F66  900020     MOV [W0+4], W0
000F68  BE0100     MOV.D W0, W2
000F6A  BE0004     MOV.D W4, W0
000F6C  07FB51     RCALL ___mulsf3
000F6E  BE0200     MOV.D W0, W4
000F70  78001E     MOV [W14], W0
000F72  9008B0     MOV [W0+22], W1
000F74  900820     MOV [W0+20], W0
000F76  BE0100     MOV.D W0, W2
000F78  BE0004     MOV.D W4, W0
000F7A  07FB4A     RCALL ___mulsf3
000F7C  BE0100     MOV.D W0, W2
000F7E  BE0008     MOV.D W8, W0
000F80  07FA32     RCALL ___addsf3
000F82  BE0400     MOV.D W0, W8
000FA4  BE0100     MOV.D W0, W2
000FA6  BE0008     MOV.D W8, W0
000FA8  07FA1D     RCALL ___subsf3
000FAA  BE0400     MOV.D W0, W8
000FF2  BE0100     MOV.D W0, W2
000FF4  BE0008     MOV.D W8, W0
000FF6  07F9F6     RCALL ___subsf3
148:               		m->triMatrix[2][0] * m->triMatrix[1][1] * m->triMatrix[0][2] - m->triMatrix[1][0] * m->triMatrix[0][1] * m->triMatrix[2][2] - m->triMatrix[0][0] * m->triMatrix[2][1] * m->triMatrix[1][2];
000F84  78001E     MOV [W14], W0
000F86  900A40     MOV [W0+24], W4
000F88  900AD0     MOV [W0+26], W5
000F8A  78001E     MOV [W14], W0
000F8C  900890     MOV [W0+18], W1
000F8E  900800     MOV [W0+16], W0
000F90  BE0100     MOV.D W0, W2
000F92  BE0004     MOV.D W4, W0
000F94  07FB3D     RCALL ___mulsf3
000F96  BE0200     MOV.D W0, W4
000F98  78001E     MOV [W14], W0
000F9A  9000D0     MOV [W0+10], W1
000F9C  900040     MOV [W0+8], W0
000F9E  BE0100     MOV.D W0, W2
000FA0  BE0004     MOV.D W4, W0
000FA2  07FB36     RCALL ___mulsf3
000FAC  78001E     MOV [W14], W0
000FAE  900260     MOV [W0+12], W4
000FB0  9002F0     MOV [W0+14], W5
000FB2  78001E     MOV [W14], W0
000FB4  9000B0     MOV [W0+6], W1
000FB6  900020     MOV [W0+4], W0
000FB8  BE0100     MOV.D W0, W2
000FBA  BE0004     MOV.D W4, W0
000FBC  07FB29     RCALL ___mulsf3
000FBE  BE0200     MOV.D W0, W4
000FC0  78001E     MOV [W14], W0
000FC2  901090     MOV [W0+34], W1
000FC4  901000     MOV [W0+32], W0
000FC6  BE0100     MOV.D W0, W2
000FC8  BE0004     MOV.D W4, W0
000FCA  07FB22     RCALL ___mulsf3
000FCC  BE0100     MOV.D W0, W2
000FCE  BE0008     MOV.D W8, W0
000FD0  07FA09     RCALL ___subsf3
000FD2  BE0400     MOV.D W0, W8
000FD4  78001E     MOV [W14], W0
000FD6  BE0210     MOV.D [W0], W4
000FD8  78001E     MOV [W14], W0
000FDA  9008F0     MOV [W0+30], W1
000FDC  900860     MOV [W0+28], W0
000FDE  BE0100     MOV.D W0, W2
000FE0  BE0004     MOV.D W4, W0
000FE2  07FB16     RCALL ___mulsf3
000FE4  BE0200     MOV.D W0, W4
000FE6  78001E     MOV [W14], W0
000FE8  9008B0     MOV [W0+22], W1
000FEA  900820     MOV [W0+20], W0
000FEC  BE0100     MOV.D W0, W2
000FEE  BE0004     MOV.D W4, W0
000FF0  07FB0F     RCALL ___mulsf3
149:               };
000FF8  BE044F     MOV.D [--W15], W8
000FFA  FA8000     ULNK
000FFC  060000     RETURN
150:               
151:               Matrix *m_cofactor(Matrix *m)
152:               {
000FFE  FA0004     LNK #0x4
001000  BE9F88     MOV.D W8, [W15++]
001002  980710     MOV W0, [W14+2]
153:                   Matrix *temp = m_constructor(local, NULL, NULL, 0, 0, 0, 0, 0, 0, 0, 0, 0);
001004  B80060     MUL.UU W0, #0, W0
001006  BE9F80     MOV.D W0, [W15++]
001008  B80060     MUL.UU W0, #0, W0
00100A  BE9F80     MOV.D W0, [W15++]
00100C  B80060     MUL.UU W0, #0, W0
00100E  BE9F80     MOV.D W0, [W15++]
001010  B80060     MUL.UU W0, #0, W0
001012  BE9F80     MOV.D W0, [W15++]
001014  B80060     MUL.UU W0, #0, W0
001016  BE9F80     MOV.D W0, [W15++]
001018  B80060     MUL.UU W0, #0, W0
00101A  BE9F80     MOV.D W0, [W15++]
00101C  B80060     MUL.UU W0, #0, W0
00101E  BE9F80     MOV.D W0, [W15++]
001020  B83360     MUL.UU W6, #0, W6
001022  B82260     MUL.UU W4, #0, W4
001024  EB0100     CLR W2
001026  EB0080     CLR W1
001028  EB4000     CLR.B W0
00102A  07FD11     RCALL m_constructor
00102C  5787FC     SUB W15, #0x1C, W15
00102E  780F00     MOV W0, [W14]
154:                   temp->triMatrix[0][0] = m->triMatrix[1][1] * m->triMatrix[2][2]- m->triMatrix[1][2] * m->triMatrix[2][1];
001030  90001E     MOV [W14+2], W0
001032  900A00     MOV [W0+16], W4
001034  900A90     MOV [W0+18], W5
001036  90001E     MOV [W14+2], W0
001038  901090     MOV [W0+34], W1
00103A  901000     MOV [W0+32], W0
00103C  BE0100     MOV.D W0, W2
00103E  BE0004     MOV.D W4, W0
001040  07FAE7     RCALL ___mulsf3
001042  BE0400     MOV.D W0, W8
001044  90001E     MOV [W14+2], W0
001046  900A20     MOV [W0+20], W4
001048  900AB0     MOV [W0+22], W5
00104A  90001E     MOV [W14+2], W0
00104C  9008F0     MOV [W0+30], W1
00104E  900860     MOV [W0+28], W0
001050  BE0100     MOV.D W0, W2
001052  BE0004     MOV.D W4, W0
001054  07FADD     RCALL ___mulsf3
001056  BE0100     MOV.D W0, W2
001058  BE0008     MOV.D W8, W0
00105A  07F9C4     RCALL ___subsf3
00105C  78011E     MOV [W14], W2
00105E  BE8900     MOV.D W0, [W2]
155:               	temp->triMatrix[0][1] = -(m->triMatrix[0][1] * m->triMatrix[2][2] - m->triMatrix[2][1] * m->triMatrix[0][2]);
001060  90001E     MOV [W14+2], W0
001062  900220     MOV [W0+4], W4
001064  9002B0     MOV [W0+6], W5
001066  90001E     MOV [W14+2], W0
001068  901090     MOV [W0+34], W1
00106A  901000     MOV [W0+32], W0
00106C  BE0100     MOV.D W0, W2
00106E  BE0004     MOV.D W4, W0
001070  07FACF     RCALL ___mulsf3
001072  BE0400     MOV.D W0, W8
001074  90001E     MOV [W14+2], W0
001076  900A60     MOV [W0+28], W4
001078  900AF0     MOV [W0+30], W5
00107A  90001E     MOV [W14+2], W0
00107C  9000D0     MOV [W0+10], W1
00107E  900040     MOV [W0+8], W0
001080  BE0100     MOV.D W0, W2
001082  BE0004     MOV.D W4, W0
001084  07FAC5     RCALL ___mulsf3
001086  BE0100     MOV.D W0, W2
001088  BE0008     MOV.D W8, W0
00108A  07F9AC     RCALL ___subsf3
00108C  A2F001     BTG W1, #15
00108E  78011E     MOV [W14], W2
001090  980120     MOV W0, [W2+4]
001092  980131     MOV W1, [W2+6]
156:               	temp->triMatrix[0][2] = m->triMatrix[0][1] * m->triMatrix[1][2] - m->triMatrix[1][1] * m->triMatrix[0][2];
001094  90001E     MOV [W14+2], W0
001096  900220     MOV [W0+4], W4
001098  9002B0     MOV [W0+6], W5
00109A  90001E     MOV [W14+2], W0
00109C  9008B0     MOV [W0+22], W1
00109E  900820     MOV [W0+20], W0
0010A0  BE0100     MOV.D W0, W2
0010A2  BE0004     MOV.D W4, W0
0010A4  07FAB5     RCALL ___mulsf3
0010A6  BE0400     MOV.D W0, W8
0010A8  90001E     MOV [W14+2], W0
0010AA  900A00     MOV [W0+16], W4
0010AC  900A90     MOV [W0+18], W5
0010AE  90001E     MOV [W14+2], W0
0010B0  9000D0     MOV [W0+10], W1
0010B2  900040     MOV [W0+8], W0
0010B4  BE0100     MOV.D W0, W2
0010B6  BE0004     MOV.D W4, W0
0010B8  07FAAB     RCALL ___mulsf3
0010BA  BE0100     MOV.D W0, W2
0010BC  BE0008     MOV.D W8, W0
0010BE  07F992     RCALL ___subsf3
0010C0  78011E     MOV [W14], W2
0010C2  980140     MOV W0, [W2+8]
0010C4  980151     MOV W1, [W2+10]
157:               	temp->triMatrix[1][0] = -(m->triMatrix[1][0] * m->triMatrix[2][2] - m->triMatrix[2][0] * m->triMatrix[1][2]);
0010C6  90001E     MOV [W14+2], W0
0010C8  900260     MOV [W0+12], W4
0010CA  9002F0     MOV [W0+14], W5
0010CC  90001E     MOV [W14+2], W0
0010CE  901090     MOV [W0+34], W1
0010D0  901000     MOV [W0+32], W0
0010D2  BE0100     MOV.D W0, W2
0010D4  BE0004     MOV.D W4, W0
0010D6  07FA9C     RCALL ___mulsf3
0010D8  BE0400     MOV.D W0, W8
0010DA  90001E     MOV [W14+2], W0
0010DC  900A40     MOV [W0+24], W4
0010DE  900AD0     MOV [W0+26], W5
0010E0  90001E     MOV [W14+2], W0
0010E2  9008B0     MOV [W0+22], W1
0010E4  900820     MOV [W0+20], W0
0010E6  BE0100     MOV.D W0, W2
0010E8  BE0004     MOV.D W4, W0
0010EA  07FA92     RCALL ___mulsf3
0010EC  BE0100     MOV.D W0, W2
0010EE  BE0008     MOV.D W8, W0
0010F0  07F979     RCALL ___subsf3
0010F2  A2F001     BTG W1, #15
0010F4  78011E     MOV [W14], W2
0010F6  980160     MOV W0, [W2+12]
0010F8  980171     MOV W1, [W2+14]
158:               	temp->triMatrix[1][1] = m->triMatrix[0][0] * m->triMatrix[2][2] - m->triMatrix[2][0] * m->triMatrix[0][2];
0010FA  90001E     MOV [W14+2], W0
0010FC  BE0210     MOV.D [W0], W4
0010FE  90001E     MOV [W14+2], W0
001100  901090     MOV [W0+34], W1
001102  901000     MOV [W0+32], W0
001104  BE0100     MOV.D W0, W2
001106  BE0004     MOV.D W4, W0
001108  07FA83     RCALL ___mulsf3
00110A  BE0400     MOV.D W0, W8
00110C  90001E     MOV [W14+2], W0
00110E  900A40     MOV [W0+24], W4
001110  900AD0     MOV [W0+26], W5
001112  90001E     MOV [W14+2], W0
001114  9000D0     MOV [W0+10], W1
001116  900040     MOV [W0+8], W0
001118  BE0100     MOV.D W0, W2
00111A  BE0004     MOV.D W4, W0
00111C  07FA79     RCALL ___mulsf3
00111E  BE0100     MOV.D W0, W2
001120  BE0008     MOV.D W8, W0
001122  07F960     RCALL ___subsf3
001124  78011E     MOV [W14], W2
001126  980900     MOV W0, [W2+16]
001128  980911     MOV W1, [W2+18]
159:               	temp->triMatrix[1][2] = -(m->triMatrix[0][0] * m->triMatrix[1][2] - m->triMatrix[1][0] * m->triMatrix[0][2]);
00112A  90001E     MOV [W14+2], W0
00112C  BE0210     MOV.D [W0], W4
00112E  90001E     MOV [W14+2], W0
001130  9008B0     MOV [W0+22], W1
001132  900820     MOV [W0+20], W0
001134  BE0100     MOV.D W0, W2
001136  BE0004     MOV.D W4, W0
001138  07FA6B     RCALL ___mulsf3
00113A  BE0400     MOV.D W0, W8
00113C  90001E     MOV [W14+2], W0
00113E  900260     MOV [W0+12], W4
001140  9002F0     MOV [W0+14], W5
001142  90001E     MOV [W14+2], W0
001144  9000D0     MOV [W0+10], W1
001146  900040     MOV [W0+8], W0
001148  BE0100     MOV.D W0, W2
00114A  BE0004     MOV.D W4, W0
00114C  07FA61     RCALL ___mulsf3
00114E  BE0100     MOV.D W0, W2
001150  BE0008     MOV.D W8, W0
001152  07F948     RCALL ___subsf3
001154  A2F001     BTG W1, #15
001156  78011E     MOV [W14], W2
001158  980920     MOV W0, [W2+20]
00115A  980931     MOV W1, [W2+22]
160:               	temp->triMatrix[2][0] = m->triMatrix[1][0] * m->triMatrix[2][1] - m->triMatrix[2][0] * m->triMatrix[1][1]; 
00115C  90001E     MOV [W14+2], W0
00115E  900260     MOV [W0+12], W4
001160  9002F0     MOV [W0+14], W5
001162  90001E     MOV [W14+2], W0
001164  9008F0     MOV [W0+30], W1
001166  900860     MOV [W0+28], W0
001168  BE0100     MOV.D W0, W2
00116A  BE0004     MOV.D W4, W0
00116C  07FA51     RCALL ___mulsf3
00116E  BE0400     MOV.D W0, W8
001170  90001E     MOV [W14+2], W0
001172  900A40     MOV [W0+24], W4
001174  900AD0     MOV [W0+26], W5
001176  90001E     MOV [W14+2], W0
001178  900890     MOV [W0+18], W1
00117A  900800     MOV [W0+16], W0
00117C  BE0100     MOV.D W0, W2
00117E  BE0004     MOV.D W4, W0
001180  07FA47     RCALL ___mulsf3
001182  BE0100     MOV.D W0, W2
001184  BE0008     MOV.D W8, W0
001186  07F92E     RCALL ___subsf3
001188  78011E     MOV [W14], W2
00118A  980940     MOV W0, [W2+24]
00118C  980951     MOV W1, [W2+26]
161:               	temp->triMatrix[2][1] = -(m->triMatrix[0][0] * m->triMatrix[2][1] - m->triMatrix[2][0] * m->triMatrix[0][1]);
00118E  90001E     MOV [W14+2], W0
001190  BE0210     MOV.D [W0], W4
001192  90001E     MOV [W14+2], W0
001194  9008F0     MOV [W0+30], W1
001196  900860     MOV [W0+28], W0
001198  BE0100     MOV.D W0, W2
00119A  BE0004     MOV.D W4, W0
00119C  07FA39     RCALL ___mulsf3
00119E  BE0400     MOV.D W0, W8
0011A0  90001E     MOV [W14+2], W0
0011A2  900A40     MOV [W0+24], W4
0011A4  900AD0     MOV [W0+26], W5
0011A6  90001E     MOV [W14+2], W0
0011A8  9000B0     MOV [W0+6], W1
0011AA  900020     MOV [W0+4], W0
0011AC  BE0100     MOV.D W0, W2
0011AE  BE0004     MOV.D W4, W0
0011B0  07FA2F     RCALL ___mulsf3
0011B2  BE0100     MOV.D W0, W2
0011B4  BE0008     MOV.D W8, W0
0011B6  07F916     RCALL ___subsf3
0011B8  A2F001     BTG W1, #15
0011BA  78011E     MOV [W14], W2
0011BC  980960     MOV W0, [W2+28]
0011BE  980971     MOV W1, [W2+30]
162:               	temp->triMatrix[2][2] = m->triMatrix[0][0] * m->triMatrix[1][1] - m->triMatrix[1][0] * m->triMatrix[0][1];
0011C0  90001E     MOV [W14+2], W0
0011C2  BE0210     MOV.D [W0], W4
0011C4  90001E     MOV [W14+2], W0
0011C6  900890     MOV [W0+18], W1
0011C8  900800     MOV [W0+16], W0
0011CA  BE0100     MOV.D W0, W2
0011CC  BE0004     MOV.D W4, W0
0011CE  07FA20     RCALL ___mulsf3
0011D0  BE0400     MOV.D W0, W8
0011D2  90001E     MOV [W14+2], W0
0011D4  900260     MOV [W0+12], W4
0011D6  9002F0     MOV [W0+14], W5
0011D8  90001E     MOV [W14+2], W0
0011DA  9000B0     MOV [W0+6], W1
0011DC  900020     MOV [W0+4], W0
0011DE  BE0100     MOV.D W0, W2
0011E0  BE0004     MOV.D W4, W0
0011E2  07FA16     RCALL ___mulsf3
0011E4  BE0100     MOV.D W0, W2
0011E6  BE0008     MOV.D W8, W0
0011E8  07F8FD     RCALL ___subsf3
0011EA  78011E     MOV [W14], W2
0011EC  981100     MOV W0, [W2+32]
0011EE  981111     MOV W1, [W2+34]
163:               
164:               	return temp;
0011F0  78001E     MOV [W14], W0
165:               };
0011F2  BE044F     MOV.D [--W15], W8
0011F4  FA8000     ULNK
0011F6  060000     RETURN
166:               
167:               Matrix *m_inverse(Matrix *m)
168:               {
0011F8  FA0008     LNK #0x8
0011FA  BE9F88     MOV.D W8, [W15++]
0011FC  980730     MOV W0, [W14+6]
169:                   Matrix *temp = m_constructor(local, NULL, NULL, 0, 0, 0, 0, 0, 0, 0, 0, 0);
0011FE  B80060     MUL.UU W0, #0, W0
001200  BE9F80     MOV.D W0, [W15++]
001202  B80060     MUL.UU W0, #0, W0
001204  BE9F80     MOV.D W0, [W15++]
001206  B80060     MUL.UU W0, #0, W0
001208  BE9F80     MOV.D W0, [W15++]
00120A  B80060     MUL.UU W0, #0, W0
00120C  BE9F80     MOV.D W0, [W15++]
00120E  B80060     MUL.UU W0, #0, W0
001210  BE9F80     MOV.D W0, [W15++]
001212  B80060     MUL.UU W0, #0, W0
001214  BE9F80     MOV.D W0, [W15++]
001216  B80060     MUL.UU W0, #0, W0
001218  BE9F80     MOV.D W0, [W15++]
00121A  B83360     MUL.UU W6, #0, W6
00121C  B82260     MUL.UU W4, #0, W4
00121E  EB0100     CLR W2
001220  EB0080     CLR W1
001222  EB4000     CLR.B W0
001224  07FC14     RCALL m_constructor
001226  5787FC     SUB W15, #0x1C, W15
001228  780F00     MOV W0, [W14]
170:                   float deter = m_determinant(m);
00122A  90003E     MOV [W14+6], W0
00122C  07FE70     RCALL m_determinant
00122E  980710     MOV W0, [W14+2]
001230  980721     MOV W1, [W14+4]
171:                   /*temp = m_cofactor(m)->m_s_multiply(m_cofactor(m),1/deter);*/
172:               	temp = m_s_multiply(m_cofactor(m), 1 / deter);
001232  90011E     MOV [W14+2], W2
001234  9001AE     MOV [W14+4], W3
001236  200000     MOV #0x0, W0
001238  23F801     MOV #0x3F80, W1
00123A  07F934     RCALL ___divsf3
00123C  BE0400     MOV.D W0, W8
00123E  90003E     MOV [W14+6], W0
001240  07FEDE     RCALL m_cofactor
001242  BE0108     MOV.D W8, W2
001244  07FE22     RCALL m_s_multiply
001246  780F00     MOV W0, [W14]
173:                   return temp;
001248  78001E     MOV [W14], W0
174:               }
00124A  BE044F     MOV.D [--W15], W8
00124C  FA8000     ULNK
00124E  060000     RETURN
---  C:/Users/dell/Desktop/MPLABXProjects/ultimate/main.c  ----------------------------------------------
1:                 /******************************************************************************/
2:                 /* Files to Include                                                           */
3:                 /******************************************************************************/
4:                 
5:                 /* Device header file, thus actually include <p33FJ128MC804.h> */
6:                 #if defined(__XC16__)
7:                     #include <xc.h>
8:                 #elif defined(__C30__)
9:                     #if defined(__dsPIC33E__)
10:                    	#include <p33Exxxx.h>
11:                    #elif defined(__dsPIC33F__)
12:                    	#include <p33Fxxxx.h>
13:                    #endif
14:                #endif
15:                
16:                #if defined(__XC16__)
17:                    //#include <p33FJ128MC804.h> 
18:                    #include "system.h"        /* System funct/params, like osc/peripheral config */
19:                
20:                    /* TODO DSPIC33FJ128MC804 Configuration Bit Settings*/
21:                    // 'C' source line config statements
22:                    // FBS
23:                    #pragma config BWRP = WRPROTECT_OFF     // Boot Segment Write Protect (Boot Segment may be written)
24:                    #pragma config BSS = NO_FLASH           // Boot Segment Program Flash Code Protection (No Boot program Flash segment)
25:                    #pragma config RBS = NO_RAM             // Boot Segment RAM Protection (No Boot RAM)
26:                
27:                    // FSS
28:                    #pragma config SWRP = WRPROTECT_OFF     // Secure Segment Program Write Protect (Secure segment may be written)
29:                    #pragma config SSS = NO_FLASH           // Secure Segment Program Flash Code Protection (No Secure Segment)
30:                    #pragma config RSS = NO_RAM             // Secure Segment Data RAM Protection (No Secure RAM)
31:                
32:                    // FGS
33:                    #pragma config GWRP = OFF               // General Code Segment Write Protect (User program memory is not write-protected)
34:                    #pragma config GSS = OFF                // General Segment Code Protection (User program memory is not code-protected)
35:                
36:                    /*
37:                    _FOSCSEL(FNOSC_FRC);                                  // Select Internal FRC at POR
38:                    _FOSC(FCKSM_CSECMD & OSCIOFNC_OFF & POSCMD_XT);       // Enable Clock Switching and Configure Posc in XT mode
39:                    _FPOR(RST_PWMPIN & PWM1H_ACT_HI & PWM1L_ACT_HI);      // High and Low switches set to active-high state 
40:                    */
41:                
42:                    // FOSCSEL
43:                    #pragma config FNOSC = PRI              // Primary Oscillator (XT, HS, EV))
44:                    #pragma config IESO = ON                // Internal External Switch Over Mode (Start-up device with FRC, then automatically switch to user-selected oscillator source when ready)
45:                
46:                    // FOSC
47:                    #pragma config POSCMD = XT              // XT Oscillator Mode
48:                    #pragma config OSCIOFNC = OFF           // OSC2 Pin Function (OSC2 pin has clock out function)
49:                    #pragma config IOL1WAY = ON             // Peripheral Pin Select Configuration (Allow Only One Re-configuration)
50:                    #pragma config FCKSM = CSECMD           // This bit is extremely important? if set to CSDCMD there will be no PWM signal!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
51:                    //#pragma config FCKSM = CSDCMD         // Clock Switching and Monitor (Both Clock Switching and Fail-Safe Clock Monitor are disabled)
52:                
53:                    // FWDT
54:                    #pragma config WDTPOST = PS32768        // Watchdog Timer Postscaler (1:32,768)
55:                    #pragma config WDTPRE = PR128           // WDT Prescaler (1:128)
56:                    #pragma config WINDIS = OFF             // Watchdog Timer Window (Watchdog Timer in Non-Window mode)
57:                    #pragma config FWDTEN = OFF             // Watchdog Timer Enable (Watchdog timer always enabled)
58:                
59:                    // FPOR
60:                    #pragma config FPWRT = PWR128           // POR Timer Value (128ms)
61:                    #pragma config ALTI2C = OFF             // Alternate I2C  pins (I2C mapped to SDA1/SCL1 pins)
62:                    #pragma config LPOL = ON                // Motor Control PWM Low Side Polarity bit (PWM module low side output pins have active-high output polarity)
63:                    #pragma config HPOL = ON                // Motor Control PWM High Side Polarity bit (PWM module high side output pins have active-high output polarity)
64:                    #pragma config PWMPIN = OFF             // Motor Control PWM Module Pin Mode bit (PWM module pins controlled by PORT register at device Reset)
65:                
66:                    // FICD
67:                    #pragma config ICS = PGD3               // Comm Channel Select (Communicate on PGC3/EMUC3 and PGD3/EMUD3)
68:                    #pragma config JTAGEN = OFF             // JTAG Port Enable (JTAG is Disabled)
69:                #endif
70:                
71:                #include "user.h"          /* User funct/params, such as InitApp              */
72:                #define PI 3.1415926
73:                
74:                /******************************************************************************/
75:                /* Global Variable Declaration                                                */
76:                /******************************************************************************/
77:                #if defined(__XC16__)
78:                    /* i.e. uint16_t <variable_name>; */
79:                    char ReceivedChar;
80:                    char TransmitChar;
81:                    bool go = 0;
82:                    bool stop = 0;
83:                    bool direction[3] = {0,0,0};
84:                
85:                    int count[6] = {0,0,0,0,0,0};
86:                    int motor[3] = {0,0,0};
87:                    int i = 0;
88:                    int debugPause = 0;
89:                #endif
90:                
91:                extern int countMatrix;
92:                extern int countMatrixGlobal;
93:                extern int countVector;
94:                extern int countVectorGlobal;
95:                float triMatrix[3][3] = { 6,0,0,0,6,0,0,0,6 };
96:                
97:                extern Vector3f *pointerVector[];
98:                extern Vector3f *pointerVectorGlobal[];
99:                extern Matrix *pointerMatrix[];
100:               extern Matrix *pointerMatrixGlobal[];
101:               
102:               Parameter P;
103:               Matrix *Kp;
104:               Matrix *Kd;
105:               clock_t initTime;
106:               clock_t realTime;
107:               /******************************************************************************/
108:               /* Main Program                                                               */
109:               /******************************************************************************/
110:               int main(void)
111:               {   
001250  FA0052     LNK #0x52
001252  BE9F88     MOV.D W8, [W15++]
001254  BE9F8A     MOV.D W10, [W15++]
001256  BE9F8C     MOV.D W12, [W15++]
112:                   /* Configure the oscillator for the device */
113:                   ConfigureOscillator();
001258  0707EB     RCALL ConfigureOscillator
114:                   /* Initialize IO ports and peripherals */
115:                   InitApp();
00125A  070796     RCALL InitApp
116:                   /* TODO <INSERT USER APPLICATION CODE HERE> */
117:                   Kp = m_constructor(global, NULL, NULL, 6, 0, 0, 0, 6, 0, 0, 0, 6);
00125C  200000     MOV #0x0, W0
00125E  240C01     MOV #0x40C0, W1
001260  BE9F80     MOV.D W0, [W15++]
001262  B80060     MUL.UU W0, #0, W0
001264  BE9F80     MOV.D W0, [W15++]
001266  B80060     MUL.UU W0, #0, W0
001268  BE9F80     MOV.D W0, [W15++]
00126A  B80060     MUL.UU W0, #0, W0
00126C  BE9F80     MOV.D W0, [W15++]
00126E  200000     MOV #0x0, W0
001270  240C01     MOV #0x40C0, W1
001272  BE9F80     MOV.D W0, [W15++]
001274  B80060     MUL.UU W0, #0, W0
001276  BE9F80     MOV.D W0, [W15++]
001278  B80060     MUL.UU W0, #0, W0
00127A  BE9F80     MOV.D W0, [W15++]
00127C  B83360     MUL.UU W6, #0, W6
00127E  200004     MOV #0x0, W4
001280  240C05     MOV #0x40C0, W5
001282  EB0100     CLR W2
001284  EB0080     CLR W1
001286  B3C010     MOV.B #0x1, W0
001288  07FBE2     RCALL m_constructor
00128A  5787FC     SUB W15, #0x1C, W15
00128C  884040     MOV W0, Kp
118:               	Kd = m_constructor(global, NULL, NULL, 10, 0, 0, 0, 10, 0, 0, 0, 10);
00128E  200000     MOV #0x0, W0
001290  241201     MOV #0x4120, W1
001292  BE9F80     MOV.D W0, [W15++]
001294  B80060     MUL.UU W0, #0, W0
001296  BE9F80     MOV.D W0, [W15++]
001298  B80060     MUL.UU W0, #0, W0
00129A  BE9F80     MOV.D W0, [W15++]
00129C  B80060     MUL.UU W0, #0, W0
00129E  BE9F80     MOV.D W0, [W15++]
0012A0  200000     MOV #0x0, W0
0012A2  241201     MOV #0x4120, W1
0012A4  BE9F80     MOV.D W0, [W15++]
0012A6  B80060     MUL.UU W0, #0, W0
0012A8  BE9F80     MOV.D W0, [W15++]
0012AA  B80060     MUL.UU W0, #0, W0
0012AC  BE9F80     MOV.D W0, [W15++]
0012AE  B83360     MUL.UU W6, #0, W6
0012B0  200004     MOV #0x0, W4
0012B2  241205     MOV #0x4120, W5
0012B4  EB0100     CLR W2
0012B6  EB0080     CLR W1
0012B8  B3C010     MOV.B #0x1, W0
0012BA  07FBC9     RCALL m_constructor
0012BC  5787FC     SUB W15, #0x1C, W15
0012BE  884050     MOV W0, Kd
119:                   Vector3f* qd = v_constructor(global, NULL, 1, 22, 23);
0012C0  200006     MOV #0x0, W6
0012C2  241B87     MOV #0x41B8, W7
0012C4  200004     MOV #0x0, W4
0012C6  241B05     MOV #0x41B0, W5
0012C8  200002     MOV #0x0, W2
0012CA  23F803     MOV #0x3F80, W3
0012CC  EB0080     CLR W1
0012CE  B3C010     MOV.B #0x1, W0
0012D0  0703CC     RCALL v_constructor
0012D2  780F00     MOV W0, [W14]
120:               	Vector3f* dqd = v_constructor(global, NULL, 46, 55, 6);
0012D4  200006     MOV #0x0, W6
0012D6  240C07     MOV #0x40C0, W7
0012D8  200004     MOV #0x0, W4
0012DA  2425C5     MOV #0x425C, W5
0012DC  200002     MOV #0x0, W2
0012DE  242383     MOV #0x4238, W3
0012E0  EB0080     CLR W1
0012E2  B3C010     MOV.B #0x1, W0
0012E4  0703C2     RCALL v_constructor
0012E6  980710     MOV W0, [W14+2]
121:               	Vector3f* ddqd = v_constructor(global, NULL, 67, 18, 59);
0012E8  200006     MOV #0x0, W6
0012EA  2426C7     MOV #0x426C, W7
0012EC  200004     MOV #0x0, W4
0012EE  241905     MOV #0x4190, W5
0012F0  200002     MOV #0x0, W2
0012F2  242863     MOV #0x4286, W3
0012F4  EB0080     CLR W1
0012F6  B3C010     MOV.B #0x1, W0
0012F8  0703B8     RCALL v_constructor
0012FA  980720     MOV W0, [W14+4]
122:                   Vector3f* q = v_constructor(global, NULL, 18, 3, 55);
0012FC  200006     MOV #0x0, W6
0012FE  2425C7     MOV #0x425C, W7
001300  200004     MOV #0x0, W4
001302  240405     MOV #0x4040, W5
001304  200002     MOV #0x0, W2
001306  241903     MOV #0x4190, W3
001308  EB0080     CLR W1
00130A  B3C010     MOV.B #0x1, W0
00130C  0703AE     RCALL v_constructor
00130E  980730     MOV W0, [W14+6]
123:               	Vector3f* dq = v_constructor(global, NULL, 10, 34, 67);
001310  200006     MOV #0x0, W6
001312  242867     MOV #0x4286, W7
001314  200004     MOV #0x0, W4
001316  242085     MOV #0x4208, W5
001318  200002     MOV #0x0, W2
00131A  241203     MOV #0x4120, W3
00131C  EB0080     CLR W1
00131E  B3C010     MOV.B #0x1, W0
001320  0703A4     RCALL v_constructor
001322  980740     MOV W0, [W14+8]
124:                   Vector3f* controlEffect;
125:               	Vector3f* ddq;
126:                   P.m = 11.4;
001324  266660     MOV #0x6666, W0
001326  241361     MOV #0x4136, W1
001328  885AB0     MOV W0, P
00132A  885AC1     MOV W1, 0xB58
127:               	P.Iv = 0.65;
00132C  266660     MOV #0x6666, W0
00132E  23F261     MOV #0x3F26, W1
001330  885AD0     MOV W0, 0xB5A
001332  885AE1     MOV W1, 0xB5C
128:               	P.r = 0.05;
001334  2CCCD0     MOV #0xCCCD, W0
001336  23D4C1     MOV #0x3D4C, W1
001338  885AF0     MOV W0, 0xB5E
00133A  885B01     MOV W1, 0xB60
129:               	P.Din = 0.147;
00133C  2872B0     MOV #0x872B, W0
00133E  23E161     MOV #0x3E16, W1
001340  885B10     MOV W0, 0xB62
001342  885B21     MOV W1, 0xB64
130:               	P.Dout = 0.236;
001344  2A9FC0     MOV #0xA9FC, W0
001346  23E711     MOV #0x3E71, W1
001348  885B30     MOV W0, 0xB66
00134A  885B41     MOV W1, 0xB68
131:               	//P.La = (P.Din + P.Dout) / 2;
132:               	P.La = 0.2425;
00134C  251EC0     MOV #0x51EC, W0
00134E  23E781     MOV #0x3E78, W1
001350  885B50     MOV W0, 0xB6A
001352  885B61     MOV W1, 0xB6C
133:               	P.I0 = 6 * pow(10, -6);
001354  2539C0     MOV #0x539C, W0
001356  236C91     MOV #0x36C9, W1
001358  885B70     MOV W0, 0xB6E
00135A  885B81     MOV W1, 0xB70
134:               	P.kt = 0.0208;
00135C  264C30     MOV #0x64C3, W0
00135E  23CAA1     MOV #0x3CAA, W1
001360  885B90     MOV W0, _m_destructor
001362  885BA1     MOV W1, 0xB74
135:               	//P.kb = 1 / 34.34;
136:               	P.kb = 0.02076;
001364  210E00     MOV #0x10E0, W0
001366  23CAA1     MOV #0x3CAA, W1
001368  885BB0     MOV W0, 0xB76
00136A  885BC1     MOV W1, 0xB78
137:               	P.n = 71;
00136C  200000     MOV #0x0, W0
00136E  2428E1     MOV #0x428E, W1
001370  885BD0     MOV W0, 0xB7A
001372  885BE1     MOV W1, 0xB7C
138:               	P.b0 = 6.0 * pow(10, -5);
001374  2A8820     MOV #0xA882, W0
001376  2387B1     MOV #0x387B, W1
001378  885BF0     MOV W0, 0xB7E
00137A  885C01     MOV W1, 0xB80
139:               	P.Ra = 1.53;
00137C  2D70A0     MOV #0xD70A, W0
00137E  23FC31     MOV #0x3FC3, W1
001380  885C10     MOV W0, 0xB82
001382  885C21     MOV W1, 0xB84
140:               	P.beta0 = pow(P.n, 2) * P.I0 / pow(P.r, 2);
001384  805BD0     MOV 0xB7A, W0
001386  805BE1     MOV 0xB7C, W1
001388  BE0100     MOV.D W0, W2
00138A  07F942     RCALL ___mulsf3
00138C  BE0200     MOV.D W0, W4
00138E  805B70     MOV 0xB6E, W0
001390  805B81     MOV 0xB70, W1
001392  BE0100     MOV.D W0, W2
001394  BE0004     MOV.D W4, W0
001396  07F93C     RCALL ___mulsf3
001398  BE0400     MOV.D W0, W8
00139A  805AF0     MOV 0xB5E, W0
00139C  805B01     MOV 0xB60, W1
00139E  BE0100     MOV.D W0, W2
0013A0  07F937     RCALL ___mulsf3
0013A2  BE0100     MOV.D W0, W2
0013A4  BE0008     MOV.D W8, W0
0013A6  07F87E     RCALL ___divsf3
0013A8  885C30     MOV W0, 0xB86
0013AA  885C41     MOV W1, 0xB88
141:               	P.beta1 = pow(P.n, 2) * (P.b0 + P.kt*P.kb / P.Ra) / pow(P.r, 2);
0013AC  805BD0     MOV 0xB7A, W0
0013AE  805BE1     MOV 0xB7C, W1
0013B0  BE0100     MOV.D W0, W2
0013B2  07F92E     RCALL ___mulsf3
0013B4  BE0500     MOV.D W0, W10
0013B6  805BF8     MOV 0xB7E, W8
0013B8  805C09     MOV 0xB80, W9
0013BA  805B94     MOV _m_destructor, W4
0013BC  805BA5     MOV 0xB74, W5
0013BE  805BB0     MOV 0xB76, W0
0013C0  805BC1     MOV 0xB78, W1
0013C2  BE0100     MOV.D W0, W2
0013C4  BE0004     MOV.D W4, W0
0013C6  07F924     RCALL ___mulsf3
0013C8  BE0200     MOV.D W0, W4
0013CA  805C10     MOV 0xB82, W0
0013CC  805C21     MOV 0xB84, W1
0013CE  BE0100     MOV.D W0, W2
0013D0  BE0004     MOV.D W4, W0
0013D2  07F868     RCALL ___divsf3
0013D4  BE0100     MOV.D W0, W2
0013D6  BE0008     MOV.D W8, W0
0013D8  07F806     RCALL ___addsf3
0013DA  BE0100     MOV.D W0, W2
0013DC  BE000A     MOV.D W10, W0
0013DE  07F918     RCALL ___mulsf3
0013E0  BE0400     MOV.D W0, W8
0013E2  805AF0     MOV 0xB5E, W0
0013E4  805B01     MOV 0xB60, W1
0013E6  BE0100     MOV.D W0, W2
0013E8  07F913     RCALL ___mulsf3
0013EA  BE0100     MOV.D W0, W2
0013EC  BE0008     MOV.D W8, W0
0013EE  07F85A     RCALL ___divsf3
0013F0  885C50     MOV W0, 0xB8A
0013F2  885C61     MOV W1, 0xB8C
142:               	P.beta2 = P.n*P.kt / P.r / P.Ra;
0013F4  805BD4     MOV 0xB7A, W4
0013F6  805BE5     MOV 0xB7C, W5
0013F8  805B90     MOV _m_destructor, W0
0013FA  805BA1     MOV 0xB74, W1
0013FC  BE0100     MOV.D W0, W2
0013FE  BE0004     MOV.D W4, W0
001400  07F907     RCALL ___mulsf3
001402  BE0200     MOV.D W0, W4
001404  805AF0     MOV 0xB5E, W0
001406  805B01     MOV 0xB60, W1
001408  BE0100     MOV.D W0, W2
00140A  BE0004     MOV.D W4, W0
00140C  07F84B     RCALL ___divsf3
00140E  BE0200     MOV.D W0, W4
001410  805C10     MOV 0xB82, W0
001412  805C21     MOV 0xB84, W1
001414  BE0100     MOV.D W0, W2
001416  BE0004     MOV.D W4, W0
001418  07F845     RCALL ___divsf3
00141A  885C70     MOV W0, 0xB8E
00141C  885C81     MOV W1, _m_plus
143:                   initTime = clock();
00141E  07FA7C     RCALL _clock
001420  884060     MOV W0, initTime
001422  884071     MOV W1, 0x80E
144:                   while(1)
145:                   {
146:                       if(U1STAbits.PERR==1)
001424  801110     MOV U1STA, W0
001426  600068     AND W0, #0x8, W0
001428  E00000     CP0 W0
00142A  320001     BRA Z, 0x142E
147:                       {
148:                           continue;
00142C  370180     BRA 0x172E
149:                       }
150:                       if(U1STAbits.OERR==1)
00142E  801110     MOV U1STA, W0
001430  600062     AND W0, #0x2, W0
001432  E00000     CP0 W0
001434  320002     BRA Z, 0x143A
151:                       {
152:                           //LATAbits.LATA0=1;
153:                           U1STAbits.OERR=0;
001436  A92222     BCLR U1STA, #1
154:                           //receivedNumber++;
155:                           continue;       //continue statement must be in a loop;
001438  37017A     BRA 0x172E
156:                       }
157:                       if(U1STAbits.URXDA==1)
00143A  801110     MOV U1STA, W0
158:                       {   
159:                           //LATAbits.LATA1=1;
160:                       }
161:               //        realTime = clock() - initTime;
162:               //        qd->x = cos(realTime*PI / 15);
163:               //		qd->y = sin(realTime*PI / 15);
164:               //		qd->z = 0;
165:               //        dqd->x = -PI/15*sin(realTime*PI / 15);
166:               //		dqd->y = PI/15*cos(realTime*PI / 15);
167:               //		dqd->z = 0;
168:               //        ddqd->x = -pow(PI/15,2)*cos(realTime*PI / 15);
169:               //		ddqd->y = -pow(PI/15,2)*sin(realTime*PI / 15);
170:               //		ddqd->z = 0;
171:                       while(!debugPause);
00143C  000000     NOP
00143E  804030     MOV debugPause, W0
001440  E00000     CP0 W0
001442  32FFFD     BRA Z, 0x143E
172:                       U1TXREG = countMatrix;
001444  8040B0     MOV countMatrix, W0
001446  881120     MOV W0, U1TXREG
173:                       U1TXREG = countVector;
001448  8040C0     MOV countVector, W0
00144A  881120     MOV W0, U1TXREG
174:                       U1TXREG = countMatrixGlobal;
00144C  8040D0     MOV countMatrixGlobal, W0
00144E  881120     MOV W0, U1TXREG
175:                       U1TXREG = countVectorGlobal;
001450  8040E0     MOV countVectorGlobal, W0
001452  881120     MOV W0, U1TXREG
176:                       DELAY_105us
001454  091069     REPEAT #0x1069
001456  000000     NOP
177:                       DELAY_105us
001458  091069     REPEAT #0x1069
00145A  000000     NOP
178:                       DELAY_105us
00145C  091069     REPEAT #0x1069
00145E  000000     NOP
179:                       DELAY_105us
001460  091069     REPEAT #0x1069
001462  000000     NOP
180:                       controlEffect = OMRS_controller(qd, dqd, ddqd, q, dq);
001464  90024E     MOV [W14+8], W4
001466  9001BE     MOV [W14+6], W3
001468  90012E     MOV [W14+4], W2
00146A  90009E     MOV [W14+2], W1
00146C  78001E     MOV [W14], W0
00146E  070396     RCALL OMRS_controller
001470  980750     MOV W0, [W14+10]
181:               		ddq = OMRS_model(controlEffect, q, dq);
001472  90014E     MOV [W14+8], W2
001474  9000BE     MOV [W14+6], W1
001476  90005E     MOV [W14+10], W0
001478  070518     RCALL OMRS_model
00147A  980760     MOV W0, [W14+12]
182:                       U1TXREG = countMatrix;
00147C  8040B0     MOV countMatrix, W0
00147E  881120     MOV W0, U1TXREG
183:                       U1TXREG = countVector;
001480  8040C0     MOV countVector, W0
001482  881120     MOV W0, U1TXREG
184:                       U1TXREG = countMatrixGlobal;
001484  8040D0     MOV countMatrixGlobal, W0
001486  881120     MOV W0, U1TXREG
185:                       U1TXREG = countVectorGlobal;
001488  8040E0     MOV countVectorGlobal, W0
00148A  881120     MOV W0, U1TXREG
186:                       DELAY_105us
00148C  091069     REPEAT #0x1069
00148E  000000     NOP
187:                       DELAY_105us
001490  091069     REPEAT #0x1069
001492  000000     NOP
188:                       DELAY_105us
001494  091069     REPEAT #0x1069
001496  000000     NOP
189:                       DELAY_105us
001498  091069     REPEAT #0x1069
00149A  000000     NOP
190:                       U1TXREG =  ((long)(1000*controlEffect->x))>>24;
00149C  90005E     MOV [W14+10], W0
00149E  BE0010     MOV.D [W0], W0
0014A0  200002     MOV #0x0, W2
0014A2  2447A3     MOV #0x447A, W3
0014A4  07F8B5     RCALL ___mulsf3
0014A6  07F840     RCALL ___fixsfsi
0014A8  DE8E48     ASR W1, #8, W12
0014AA  DE8ECF     ASR W1, #15, W13
0014AC  78000C     MOV W12, W0
0014AE  881120     MOV W0, U1TXREG
191:                       U1TXREG =  ((long)(1000*controlEffect->x))>>16;
0014B0  90005E     MOV [W14+10], W0
0014B2  BE0010     MOV.D [W0], W0
0014B4  200002     MOV #0x0, W2
0014B6  2447A3     MOV #0x447A, W3
0014B8  07F8AB     RCALL ___mulsf3
0014BA  07F836     RCALL ___fixsfsi
0014BC  DE8940     ASR W1, #0, W2
0014BE  980772     MOV W2, [W14+14]
0014C0  DE89CF     ASR W1, #15, W3
0014C2  980F03     MOV W3, [W14+16]
0014C4  90007E     MOV [W14+14], W0
0014C6  881120     MOV W0, U1TXREG
192:                       U1TXREG =  ((long)(1000*controlEffect->x))>>8;
0014C8  90005E     MOV [W14+10], W0
0014CA  BE0010     MOV.D [W0], W0
0014CC  200002     MOV #0x0, W2
0014CE  2447A3     MOV #0x447A, W3
0014D0  07F89F     RCALL ___mulsf3
0014D2  07F82A     RCALL ___fixsfsi
0014D4  DD09C8     SL W1, #8, W3
0014D6  DE0148     LSR W0, #8, W2
0014D8  718102     IOR W3, W2, W2
0014DA  980F12     MOV W2, [W14+18]
0014DC  DE8948     ASR W1, #8, W2
0014DE  980F22     MOV W2, [W14+20]
0014E0  90081E     MOV [W14+18], W0
0014E2  881120     MOV W0, U1TXREG
193:                       U1TXREG =  ((long)(1000*controlEffect->x));
0014E4  90005E     MOV [W14+10], W0
0014E6  BE0010     MOV.D [W0], W0
0014E8  200002     MOV #0x0, W2
0014EA  2447A3     MOV #0x447A, W3
0014EC  07F891     RCALL ___mulsf3
0014EE  07F81C     RCALL ___fixsfsi
0014F0  780000     MOV W0, W0
0014F2  881120     MOV W0, U1TXREG
194:                       DELAY_105us
0014F4  091069     REPEAT #0x1069
0014F6  000000     NOP
195:                       DELAY_105us
0014F8  091069     REPEAT #0x1069
0014FA  000000     NOP
196:                       DELAY_105us
0014FC  091069     REPEAT #0x1069
0014FE  000000     NOP
197:                       U1TXREG =  ((long)(1000*controlEffect->y))>>24;
001500  90005E     MOV [W14+10], W0
001502  9000B0     MOV [W0+6], W1
001504  900020     MOV [W0+4], W0
001506  200002     MOV #0x0, W2
001508  2447A3     MOV #0x447A, W3
00150A  07F882     RCALL ___mulsf3
00150C  07F80D     RCALL ___fixsfsi
00150E  DE89C8     ASR W1, #8, W3
001510  980F33     MOV W3, [W14+22]
001512  DE894F     ASR W1, #15, W2
001514  980F42     MOV W2, [W14+24]
001516  90083E     MOV [W14+22], W0
001518  881120     MOV W0, U1TXREG
198:                       U1TXREG =  ((long)(1000*controlEffect->y))>>16;
00151A  90005E     MOV [W14+10], W0
00151C  9000B0     MOV [W0+6], W1
00151E  900020     MOV [W0+4], W0
001520  200002     MOV #0x0, W2
001522  2447A3     MOV #0x447A, W3
001524  07F875     RCALL ___mulsf3
001526  07F800     RCALL ___fixsfsi
001528  DE89C0     ASR W1, #0, W3
00152A  980F53     MOV W3, [W14+26]
00152C  DE894F     ASR W1, #15, W2
00152E  980F62     MOV W2, [W14+28]
001530  90085E     MOV [W14+26], W0
001532  881120     MOV W0, U1TXREG
199:                       U1TXREG =  ((long)(1000*controlEffect->y))>>8;
001534  90005E     MOV [W14+10], W0
001536  9000B0     MOV [W0+6], W1
001538  900020     MOV [W0+4], W0
00153A  200002     MOV #0x0, W2
00153C  2447A3     MOV #0x447A, W3
00153E  07F868     RCALL ___mulsf3
001540  07F7F3     RCALL ___fixsfsi
001542  DD0948     SL W1, #8, W2
001544  DE01C8     LSR W0, #8, W3
001546  710183     IOR W2, W3, W3
001548  980F73     MOV W3, [W14+30]
00154A  DE89C8     ASR W1, #8, W3
00154C  981703     MOV W3, [W14+32]
00154E  90087E     MOV [W14+30], W0
001550  881120     MOV W0, U1TXREG
200:                       U1TXREG =  ((long)(1000*controlEffect->y));
001552  90005E     MOV [W14+10], W0
001554  9000B0     MOV [W0+6], W1
001556  900020     MOV [W0+4], W0
001558  200002     MOV #0x0, W2
00155A  2447A3     MOV #0x447A, W3
00155C  07F859     RCALL ___mulsf3
00155E  07F7E4     RCALL ___fixsfsi
001560  780000     MOV W0, W0
001562  881120     MOV W0, U1TXREG
201:                       DELAY_105us
001564  091069     REPEAT #0x1069
001566  000000     NOP
202:                       DELAY_105us
001568  091069     REPEAT #0x1069
00156A  000000     NOP
203:                       DELAY_105us
00156C  091069     REPEAT #0x1069
00156E  000000     NOP
204:                       U1TXREG =  ((long)(1000*controlEffect->z))>>24;
001570  90005E     MOV [W14+10], W0
001572  9000D0     MOV [W0+10], W1
001574  900040     MOV [W0+8], W0
001576  200002     MOV #0x0, W2
001578  2447A3     MOV #0x447A, W3
00157A  07F84A     RCALL ___mulsf3
00157C  07F7D5     RCALL ___fixsfsi
00157E  DE8948     ASR W1, #8, W2
001580  981712     MOV W2, [W14+34]
001582  DE89CF     ASR W1, #15, W3
001584  981723     MOV W3, [W14+36]
001586  90101E     MOV [W14+34], W0
001588  881120     MOV W0, U1TXREG
205:                       U1TXREG =  ((long)(1000*controlEffect->z))>>16;
00158A  90005E     MOV [W14+10], W0
00158C  9000D0     MOV [W0+10], W1
00158E  900040     MOV [W0+8], W0
001590  200002     MOV #0x0, W2
001592  2447A3     MOV #0x447A, W3
001594  07F83D     RCALL ___mulsf3
001596  07F7C8     RCALL ___fixsfsi
001598  DE8940     ASR W1, #0, W2
00159A  981732     MOV W2, [W14+38]
00159C  DE89CF     ASR W1, #15, W3
00159E  981743     MOV W3, [W14+40]
0015A0  90103E     MOV [W14+38], W0
0015A2  881120     MOV W0, U1TXREG
206:                       U1TXREG =  ((long)(1000*controlEffect->z))>>8;
0015A4  90005E     MOV [W14+10], W0
0015A6  9000D0     MOV [W0+10], W1
0015A8  900040     MOV [W0+8], W0
0015AA  200002     MOV #0x0, W2
0015AC  2447A3     MOV #0x447A, W3
0015AE  07F830     RCALL ___mulsf3
0015B0  07F7BB     RCALL ___fixsfsi
0015B2  DD09C8     SL W1, #8, W3
0015B4  DE0148     LSR W0, #8, W2
0015B6  718102     IOR W3, W2, W2
0015B8  981752     MOV W2, [W14+42]
0015BA  DE8948     ASR W1, #8, W2
0015BC  981762     MOV W2, [W14+44]
0015BE  90105E     MOV [W14+42], W0
0015C0  881120     MOV W0, U1TXREG
207:                       U1TXREG =  ((long)(1000*controlEffect->z));
0015C2  90005E     MOV [W14+10], W0
0015C4  9000D0     MOV [W0+10], W1
0015C6  900040     MOV [W0+8], W0
0015C8  200002     MOV #0x0, W2
0015CA  2447A3     MOV #0x447A, W3
0015CC  07F821     RCALL ___mulsf3
0015CE  07F7AC     RCALL ___fixsfsi
0015D0  780000     MOV W0, W0
0015D2  881120     MOV W0, U1TXREG
208:                       DELAY_105us
0015D4  091069     REPEAT #0x1069
0015D6  000000     NOP
209:                       DELAY_105us
0015D8  091069     REPEAT #0x1069
0015DA  000000     NOP
210:                       DELAY_105us
0015DC  091069     REPEAT #0x1069
0015DE  000000     NOP
211:                       U1TXREG =  ((long)(1000*ddq->x))>>24;
0015E0  90006E     MOV [W14+12], W0
0015E2  BE0010     MOV.D [W0], W0
0015E4  200002     MOV #0x0, W2
0015E6  2447A3     MOV #0x447A, W3
0015E8  07F813     RCALL ___mulsf3
0015EA  07F79E     RCALL ___fixsfsi
0015EC  DE89C8     ASR W1, #8, W3
0015EE  981773     MOV W3, [W14+46]
0015F0  DE894F     ASR W1, #15, W2
0015F2  981F02     MOV W2, [W14+48]
0015F4  90107E     MOV [W14+46], W0
0015F6  881120     MOV W0, U1TXREG
212:                       U1TXREG =  ((long)(1000*ddq->x))>>16;
0015F8  90006E     MOV [W14+12], W0
0015FA  BE0010     MOV.D [W0], W0
0015FC  200002     MOV #0x0, W2
0015FE  2447A3     MOV #0x447A, W3
001600  07F807     RCALL ___mulsf3
001602  07F792     RCALL ___fixsfsi
001604  DE89C0     ASR W1, #0, W3
001606  981F13     MOV W3, [W14+50]
001608  DE894F     ASR W1, #15, W2
00160A  981F22     MOV W2, [W14+52]
00160C  90181E     MOV [W14+50], W0
00160E  881120     MOV W0, U1TXREG
213:                       U1TXREG =  ((long)(1000*ddq->x))>>8;
001610  90006E     MOV [W14+12], W0
001612  BE0010     MOV.D [W0], W0
001614  200002     MOV #0x0, W2
001616  2447A3     MOV #0x447A, W3
001618  07F7FB     RCALL ___mulsf3
00161A  07F786     RCALL ___fixsfsi
00161C  DD0948     SL W1, #8, W2
00161E  DE01C8     LSR W0, #8, W3
001620  710183     IOR W2, W3, W3
001622  981F33     MOV W3, [W14+54]
001624  DE89C8     ASR W1, #8, W3
001626  981F43     MOV W3, [W14+56]
001628  90183E     MOV [W14+54], W0
00162A  881120     MOV W0, U1TXREG
214:                       U1TXREG =  ((long)(1000*ddq->x));
00162C  90006E     MOV [W14+12], W0
00162E  BE0010     MOV.D [W0], W0
001630  200002     MOV #0x0, W2
001632  2447A3     MOV #0x447A, W3
001634  07F7ED     RCALL ___mulsf3
001636  07F778     RCALL ___fixsfsi
001638  780000     MOV W0, W0
00163A  881120     MOV W0, U1TXREG
215:                       DELAY_105us
00163C  091069     REPEAT #0x1069
00163E  000000     NOP
216:                       DELAY_105us
001640  091069     REPEAT #0x1069
001642  000000     NOP
217:                       DELAY_105us
001644  091069     REPEAT #0x1069
001646  000000     NOP
218:                       U1TXREG =  ((long)(1000*ddq->y))>>24;
001648  90006E     MOV [W14+12], W0
00164A  9000B0     MOV [W0+6], W1
00164C  900020     MOV [W0+4], W0
00164E  200002     MOV #0x0, W2
001650  2447A3     MOV #0x447A, W3
001652  07F7DE     RCALL ___mulsf3
001654  07F769     RCALL ___fixsfsi
001656  DE8948     ASR W1, #8, W2
001658  981F52     MOV W2, [W14+58]
00165A  DE89CF     ASR W1, #15, W3
00165C  981F63     MOV W3, [W14+60]
00165E  90185E     MOV [W14+58], W0
001660  881120     MOV W0, U1TXREG
219:                       U1TXREG =  ((long)(1000*ddq->y))>>16;
001662  90006E     MOV [W14+12], W0
001664  9000B0     MOV [W0+6], W1
001666  900020     MOV [W0+4], W0
001668  200002     MOV #0x0, W2
00166A  2447A3     MOV #0x447A, W3
00166C  07F7D1     RCALL ___mulsf3
00166E  07F75C     RCALL ___fixsfsi
001670  DE8940     ASR W1, #0, W2
001672  981F72     MOV W2, [W14+62]
001674  DE89CF     ASR W1, #15, W3
001676  982703     MOV W3, [W14+64]
001678  90187E     MOV [W14+62], W0
00167A  881120     MOV W0, U1TXREG
220:                       U1TXREG =  ((long)(1000*ddq->y))>>8;
00167C  90006E     MOV [W14+12], W0
00167E  9000B0     MOV [W0+6], W1
001680  900020     MOV [W0+4], W0
001682  200002     MOV #0x0, W2
001684  2447A3     MOV #0x447A, W3
001686  07F7C4     RCALL ___mulsf3
001688  07F74F     RCALL ___fixsfsi
00168A  DD09C8     SL W1, #8, W3
00168C  DE0148     LSR W0, #8, W2
00168E  718102     IOR W3, W2, W2
001690  982712     MOV W2, [W14+66]
001692  DE8948     ASR W1, #8, W2
001694  982722     MOV W2, [W14+68]
001696  90201E     MOV [W14+66], W0
001698  881120     MOV W0, U1TXREG
221:                       U1TXREG =  ((long)(1000*ddq->y));
00169A  90006E     MOV [W14+12], W0
00169C  9000B0     MOV [W0+6], W1
00169E  900020     MOV [W0+4], W0
0016A0  200002     MOV #0x0, W2
0016A2  2447A3     MOV #0x447A, W3
0016A4  07F7B5     RCALL ___mulsf3
0016A6  07F740     RCALL ___fixsfsi
0016A8  780000     MOV W0, W0
0016AA  881120     MOV W0, U1TXREG
222:                       DELAY_105us
0016AC  091069     REPEAT #0x1069
0016AE  000000     NOP
223:                       DELAY_105us
0016B0  091069     REPEAT #0x1069
0016B2  000000     NOP
224:                       DELAY_105us
0016B4  091069     REPEAT #0x1069
0016B6  000000     NOP
225:                       U1TXREG =  ((long)(1000*ddq->z))>>24;
0016B8  90006E     MOV [W14+12], W0
0016BA  9000D0     MOV [W0+10], W1
0016BC  900040     MOV [W0+8], W0
0016BE  200002     MOV #0x0, W2
0016C0  2447A3     MOV #0x447A, W3
0016C2  07F7A6     RCALL ___mulsf3
0016C4  07F731     RCALL ___fixsfsi
0016C6  DE89C8     ASR W1, #8, W3
0016C8  982733     MOV W3, [W14+70]
0016CA  DE894F     ASR W1, #15, W2
0016CC  982742     MOV W2, [W14+72]
0016CE  90203E     MOV [W14+70], W0
0016D0  881120     MOV W0, U1TXREG
226:                       U1TXREG =  ((long)(1000*ddq->z))>>16;
0016D2  90006E     MOV [W14+12], W0
0016D4  9000D0     MOV [W0+10], W1
0016D6  900040     MOV [W0+8], W0
0016D8  200002     MOV #0x0, W2
0016DA  2447A3     MOV #0x447A, W3
0016DC  07F799     RCALL ___mulsf3
0016DE  07F724     RCALL ___fixsfsi
0016E0  DE89C0     ASR W1, #0, W3
0016E2  982753     MOV W3, [W14+74]
0016E4  DE894F     ASR W1, #15, W2
0016E6  982762     MOV W2, [W14+76]
0016E8  90205E     MOV [W14+74], W0
0016EA  881120     MOV W0, U1TXREG
227:                       U1TXREG =  ((long)(1000*ddq->z))>>8;
0016EC  90006E     MOV [W14+12], W0
0016EE  9000D0     MOV [W0+10], W1
0016F0  900040     MOV [W0+8], W0
0016F2  200002     MOV #0x0, W2
0016F4  2447A3     MOV #0x447A, W3
0016F6  07F78C     RCALL ___mulsf3
0016F8  07F717     RCALL ___fixsfsi
0016FA  DD0948     SL W1, #8, W2
0016FC  DE01C8     LSR W0, #8, W3
0016FE  710183     IOR W2, W3, W3
001700  982773     MOV W3, [W14+78]
001702  DE89C8     ASR W1, #8, W3
001704  982F03     MOV W3, [W14+80]
001706  90207E     MOV [W14+78], W0
001708  881120     MOV W0, U1TXREG
228:                       U1TXREG =  ((long)(1000*ddq->z));
00170A  90006E     MOV [W14+12], W0
00170C  9000D0     MOV [W0+10], W1
00170E  900040     MOV [W0+8], W0
001710  200002     MOV #0x0, W2
001712  2447A3     MOV #0x447A, W3
001714  07F77D     RCALL ___mulsf3
001716  07F708     RCALL ___fixsfsi
001718  780000     MOV W0, W0
00171A  881120     MOV W0, U1TXREG
229:                       DELAY_105us
00171C  091069     REPEAT #0x1069
00171E  000000     NOP
230:                       DELAY_105us
001720  091069     REPEAT #0x1069
001722  000000     NOP
231:                       DELAY_105us
001724  091069     REPEAT #0x1069
001726  000000     NOP
232:               //        motor_drive();
233:                       /* release dynamically allocated local memory */
234:                       freeLocalMem();
001728  0701EF     RCALL freeLocalMem
235:                       
236:                       debugPause = 0;
00172A  EF2806     CLR debugPause
237:                   };
00172C  37FE7B     BRA 0x1424
00172E  37FE7A     BRA 0x1424
238:                   /* release dynamically allocated global memory */
239:                   freeGlobalMem();
240:                   
241:                   return 0;
242:               }
243:               
244:               #if defined(__XC16__)
245:               
246:               void motor_drive(void)
247:               {       
001730  FA0004     LNK #0x4
248:                   if(stop){
001732  BFC803     MOV.B stop, WREG
001734  E00400     CP0.B W0
001736  320003     BRA Z, 0x173E
249:                   LATAbits.LATA0=1;
001738  A802C4     BSET LATA, #0
250:                   LATAbits.LATA4=1;
00173A  A882C4     BSET LATA, #4
251:                   LATAbits.LATA8=1;
00173C  A802C5     BSET 0x2C5, #0
252:                   }
253:                   if(go){
00173E  BFC802     MOV.B go, WREG
001740  E00400     CP0.B W0
001742  320003     BRA Z, 0x174A
254:                   LATAbits.LATA0=0;
001744  A902C4     BCLR LATA, #0
255:                   LATAbits.LATA4=0;
001746  A982C4     BCLR LATA, #4
256:                   LATAbits.LATA8=0;
001748  A902C5     BCLR 0x2C5, #0
257:                   }
258:               
259:                   if(i==0)
00174A  804020     MOV i, W0
00174C  E00000     CP0 W0
00174E  3A0021     BRA NZ, 0x1792
260:                   {            
261:                       motor[0] = count[0];
001750  805A20     MOV count, W0
001752  885A80     MOV W0, motor
262:                       motor[0] = motor[0] & 0x00FF;
001754  805A81     MOV motor, W1
001756  200FF0     MOV #0xFF, W0
001758  608000     AND W1, W0, W0
00175A  885A80     MOV W0, motor
263:                       motor[0] = motor[0] | (count[1]<<8);
00175C  805A81     MOV motor, W1
00175E  805A30     MOV 0xB46, W0
001760  DD0048     SL W0, #8, W0
001762  700001     IOR W0, W1, W0
001764  885A80     MOV W0, motor
264:               
265:                       motor[1] = count[2];
001766  805A40     MOV 0xB48, W0
001768  885A90     MOV W0, 0xB52
266:                       motor[1] = motor[1] & 0x00FF;
00176A  805A91     MOV 0xB52, W1
00176C  200FF0     MOV #0xFF, W0
00176E  608000     AND W1, W0, W0
001770  885A90     MOV W0, 0xB52
267:                       motor[1] = motor[1] | (count[3]<<8);
001772  805A91     MOV 0xB52, W1
001774  805A50     MOV 0xB4A, W0
001776  DD0048     SL W0, #8, W0
001778  700001     IOR W0, W1, W0
00177A  885A90     MOV W0, 0xB52
268:               
269:                       motor[2] = count[4];
00177C  805A60     MOV 0xB4C, W0
00177E  885AA0     MOV W0, 0xB54
270:                       motor[2] = motor[2] & 0x00FF;
001780  805AA1     MOV 0xB54, W1
001782  200FF0     MOV #0xFF, W0
001784  608000     AND W1, W0, W0
001786  885AA0     MOV W0, 0xB54
271:                       motor[2] = motor[2] | (count[5]<<8);
001788  805AA1     MOV 0xB54, W1
00178A  805A70     MOV 0xB4E, W0
00178C  DD0048     SL W0, #8, W0
00178E  700001     IOR W0, W1, W0
001790  885AA0     MOV W0, 0xB54
272:                   }
273:                   int j=0;
001792  EB0000     CLR W0
001794  780F00     MOV W0, [W14]
274:                   for(j=0;j<3;j++)
001796  EB0000     CLR W0
001798  780F00     MOV W0, [W14]
00179A  370023     BRA 0x17E2
0017E0  E80F1E     INC [W14], [W14]
0017E2  78001E     MOV [W14], W0
0017E4  500FE2     SUB W0, #0x2, [W15]
0017E6  34FFDA     BRA LE, 0x179C
275:                   {
276:                       int temp=0;
00179C  EB0000     CLR W0
00179E  980710     MOV W0, [W14+2]
277:                       temp = motor[j] & 0x8000;
0017A0  78001E     MOV [W14], W0
0017A2  400080     ADD W0, W0, W1
0017A4  20B500     MOV #0xB50, W0
0017A6  408000     ADD W1, W0, W0
0017A8  780090     MOV [W0], W1
0017AA  280000     MOV #0x8000, W0
0017AC  608000     AND W1, W0, W0
0017AE  980710     MOV W0, [W14+2]
278:                       if(temp)
0017B0  90001E     MOV [W14+2], W0
0017B2  E00000     CP0 W0
0017B4  320011     BRA Z, 0x17D8
279:                       {
280:                           motor[j]=motor[j] & 0x7fff ;
0017B6  78001E     MOV [W14], W0
0017B8  400080     ADD W0, W0, W1
0017BA  20B500     MOV #0xB50, W0
0017BC  408000     ADD W1, W0, W0
0017BE  780090     MOV [W0], W1
0017C0  27FFF0     MOV #0x7FFF, W0
0017C2  608080     AND W1, W0, W1
0017C4  78001E     MOV [W14], W0
0017C6  400100     ADD W0, W0, W2
0017C8  20B500     MOV #0xB50, W0
0017CA  410000     ADD W2, W0, W0
0017CC  780801     MOV W1, [W0]
281:                           //motor[j]=~(motor[j]-1);
282:                           direction[j]=0;
0017CE  20B400     MOV #0xB40, W0
0017D0  40001E     ADD W0, [W14], W0
0017D2  EB4080     CLR.B W1
0017D4  784801     MOV.B W1, [W0]
0017D6  370004     BRA 0x17E0
283:                       }else{direction[j]=1;}
0017D8  20B400     MOV #0xB40, W0
0017DA  40001E     ADD W0, [W14], W0
0017DC  B3C011     MOV.B #0x1, W1
0017DE  784801     MOV.B W1, [W0]
284:                   }
285:                   LATAbits.LATA1=direction[0];
0017E8  20B400     MOV #0xB40, W0
0017EA  784010     MOV.B [W0], W0
0017EC  FB8000     ZE W0, W0
0017EE  600061     AND W0, #0x1, W0
0017F0  400000     ADD W0, W0, W0
0017F2  801622     MOV LATA, W2
0017F4  2FFFD1     MOV #0xFFFD, W1
0017F6  610081     AND W2, W1, W1
0017F8  700001     IOR W0, W1, W0
0017FA  881620     MOV W0, LATA
286:                   LATAbits.LATA7=direction[1];
0017FC  20B410     MOV #0xB41, W0
0017FE  784010     MOV.B [W0], W0
001800  FB8000     ZE W0, W0
001802  600061     AND W0, #0x1, W0
001804  DD0047     SL W0, #7, W0
001806  801622     MOV LATA, W2
001808  2FF7F1     MOV #0xFF7F, W1
00180A  610081     AND W2, W1, W1
00180C  700001     IOR W0, W1, W0
00180E  881620     MOV W0, LATA
287:                   LATAbits.LATA9=direction[2];
001810  20B420     MOV #0xB42, W0
001812  784010     MOV.B [W0], W0
001814  FB8000     ZE W0, W0
001816  600061     AND W0, #0x1, W0
001818  DD0049     SL W0, #9, W0
00181A  801622     MOV LATA, W2
00181C  2FDFF1     MOV #0xFDFF, W1
00181E  610081     AND W2, W1, W1
001820  700001     IOR W0, W1, W0
001822  881620     MOV W0, LATA
288:                   P1DC1=(5*motor[0]/3);
001824  805A80     MOV motor, W0
001826  B90065     MUL.SU W0, #5, W0
001828  780100     MOV W0, W2
00182A  255560     MOV #0x5556, W0
00182C  B99000     MUL.SS W2, W0, W0
00182E  DE914F     ASR W2, #15, W2
001830  508002     SUB W1, W2, W0
001832  880EB0     MOV W0, P1DC1
289:                   P1DC2=(5*motor[1]/3);
001834  805A90     MOV 0xB52, W0
001836  B90065     MUL.SU W0, #5, W0
001838  780100     MOV W0, W2
00183A  255560     MOV #0x5556, W0
00183C  B99000     MUL.SS W2, W0, W0
00183E  DE914F     ASR W2, #15, W2
001840  508002     SUB W1, W2, W0
001842  880EC0     MOV W0, P1DC2
290:                   P1DC3=(5*motor[2]/3);
001844  805AA0     MOV 0xB54, W0
001846  B90065     MUL.SU W0, #5, W0
001848  780100     MOV W0, W2
00184A  255560     MOV #0x5556, W0
00184C  B99000     MUL.SS W2, W0, W0
00184E  DE914F     ASR W2, #15, W2
001850  508002     SUB W1, W2, W0
001852  880ED0     MOV W0, P1DC3
291:               }
001854  FA8000     ULNK
001856  060000     RETURN
292:               
293:               void __attribute__((__interrupt__,auto_psv)) _U1RXInterrupt(void)
294:               {
0002C8  BE9F80     MOV.D W0, [W15++]
0002CA  781F82     MOV W2, [W15++]
0002CC  F80034     PUSH PSVPAG
0002CE  200000     MOV #0x0, W0
0002D0  8801A0     MOV W0, PSVPAG
0002D2  FA0000     LNK #0x0
295:                   ReceivedChar = U1RXREG;
0002D4  801130     MOV U1RXREG, W0
0002D6  784000     MOV.B W0, W0
0002D8  B7E800     MOV.B WREG, ReceivedChar
296:                   
297:                   if(ReceivedChar == 'g'){go = 1;}
0002DA  208001     MOV #0x800, W1
0002DC  784091     MOV.B [W1], W1
0002DE  B3C670     MOV.B #0x67, W0
0002E0  50CF80     SUB.B W1, W0, [W15]
0002E2  3A0003     BRA NZ, 0x2EA
0002E4  B3C010     MOV.B #0x1, W0
0002E6  B7E802     MOV.B WREG, go
0002E8  370020     BRA 0x32A
298:                   else if(ReceivedChar == 's'){stop = 1; go = 0;}
0002EA  208001     MOV #0x800, W1
0002EC  784091     MOV.B [W1], W1
0002EE  B3C730     MOV.B #0x73, W0
0002F0  50CF80     SUB.B W1, W0, [W15]
0002F2  3A0004     BRA NZ, 0x2FC
0002F4  B3C010     MOV.B #0x1, W0
0002F6  B7E803     MOV.B WREG, stop
0002F8  EF6802     CLR.B go
0002FA  370017     BRA 0x32A
299:                   else 
300:                   {
301:                   if(ReceivedChar == 'u')
0002FC  208001     MOV #0x800, W1
0002FE  784091     MOV.B [W1], W1
000300  B3C750     MOV.B #0x75, W0
000302  50CF80     SUB.B W1, W0, [W15]
000304  3A0003     BRA NZ, 0x30C
302:                   {
303:               //        U1TXREG = 'u'; i = 0;
304:               //        U1TXREG = clock()>>24;
305:               //        U1TXREG = clock()>>16;
306:               //        U1TXREG = clock()>>8;
307:               //        U1TXREG = clock();
308:                       debugPause = 1;
000306  200010     MOV #0x1, W0
000308  884030     MOV W0, debugPause
00030A  37000F     BRA 0x32A
309:                   }
310:                   else
311:                   {
312:                       count[i] = ReceivedChar;
00030C  804020     MOV i, W0
00030E  208001     MOV #0x800, W1
000310  784091     MOV.B [W1], W1
000312  FB0081     SE W1, W1
000314  400100     ADD W0, W0, W2
000316  20B440     MOV #0xB44, W0
000318  410000     ADD W2, W0, W0
00031A  780801     MOV W1, [W0]
313:                       i++;
00031C  804020     MOV i, W0
00031E  E80000     INC W0, W0
000320  884020     MOV W0, i
314:                       if(i>=6) i = 0;
000322  804020     MOV i, W0
000324  500FE5     SUB W0, #0x5, [W15]
000326  340001     BRA LE, 0x32A
000328  EF2804     CLR i
315:                   }
316:                   }
317:                   
318:                   IFS0bits.U1RXIF = 0;
00032A  A96085     BCLR 0x85, #3
319:               }
00032C  FA8000     ULNK
00032E  F90034     POP PSVPAG
000330  78014F     MOV [--W15], W2
000332  BE004F     MOV.D [--W15], W0
000334  064000     RETFIE
320:               
321:               void __attribute__((__interrupt__,auto_psv)) _U1TXInterrupt(void)
322:               {
000336  F80034     PUSH PSVPAG
000338  781F88     MOV W8, [W15++]
00033A  200008     MOV #0x0, W8
00033C  8801A8     MOV W8, PSVPAG
00033E  78044F     MOV [--W15], W8
000340  FA0000     LNK #0x0
323:                   IFS0bits.U1TXIF = 0; // clear TX interrupt flag
000342  A98085     BCLR 0x85, #4
324:                   //U1TXREG = 'b'; // Transmit one character
325:                  
326:               }
000344  FA8000     ULNK
000346  F90034     POP PSVPAG
000348  064000     RETFIE
327:               
328:               #endif
---  C:/Users/dell/Desktop/MPLABXProjects/ultimate/controller.c  ----------------------------------------
1:                 /*
2:                  * File:   controller.c
3:                  * Author: dracula
4:                  *
5:                  * Created on January 6, 2017, 11:58 PM
6:                  */
7:                 
8:                 #include "user.h"
9:                 extern Parameter P;
10:                extern Matrix *Kp;
11:                extern Matrix *Kd;
12:                Vector3f *OMRS_controller(Vector3f *qd, Vector3f *dqd, Vector3f *ddqd, Vector3f *q, Vector3f *dq)
13:                {
001B9C  FA0024     LNK #0x24
001B9E  BE9F88     MOV.D W8, [W15++]
001BA0  BE9F8A     MOV.D W10, [W15++]
001BA2  BE9F8C     MOV.D W12, [W15++]
001BA4  980F30     MOV W0, [W14+22]
001BA6  980F41     MOV W1, [W14+24]
001BA8  980F52     MOV W2, [W14+26]
001BAA  980F63     MOV W3, [W14+28]
001BAC  980F74     MOV W4, [W14+30]
14:                #ifdef printTimeConsumption
15:                	int controllerInitTime = clock();
16:                #endif // printTimeConsumption
17:                
18:                    Vector3f *temp;
19:                    Vector3f *uavc;
20:                    Matrix *Ravc = m_constructor(local, NULL, NULL, cos(q->z), -sin(q->z), 0, sin(q->z), cos(q->z), 0, 0, 0 ,1);
001BAE  90086E     MOV [W14+28], W0
001BB0  9000D0     MOV [W0+10], W1
001BB2  900040     MOV [W0+8], W0
001BB4  07F475     RCALL _cosf
001BB6  BE0600     MOV.D W0, W12
001BB8  90086E     MOV [W14+28], W0
001BBA  9000D0     MOV [W0+10], W1
001BBC  900040     MOV [W0+8], W0
001BBE  07F5C5     RCALL _sinf
001BC0  BE0500     MOV.D W0, W10
001BC2  90086E     MOV [W14+28], W0
001BC4  9000D0     MOV [W0+10], W1
001BC6  900040     MOV [W0+8], W0
001BC8  07F5C0     RCALL _sinf
001BCA  BE0400     MOV.D W0, W8
001BCC  A2F009     BTG W9, #15
001BCE  90086E     MOV [W14+28], W0
001BD0  9000D0     MOV [W0+10], W1
001BD2  900040     MOV [W0+8], W0
001BD4  07F465     RCALL _cosf
001BD6  200002     MOV #0x0, W2
001BD8  23F803     MOV #0x3F80, W3
001BDA  BE9F82     MOV.D W2, [W15++]
001BDC  B81160     MUL.UU W2, #0, W2
001BDE  BE9F82     MOV.D W2, [W15++]
001BE0  B81160     MUL.UU W2, #0, W2
001BE2  BE9F82     MOV.D W2, [W15++]
001BE4  B81160     MUL.UU W2, #0, W2
001BE6  BE9F82     MOV.D W2, [W15++]
001BE8  BE9F8C     MOV.D W12, [W15++]
001BEA  BE9F8A     MOV.D W10, [W15++]
001BEC  B81160     MUL.UU W2, #0, W2
001BEE  BE9F82     MOV.D W2, [W15++]
001BF0  BE0308     MOV.D W8, W6
001BF2  BE0200     MOV.D W0, W4
001BF4  EB0100     CLR W2
001BF6  EB0080     CLR W1
001BF8  EB4000     CLR.B W0
001BFA  07F729     RCALL m_constructor
001BFC  5787FC     SUB W15, #0x1C, W15
001BFE  780F00     MOV W0, [W14]
21:                    Matrix *DRavc = m_constructor(local, NULL, NULL, -sin(q->z)*dq->z, -cos(q->z)*dq->z, 0, cos(q->z)*dq->z, -sin(q->z)*dq->z, 0, 0, 0 ,0);
001C00  90086E     MOV [W14+28], W0
001C02  9000D0     MOV [W0+10], W1
001C04  900040     MOV [W0+8], W0
001C06  07F5A1     RCALL _sinf
001C08  BE0200     MOV.D W0, W4
001C0A  A2F005     BTG W5, #15
001C0C  90087E     MOV [W14+30], W0
001C0E  9000D0     MOV [W0+10], W1
001C10  900040     MOV [W0+8], W0
001C12  BE0100     MOV.D W0, W2
001C14  BE0004     MOV.D W4, W0
001C16  07F4FC     RCALL ___mulsf3
001C18  BE0600     MOV.D W0, W12
001C1A  90086E     MOV [W14+28], W0
001C1C  9000D0     MOV [W0+10], W1
001C1E  900040     MOV [W0+8], W0
001C20  07F43F     RCALL _cosf
001C22  BE0200     MOV.D W0, W4
001C24  90087E     MOV [W14+30], W0
001C26  9000D0     MOV [W0+10], W1
001C28  900040     MOV [W0+8], W0
001C2A  BE0100     MOV.D W0, W2
001C2C  BE0004     MOV.D W4, W0
001C2E  07F4F0     RCALL ___mulsf3
001C30  BE0500     MOV.D W0, W10
001C32  90086E     MOV [W14+28], W0
001C34  9000D0     MOV [W0+10], W1
001C36  900040     MOV [W0+8], W0
001C38  07F433     RCALL _cosf
001C3A  BE0200     MOV.D W0, W4
001C3C  A2F005     BTG W5, #15
001C3E  90087E     MOV [W14+30], W0
001C40  9000D0     MOV [W0+10], W1
001C42  900040     MOV [W0+8], W0
001C44  BE0100     MOV.D W0, W2
001C46  BE0004     MOV.D W4, W0
001C48  07F4E3     RCALL ___mulsf3
001C4A  BE0400     MOV.D W0, W8
001C4C  90086E     MOV [W14+28], W0
001C4E  9000D0     MOV [W0+10], W1
001C50  900040     MOV [W0+8], W0
001C52  07F57B     RCALL _sinf
001C54  BE0200     MOV.D W0, W4
001C56  A2F005     BTG W5, #15
001C58  90087E     MOV [W14+30], W0
001C5A  9000D0     MOV [W0+10], W1
001C5C  900040     MOV [W0+8], W0
001C5E  BE0100     MOV.D W0, W2
001C60  BE0004     MOV.D W4, W0
001C62  07F4D6     RCALL ___mulsf3
001C64  B81160     MUL.UU W2, #0, W2
001C66  BE9F82     MOV.D W2, [W15++]
001C68  B81160     MUL.UU W2, #0, W2
001C6A  BE9F82     MOV.D W2, [W15++]
001C6C  B81160     MUL.UU W2, #0, W2
001C6E  BE9F82     MOV.D W2, [W15++]
001C70  B81160     MUL.UU W2, #0, W2
001C72  BE9F82     MOV.D W2, [W15++]
001C74  BE9F8C     MOV.D W12, [W15++]
001C76  BE9F8A     MOV.D W10, [W15++]
001C78  B81160     MUL.UU W2, #0, W2
001C7A  BE9F82     MOV.D W2, [W15++]
001C7C  BE0308     MOV.D W8, W6
001C7E  BE0200     MOV.D W0, W4
001C80  EB0100     CLR W2
001C82  EB0080     CLR W1
001C84  EB4000     CLR.B W0
001C86  07F6E3     RCALL m_constructor
001C88  5787FC     SUB W15, #0x1C, W15
001C8A  980710     MOV W0, [W14+2]
22:                    Matrix *M2avc = m_constructor(local, NULL, NULL, 1.5*P.beta0 + P.m, 0, 0, 0, 1.5*P.beta0 + P.m, 0, 0, 0, 3*P.beta0*pow(P.La, 2) + P.Iv);
001C8C  805C30     MOV 0xB86, W0
001C8E  805C41     MOV 0xB88, W1
001C90  200002     MOV #0x0, W2
001C92  240403     MOV #0x4040, W3
001C94  07F4BD     RCALL ___mulsf3
001C96  BE0400     MOV.D W0, W8
001C98  805B50     MOV 0xB6A, W0
001C9A  805B61     MOV 0xB6C, W1
001C9C  BE0100     MOV.D W0, W2
001C9E  07F4B8     RCALL ___mulsf3
001CA0  BE0100     MOV.D W0, W2
001CA2  BE0008     MOV.D W8, W0
001CA4  07F4B5     RCALL ___mulsf3
001CA6  BE0200     MOV.D W0, W4
001CA8  805AD0     MOV 0xB5A, W0
001CAA  805AE1     MOV 0xB5C, W1
001CAC  BE0100     MOV.D W0, W2
001CAE  BE0004     MOV.D W4, W0
001CB0  07F39A     RCALL ___addsf3
001CB2  BE0500     MOV.D W0, W10
001CB4  805C30     MOV 0xB86, W0
001CB6  805C41     MOV 0xB88, W1
001CB8  200002     MOV #0x0, W2
001CBA  23FC03     MOV #0x3FC0, W3
001CBC  07F4A9     RCALL ___mulsf3
001CBE  BE0200     MOV.D W0, W4
001CC0  805AB0     MOV P, W0
001CC2  805AC1     MOV 0xB58, W1
001CC4  BE0100     MOV.D W0, W2
001CC6  BE0004     MOV.D W4, W0
001CC8  07F38E     RCALL ___addsf3
001CCA  BE0400     MOV.D W0, W8
001CCC  805C30     MOV 0xB86, W0
001CCE  805C41     MOV 0xB88, W1
001CD0  200002     MOV #0x0, W2
001CD2  23FC03     MOV #0x3FC0, W3
001CD4  07F49D     RCALL ___mulsf3
001CD6  BE0200     MOV.D W0, W4
001CD8  805AB0     MOV P, W0
001CDA  805AC1     MOV 0xB58, W1
001CDC  BE0100     MOV.D W0, W2
001CDE  BE0004     MOV.D W4, W0
001CE0  07F382     RCALL ___addsf3
001CE2  BE9F8A     MOV.D W10, [W15++]
001CE4  B81160     MUL.UU W2, #0, W2
001CE6  BE9F82     MOV.D W2, [W15++]
001CE8  B81160     MUL.UU W2, #0, W2
001CEA  BE9F82     MOV.D W2, [W15++]
001CEC  B81160     MUL.UU W2, #0, W2
001CEE  BE9F82     MOV.D W2, [W15++]
001CF0  BE9F88     MOV.D W8, [W15++]
001CF2  B81160     MUL.UU W2, #0, W2
001CF4  BE9F82     MOV.D W2, [W15++]
001CF6  B81160     MUL.UU W2, #0, W2
001CF8  BE9F82     MOV.D W2, [W15++]
001CFA  B83360     MUL.UU W6, #0, W6
001CFC  BE0200     MOV.D W0, W4
001CFE  EB0100     CLR W2
001D00  EB0080     CLR W1
001D02  EB4000     CLR.B W0
001D04  07F6A4     RCALL m_constructor
001D06  5787FC     SUB W15, #0x1C, W15
001D08  980720     MOV W0, [W14+4]
23:                    Matrix *C2avc = m_constructor(local, NULL, NULL, 1.5*P.beta1, -P.m*dq->z, 0, P.m*dq->z, 1.5*P.beta1, 0, 0, 0, 3*P.beta1*pow(P.La, 2));
001D0A  805C50     MOV 0xB8A, W0
001D0C  805C61     MOV 0xB8C, W1
001D0E  200002     MOV #0x0, W2
001D10  240403     MOV #0x4040, W3
001D12  07F47E     RCALL ___mulsf3
001D14  BE0400     MOV.D W0, W8
001D16  805B50     MOV 0xB6A, W0
001D18  805B61     MOV 0xB6C, W1
001D1A  BE0100     MOV.D W0, W2
001D1C  07F479     RCALL ___mulsf3
001D1E  BE0100     MOV.D W0, W2
001D20  BE0008     MOV.D W8, W0
001D22  07F476     RCALL ___mulsf3
001D24  BE0100     MOV.D W0, W2
001D26  981702     MOV W2, [W14+32]
001D28  981713     MOV W3, [W14+34]
001D2A  805C50     MOV 0xB8A, W0
001D2C  805C61     MOV 0xB8C, W1
001D2E  200002     MOV #0x0, W2
001D30  23FC03     MOV #0x3FC0, W3
001D32  07F46E     RCALL ___mulsf3
001D34  BE0600     MOV.D W0, W12
001D36  805AB4     MOV P, W4
001D38  805AC5     MOV 0xB58, W5
001D3A  90087E     MOV [W14+30], W0
001D3C  9000D0     MOV [W0+10], W1
001D3E  900040     MOV [W0+8], W0
001D40  BE0100     MOV.D W0, W2
001D42  BE0004     MOV.D W4, W0
001D44  07F465     RCALL ___mulsf3
001D46  BE0500     MOV.D W0, W10
001D48  805AB0     MOV P, W0
001D4A  805AC1     MOV 0xB58, W1
001D4C  BE0200     MOV.D W0, W4
001D4E  A2F005     BTG W5, #15
001D50  90087E     MOV [W14+30], W0
001D52  9000D0     MOV [W0+10], W1
001D54  900040     MOV [W0+8], W0
001D56  BE0100     MOV.D W0, W2
001D58  BE0004     MOV.D W4, W0
001D5A  07F45A     RCALL ___mulsf3
001D5C  BE0400     MOV.D W0, W8
001D5E  805C50     MOV 0xB8A, W0
001D60  805C61     MOV 0xB8C, W1
001D62  200002     MOV #0x0, W2
001D64  23FC03     MOV #0x3FC0, W3
001D66  07F454     RCALL ___mulsf3
001D68  90110E     MOV [W14+32], W2
001D6A  90119E     MOV [W14+34], W3
001D6C  BE9F82     MOV.D W2, [W15++]
001D6E  B81160     MUL.UU W2, #0, W2
001D70  BE9F82     MOV.D W2, [W15++]
001D72  B81160     MUL.UU W2, #0, W2
001D74  BE9F82     MOV.D W2, [W15++]
001D76  B81160     MUL.UU W2, #0, W2
001D78  BE9F82     MOV.D W2, [W15++]
001D7A  BE9F8C     MOV.D W12, [W15++]
001D7C  BE9F8A     MOV.D W10, [W15++]
001D7E  B81160     MUL.UU W2, #0, W2
001D80  BE9F82     MOV.D W2, [W15++]
001D82  BE0308     MOV.D W8, W6
001D84  BE0200     MOV.D W0, W4
001D86  EB0100     CLR W2
001D88  EB0080     CLR W1
001D8A  EB4000     CLR.B W0
001D8C  07F660     RCALL m_constructor
001D8E  5787FC     SUB W15, #0x1C, W15
001D90  980730     MOV W0, [W14+6]
24:                    Matrix *RavcRev = m_constructor(local, NULL, NULL, cos(q->z), sin(q->z), 0, -sin(q->z), cos(q->z), 0, 0, 0, 1);
001D92  90086E     MOV [W14+28], W0
001D94  9000D0     MOV [W0+10], W1
001D96  900040     MOV [W0+8], W0
001D98  07F383     RCALL _cosf
001D9A  BE0600     MOV.D W0, W12
001D9C  90086E     MOV [W14+28], W0
001D9E  9000D0     MOV [W0+10], W1
001DA0  900040     MOV [W0+8], W0
001DA2  07F4D3     RCALL _sinf
001DA4  BE0500     MOV.D W0, W10
001DA6  A2F00B     BTG W11, #15
001DA8  90086E     MOV [W14+28], W0
001DAA  9000D0     MOV [W0+10], W1
001DAC  900040     MOV [W0+8], W0
001DAE  07F4CD     RCALL _sinf
001DB0  BE0400     MOV.D W0, W8
001DB2  90086E     MOV [W14+28], W0
001DB4  9000D0     MOV [W0+10], W1
001DB6  900040     MOV [W0+8], W0
001DB8  07F373     RCALL _cosf
001DBA  200002     MOV #0x0, W2
001DBC  23F803     MOV #0x3F80, W3
001DBE  BE9F82     MOV.D W2, [W15++]
001DC0  B81160     MUL.UU W2, #0, W2
001DC2  BE9F82     MOV.D W2, [W15++]
001DC4  B81160     MUL.UU W2, #0, W2
001DC6  BE9F82     MOV.D W2, [W15++]
001DC8  B81160     MUL.UU W2, #0, W2
001DCA  BE9F82     MOV.D W2, [W15++]
001DCC  BE9F8C     MOV.D W12, [W15++]
001DCE  BE9F8A     MOV.D W10, [W15++]
001DD0  B81160     MUL.UU W2, #0, W2
001DD2  BE9F82     MOV.D W2, [W15++]
001DD4  BE0308     MOV.D W8, W6
001DD6  BE0200     MOV.D W0, W4
001DD8  EB0100     CLR W2
001DDA  EB0080     CLR W1
001DDC  EB4000     CLR.B W0
001DDE  07F637     RCALL m_constructor
001DE0  5787FC     SUB W15, #0x1C, W15
001DE2  980740     MOV W0, [W14+8]
25:                    Matrix *Mavc = m_m_multiply(M2avc,RavcRev);
001DE4  9000CE     MOV [W14+8], W1
001DE6  90002E     MOV [W14+4], W0
001DE8  07F767     RCALL m_m_multiply
001DEA  980750     MOV W0, [W14+10]
26:                    Matrix *Cavc = m_minus(m_m_multiply(C2avc,RavcRev),m_m_multiply(M2avc,m_m_multiply(RavcRev,m_m_multiply(DRavc,RavcRev)))); 
001DEC  9000CE     MOV [W14+8], W1
001DEE  90001E     MOV [W14+2], W0
001DF0  07F763     RCALL m_m_multiply
001DF2  780080     MOV W0, W1
001DF4  90004E     MOV [W14+8], W0
001DF6  07F760     RCALL m_m_multiply
001DF8  780080     MOV W0, W1
001DFA  90002E     MOV [W14+4], W0
001DFC  07F75D     RCALL m_m_multiply
001DFE  780400     MOV W0, W8
001E00  9000CE     MOV [W14+8], W1
001E02  90003E     MOV [W14+6], W0
001E04  07F759     RCALL m_m_multiply
001E06  780088     MOV W8, W1
001E08  07F70D     RCALL m_minus
001E0A  980760     MOV W0, [W14+12]
27:                    Matrix *BavcOri = m_constructor(local, NULL, NULL, -0.5, -0.5, 1, 0.866, -0.866, 0, P.La, P.La, P.La);
001E0C  805B54     MOV 0xB6A, W4
001E0E  805B65     MOV 0xB6C, W5
001E10  805B52     MOV 0xB6A, W2
001E12  805B63     MOV 0xB6C, W3
001E14  805B50     MOV 0xB6A, W0
001E16  805B61     MOV 0xB6C, W1
001E18  BE9F84     MOV.D W4, [W15++]
001E1A  BE9F82     MOV.D W2, [W15++]
001E1C  BE9F80     MOV.D W0, [W15++]
001E1E  B80060     MUL.UU W0, #0, W0
001E20  BE9F80     MOV.D W0, [W15++]
001E22  2B22D0     MOV #0xB22D, W0
001E24  2BF5D1     MOV #0xBF5D, W1
001E26  BE9F80     MOV.D W0, [W15++]
001E28  2B22D0     MOV #0xB22D, W0
001E2A  23F5D1     MOV #0x3F5D, W1
001E2C  BE9F80     MOV.D W0, [W15++]
001E2E  200000     MOV #0x0, W0
001E30  23F801     MOV #0x3F80, W1
001E32  BE9F80     MOV.D W0, [W15++]
001E34  200006     MOV #0x0, W6
001E36  2BF007     MOV #0xBF00, W7
001E38  200004     MOV #0x0, W4
001E3A  2BF005     MOV #0xBF00, W5
001E3C  EB0100     CLR W2
001E3E  EB0080     CLR W1
001E40  EB4000     CLR.B W0
001E42  07F605     RCALL m_constructor
001E44  5787FC     SUB W15, #0x1C, W15
001E46  980770     MOV W0, [W14+14]
28:                    Matrix *Bavc = m_s_multiply(BavcOri,P.beta2);
001E48  805C70     MOV 0xB8E, W0
001E4A  805C81     MOV _m_plus, W1
001E4C  BE0100     MOV.D W0, W2
001E4E  90007E     MOV [W14+14], W0
001E50  07F81C     RCALL m_s_multiply
001E52  980F00     MOV W0, [W14+16]
29:                    temp = m_v_multiply(m_inverse(Bavc),m_v_multiply(Mavc,v_minus(ddqd,v_plus(m_v_multiply(Kd,v_minus(dq,dqd)),m_v_multiply(Kp,v_minus(q,qd))))));
001E54  9008BE     MOV [W14+22], W1
001E56  90086E     MOV [W14+28], W0
001E58  07FD38     RCALL v_minus
001E5A  780080     MOV W0, W1
001E5C  804040     MOV Kp, W0
001E5E  07F799     RCALL m_v_multiply
001E60  780400     MOV W0, W8
001E62  9008CE     MOV [W14+24], W1
001E64  90087E     MOV [W14+30], W0
001E66  07FD31     RCALL v_minus
001E68  780080     MOV W0, W1
001E6A  804050     MOV Kd, W0
001E6C  07F792     RCALL m_v_multiply
001E6E  780088     MOV W8, W1
001E70  07FD02     RCALL v_plus
001E72  780080     MOV W0, W1
001E74  90085E     MOV [W14+26], W0
001E76  07FD29     RCALL v_minus
001E78  780080     MOV W0, W1
001E7A  90005E     MOV [W14+10], W0
001E7C  07F78A     RCALL m_v_multiply
001E7E  780400     MOV W0, W8
001E80  90080E     MOV [W14+16], W0
001E82  07F9BA     RCALL m_inverse
001E84  780088     MOV W8, W1
001E86  07F785     RCALL m_v_multiply
001E88  980F10     MOV W0, [W14+18]
30:                    uavc = v_plus(temp,m_v_multiply(m_m_multiply(m_inverse(Bavc),Cavc),dq));
001E8A  90080E     MOV [W14+16], W0
001E8C  07F9B5     RCALL m_inverse
001E8E  9000EE     MOV [W14+12], W1
001E90  07F713     RCALL m_m_multiply
001E92  9008FE     MOV [W14+30], W1
001E94  07F77E     RCALL m_v_multiply
001E96  780080     MOV W0, W1
001E98  90081E     MOV [W14+18], W0
001E9A  07FCED     RCALL v_plus
001E9C  980F20     MOV W0, [W14+20]
31:                
32:                #ifdef printDetail
33:                    printf("uavc: %f,%f,%f\n", uavc->x, uavc->y, uavc->z);
34:                	printf("Ravc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
35:                		Ravc->triMatrix[0][0], Ravc->triMatrix[0][1], Ravc->triMatrix[0][2],
36:                		Ravc->triMatrix[1][0], Ravc->triMatrix[1][1], Ravc->triMatrix[1][2],
37:                		Ravc->triMatrix[2][0], Ravc->triMatrix[2][1], Ravc->triMatrix[2][2]);
38:                	printf("DRavc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
39:                		DRavc->triMatrix[0][0], DRavc->triMatrix[0][1], DRavc->triMatrix[0][2],
40:                		DRavc->triMatrix[1][0], DRavc->triMatrix[1][1], DRavc->triMatrix[1][2],
41:                		DRavc->triMatrix[2][0], DRavc->triMatrix[2][1], DRavc->triMatrix[2][2]);
42:                	printf("M2avc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
43:                		M2avc->triMatrix[0][0], M2avc->triMatrix[0][1], M2avc->triMatrix[0][2],
44:                		M2avc->triMatrix[1][0], M2avc->triMatrix[1][1], M2avc->triMatrix[1][2],
45:                		M2avc->triMatrix[2][0], M2avc->triMatrix[2][1], M2avc->triMatrix[2][2]);
46:                	printf("C2avc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
47:                		C2avc->triMatrix[0][0], C2avc->triMatrix[0][1], C2avc->triMatrix[0][2],
48:                		C2avc->triMatrix[1][0], C2avc->triMatrix[1][1], C2avc->triMatrix[1][2],
49:                		C2avc->triMatrix[2][0], C2avc->triMatrix[2][1], C2avc->triMatrix[2][2]);
50:                	printf("RavcRev: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
51:                		RavcRev->triMatrix[0][0], RavcRev->triMatrix[0][1], RavcRev->triMatrix[0][2],
52:                		RavcRev->triMatrix[1][0], RavcRev->triMatrix[1][1], RavcRev->triMatrix[1][2],
53:                		RavcRev->triMatrix[2][0], RavcRev->triMatrix[2][1], RavcRev->triMatrix[2][2]);
54:                	printf("Mavc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
55:                		Mavc->triMatrix[0][0], Mavc->triMatrix[0][1], Mavc->triMatrix[0][2],
56:                		Mavc->triMatrix[1][0], Mavc->triMatrix[1][1], Mavc->triMatrix[1][2],
57:                		Mavc->triMatrix[2][0], Mavc->triMatrix[2][1], Mavc->triMatrix[2][2]);
58:                	printf("Cavc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
59:                		Cavc->triMatrix[0][0], Cavc->triMatrix[0][1], Cavc->triMatrix[0][2],
60:                		Cavc->triMatrix[1][0], Cavc->triMatrix[1][1], Cavc->triMatrix[1][2],
61:                		Cavc->triMatrix[2][0], Cavc->triMatrix[2][1], Cavc->triMatrix[2][2]);
62:                	printf("BavcOri: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
63:                		BavcOri->triMatrix[0][0], BavcOri->triMatrix[0][1], BavcOri->triMatrix[0][2],
64:                		BavcOri->triMatrix[1][0], BavcOri->triMatrix[1][1], BavcOri->triMatrix[1][2],
65:                		BavcOri->triMatrix[2][0], BavcOri->triMatrix[2][1], BavcOri->triMatrix[2][2]);
66:                	printf("Bavc: %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
67:                		Bavc->triMatrix[0][0], Bavc->triMatrix[0][1], Bavc->triMatrix[0][2],
68:                		Bavc->triMatrix[1][0], Bavc->triMatrix[1][1], Bavc->triMatrix[1][2],
69:                		Bavc->triMatrix[2][0], Bavc->triMatrix[2][1], Bavc->triMatrix[2][2]);
70:                
71:                	Matrix *tm1 = m_m_multiply(C2avc, RavcRev);
72:                	Matrix *tm2 = m_m_multiply(M2avc, RavcRev);
73:                	Matrix *tm3 = m_m_multiply(M2avc, m_m_multiply(RavcRev, m_m_multiply(DRavc, RavcRev)));
74:                	printf("C2avc*RavcRev\': %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
75:                		tm1->triMatrix[0][0], tm1->triMatrix[0][1], tm1->triMatrix[0][2],
76:                		tm1->triMatrix[1][0], tm1->triMatrix[1][1], tm1->triMatrix[1][2],
77:                		tm1->triMatrix[2][0], tm1->triMatrix[2][1], tm1->triMatrix[2][2]);
78:                	printf("M2avc*Ravc\'*DRavc*Ravc\': %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
79:                		tm2->triMatrix[0][0], tm2->triMatrix[0][1], tm2->triMatrix[0][2],
80:                		tm2->triMatrix[1][0], tm2->triMatrix[1][1], tm2->triMatrix[1][2],
81:                		tm2->triMatrix[2][0], tm2->triMatrix[2][1], tm2->triMatrix[2][2]);
82:                	printf("M2avc*Ravc\'*DRavc*Ravc\': %f,%f,%f\n%f,%f,%f\n%f,%f,%f\n",
83:                		tm3->triMatrix[0][0], tm3->triMatrix[0][1], tm3->triMatrix[0][2],
84:                		tm3->triMatrix[1][0], tm3->triMatrix[1][1], tm3->triMatrix[1][2],
85:                		tm3->triMatrix[2][0], tm3->triMatrix[2][1], tm3->triMatrix[2][2]);
86:                #endif // printDetail
87:                
88:                #ifdef printTimeConsumption
89:                	printf("controller time: %d\n", (clock() - controllerInitTime));
90:                #endif // printTimeConsumption
91:                
92:                    return uavc;
001E9E  90082E     MOV [W14+20], W0
93:                }
001EA0  BE064F     MOV.D [--W15], W12
001EA2  BE054F     MOV.D [--W15], W10
001EA4  BE044F     MOV.D [--W15], W8
001EA6  FA8000     ULNK
001EA8  060000     RETURN
